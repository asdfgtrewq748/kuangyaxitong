# 阶段 D 实施方案：科研闭环与证据链

## 1. 阶段目标

1. 将地质建模结果纳入科研工作台实验体系。  
2. 构建“可复现实验 + 可追溯证据包 + 论文图组”一体化流程。  
3. 为投稿与审稿提供标准化材料输出。

---

## 2. 范围与重点

### 2.1 后端
- `backend/app/services/experiment_runner.py`
- `backend/app/routes/research.py`
- 研究产物目录管理与打包逻辑

### 2.2 前端
- `frontend/src/views/ResearchWorkbench.vue`
- `frontend/src/views/ResearchPortal.vue`

---

## 3. 实验模板扩展

新增模板：
1. `geomodel_ablation`  
- 比较“有/无地质约束”对核心指标影响

2. `pinchout_effect`  
- 对比尖灭策略（关闭/默认/增强）影响

3. `rk_vs_kriging`  
- 对比回归克里金与普通克里金在不同区域表现

每个模板输出：
- 指标汇总（AUC/PR-AUC/F1/Brier/ECE 等）
- 校准结果
- 显著性检验
- 图件清单

---

## 4. 证据包结构建议

```
evidence_bundle/
  manifest.json
  data_signature.json
  params_snapshot.json
  metrics_summary.csv
  calibration_report.json
  significance_report.json
  geomodel_quality_report.json
  figures/
    fig_method_compare.svg
    fig_spatial_error_map.svg
    fig_calibration_curve.svg
```

关键字段：
- `dataset_version`
- `split_strategy`
- `exp_id`
- `model_mode`
- `generated_at`

---

## 5. 开发任务拆分

1. 模板定义扩展  
- 新增模板配置与参数校验

2. 结果聚合扩展  
- 将地质质量指标写入实验 summary

3. 证据包导出  
- 打包下载接口  
- 导出状态与日志记录

4. 前端展示  
- 模板选择、批量执行、对比看板  
- 证据包下载与明细展示

---

## 6. 验收标准

1. 至少 3 个新增模板可成功运行并产出结果。  
2. 证据包包含数据签名、参数快照、指标与图组。  
3. 结果可复现（同输入同参数输出一致）。  
4. 前端可完整查看并下载证据包。

---

## 7. 风险与应对

1. 实验耗时高  
- 方案：模板分步执行 + 中间结果缓存。

2. 证据包体积过大  
- 方案：图组压缩、分级导出（标准版/完整版）。

3. 审稿口径不统一  
- 方案：固定导出模板与统计口径版本号。

---

## 8. 交付物

1. 新模板与执行代码。  
2. 证据包导出与下载接口。  
3. 前端模板管理与对比看板。  
4. 阶段 D 验收记录。

