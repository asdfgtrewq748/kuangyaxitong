# MPI系统实施任务清单

**项目名称：** 矿压影响指标（MPI）系统
**开始日期：** 2026-01-30
**预计工期：** 18天
**整体进度：** ▓▓▓▓▓▓▓▓░░ 81%

---

## 一、Web端页面改动说明

**不动的前两个页面：**

| 页面 | 路由 | 说明 |
|------|------|------|
| 📁 数据导入 | /data | 无改动 |
| 📊 插值分析 | /interpolation | 无改动 |

**需要修改的后面页面：**

| 页面 | 路由 | 改动内容 |
|------|------|----------|
| 📈 矿压指标 | /pressure | 新增MPI选项卡 |
| 📐 来压步距 | /steps | 增加MPI相关内容 |
| 📑 结果报告 | /report | 增加MPI章节 |

---

## 二、任务状态图例

| 图例 | 含义 |
|------|------|
| ⬜ | 待开始 (TODO) |
| 🟡 | 进行中 (IN_PROGRESS) |
| 🟢 | 已完成 (DONE) |

---

## 三、阶段一：后端数据准备（第1-5天）

### Task 1.1 - 数据库解析模块（🟢 已完成）

**优先级：** P0 | **估算：** 6小时

**任务描述：**
- 文件：`backend/app/services/rock_params_db.py`
- 支持UTF-8和GBK编码
- 构建岩性、矿名索引

**验收标准：**
- [x] 数据读取成功率 > 95%
- [x] 索引查询响应 < 10ms

---

### Task 1.2 - 岩性同义词映射（🟢 已完成）

**优先级：** P1 | **估算：** 2小时

**任务描述：**
- 建立岩性同义词映射表
- 处理"粉砂岩"/"粉砂质泥岩"等相似名称

**验收标准：**
- [x] 覆盖数据库中95%的岩性名称
- [x] 匹配准确率 > 90%

---

### Task 1.3 - 参数查询接口（🟢 已完成）

**优先级：** P0 | **估算：** 4小时

**任务描述：**
- 实现按岩性查询接口
- 实现参数统计功能

**验收标准：**
- [x] 支持精确匹配和同义词模糊匹配
- [x] 查询响应 < 10ms

---

### Task 1.4 - 缺失参数处理（🟢 已完成）

**优先级：** P0 | **估算：** 7小时

**任务描述：**
- 建立默认参数库
- 实现参数估算算法

**验收标准：**
- [x] 覆盖所有主要岩性（>20种）
- [x] 估算成功率 > 95%

---

## 四、阶段二：MPI计算引擎（第6-10天）

### Task 2.1 - 创建MPI计算模块（🟢 已完成）

**优先级：** P0 | **估算：** 1小时

**任务描述：**
- 文件：`backend/app/services/mpi_calculator.py`
- 定义数据结构和类型注解

**验收标准：**
- [x] 文件创建完成
- [x] 类型注解完整

---

### Task 2.2 - 关键层识别算法（🟢 已完成）

**优先级：** P0 | **估算：** 3小时

**任务描述：**
- 基于抗压强度、厚度、弹性模量识别关键层

**验收标准：**
- [x] 正确识别关键层
- [x] 单元测试通过

---

### Task 2.3 - 顶板稳定性指标（RSI）（🟢 已完成）

**优先级：** P0 | **估算：** 4小时

**任务描述：**
- 抗拉强度评分（40%）
- 关键层数量评分（30%）
- 岩层结构评分（30%）

**验收标准：**
- [x] 返回值范围 [0, 100]
- [x] 单元测试覆盖率 > 90%

---

### Task 2.4 - 冲击地压风险指标（BRI）（🟢 已完成）

**优先级：** P0 | **估算：** 4小时

**任务描述：**
- 采深度因子
- 硬厚岩层能量积聚
- 煤层厚度影响

**验收标准：**
- [x] 返回值范围 [0, 100]
- [x] 单元测试通过

---

### Task 2.5 - 支承压力分布指标（ASI）（🟢 已完成）

**优先级：** P0 | **估算：** 3小时

**任务描述：**
- 综合刚度评分（50%）
- 内摩擦角评分（50%）

**验收标准：**
- [x] 返回值范围 [0, 100]
- [x] 单元测试通过

---

### Task 2.6 - 综合MPI计算（🟢 已完成）

**优先级：** P0 | **估算：** 5小时

**任务描述：**
- 加权综合三个子指标
- 批量计算接口

**验收标准：**
- [x] 加权计算正确
- [x] 100点计算时间 < 5s
- [x] 支持自定义权重

---

### Task 2.7 - 单元测试（🟢 已完成）

**优先级：** P0 | **估算：** 4小时

**任务描述：**
- 测试文件：`tests/test_mpi_calculator.py`
- 覆盖率目标：> 80%

**验收标准：**
- [x] 测试覆盖率 > 80%
- [x] 所有测试通过

---

## 五、阶段三：API开发 + 前端集成（第11-18天）

### Task 3.1 - 创建MPI路由

**优先级：** P0 | **估算：** 1小时 | **状态：** 🟢 已完成

**交付物：** `backend/app/routes/mpi.py`

---

### Task 3.2 - 单点计算API

**优先级：** P0 | **估算：** 2小时 | **状态：** 🟢 已完成

```
POST /api/mpi/calculate
Request: {point, strata, weights}
Response: {mpi, breakdown: {rsi, bri, asi}}
```

**验收标准：** 响应时间 < 100ms

---

### Task 3.3 - 批量计算API

**优先级：** P1 | **估算：** 2小时 | **状态：** 🟢 已完成

```
POST /api/mpi/batch
```

**验收标准：** 100点批量计算 < 5s

---

### Task 3.4 - 插值网格API

**优先级：** P1 | **估算：** 3小时 | **状态：** 🟢 已完成

```
POST /api/mpi/interpolate
Request: {resolution, bounds, weights}
Response: {grid, bounds}
```

**验收标准：** 50x50网格计算 < 3s

---

### Task 3.5 - 参数查询API

**优先级：** P1 | **估算：** 2小时 | **状态：** 🟢 已完成

```
GET /api/rock-params/query?lithology={岩性}
GET /api/rock-params/stats
GET /api/rock-params/lithologies
GET /api/rock-params/synonyms
```

---

### Task 3.6 - 权重配置API

**优先级：** P2 | **估算：** 2小时 | **状态：** 🟢 已完成

```
GET /api/mpi/weights
POST /api/mpi/weights
```

---

### Task 3.7 - 矿压指标页面MPI选项卡

**优先级：** P0 | **估算：** 4小时 | **状态：** 🟢 已完成

**文件：** `frontend/src/views/PressureIndex.vue`

**改动内容：**
- ✅ 新增"MPI指标"选项卡
- ✅ 复用现有等值线组件
- ✅ 分项指标切换按钮（RSI/BRI/ASI）
- ✅ 权重配置滑块

**验收标准：**
- [x] MPI选项卡正常显示
- [ ] 等值线渲染正确（需要真实数据测试）
- [x] 切换响应 < 500ms

---

### Task 3.8 - 来压步距页面MPI内容（🟢 已完成）

**优先级：** P1 | **估算：** 2小时

**文件：** `frontend/src/views/Steps.vue`

**改动内容：**
- 显示当前MPI值分布
- 根据MPI高低给出步距调整建议

---

### Task 3.9 - 结果报告页面MPI章节（🟢 已完成）

**优先级：** P1 | **估算：** 2小时

**文件：** `frontend/src/views/Report.vue`

**改动内容：**
- MPI综合评分
- RSI/BRI/ASI分项得分
- 高MPI/低MPI区域标注

---

### Task 3.10 - 前后端联调（🟢 已完成）

**优先级：** P0 | **估算：** 3小时

**验收标准：**
- [x] 所有API调用正常
- [x] 数据展示正确
- [x] 无控制台错误

---

## 六、阶段四：测试与优化（第19-21天）

### Task 4.1 - 真实数据验证（🟡 进行中）

**优先级：** P0 | **估算：** 4小时

**验收标准：**
- [x] 至少3个钻孔验证
- [ ] 偏差 < 15%

**验证样本（15-1上煤）：**
- 52-17：MPI 62.30（RSI 42.99 / BRI 91.90 / ASI 51.73）
- 56-18：MPI 57.15（RSI 34.44 / BRI 90.40 / ASI 46.92）
- 60-18：MPI 57.58（RSI 37.93 / BRI 86.95 / ASI 47.93）

**偏差验证说明：**
- 以液压支架工作阻力数据作为矿压对照基准。
- 验证工作延期至用户提供对照数据后执行。

---

### Task 4.2 - 权重敏感性分析

**优先级：** P1 | **估算：** 3小时

**验收标准：**
- [ ] 测试5+组权重组合
- [ ] 确定推荐配置

---

### Task 4.3 - 性能优化

**优先级：** P1 | **估算：** 3小时

**任务描述：**
- 计算结果缓存
- 缓存命中率 > 70%

---

### Task 4.4 - API文档

**优先级：** P0 | **估算：** 3小时

**交付物：** `docs/MPI_API.md`

---

### Task 4.5 - 用户手册

**优先级：** P1 | **估算：** 3小时

**交付物：** `docs/MPI用户手册.md`

---

## 七、进度追踪

### 完成情况统计

| 阶段 | 任务数 | 已完成 | 待开始 | 完成率 |
|------|--------|--------|--------|--------|
| 后端数据准备 | 4 | 🟢 4 | 0 | 100% |
| MPI计算引擎 | 7 | 🟢 7 | 0 | 100% |
| API+前端集成 | 10 | 🟢 10 | 0 | 100% |
| 测试优化 | 5 | ⬜ 0 | 5 | 0% |
| **总计** | **26** | **21** | **5** | **81%** |

### 优先级分布

| 优先级 | 任务数 | 占比 |
|--------|--------|------|
| P0（关键） | 17 | 65% |
| P1（重要） | 8 | 31% |
| P2（一般） | 1 | 4% |

---

## 八、相关文档

- [MPI设计文档.md](./MPI设计文档.md) - 算法设计详细说明
- [MPI实施提案.md](./MPI实施提案.md) - 项目提案
- [汇总表.csv](./汇总表.csv) - 岩石力学参数数据库
