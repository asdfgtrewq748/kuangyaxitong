var Et=Object.defineProperty,Mt=Object.defineProperties;var Vt=Object.getOwnPropertyDescriptors;var We=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable;var Ke=(H,v,E)=>v in H?Et(H,v,{enumerable:!0,configurable:!0,writable:!0,value:E}):H[v]=E,ge=(H,v)=>{for(var E in v||(v={}))jt.call(v,E)&&Ke(H,E,v[E]);if(We)for(var E of We(v))Rt.call(v,E)&&Ke(H,E,v[E]);return H},xe=(H,v)=>Mt(H,Vt(v));var D=(H,v,E)=>new Promise((we,j)=>{var ve=b=>{try{h(E.next(b))}catch(c){j(c)}},p=b=>{try{h(E.throw(b))}catch(c){j(c)}},h=b=>b.done?we(b.value):Promise.resolve(b.value).then(ve,p);h((E=E.apply(H,v)).next())});import{_ as Ut,a as Bt,b as Ft}from"./index-DAAno9XI.js";import{bf as It,b8 as u,b7 as t,bb as o,ba as ke,br as y,bs as w,bo as le,bi as J,bu as $e,bq as Dt,bc as B,b9 as F,b as L,c as O,r as Se,b5 as d}from"./vendor-CcQzWQKD.js";import{u as Ot,a as At}from"./vue-router-4_hPxHr_.js";import{C as Tt,D as Jt,E as Lt,F as Xt,G as zt,H as Ht,I as Qe,J as qt,K as Ye}from"./api-PFloj90e.js";import"./network-T6nY3V_4.js";const Pt={class:"research-page page"},Gt={class:"hero card"},Zt={class:"hero-status"},Wt={class:"status-pill info"},Kt={class:"grid grid-2"},Qt={class:"card panel"},Yt={class:"form-grid"},el={class:"full"},tl={class:"actions"},ll=["disabled"],sl={class:"card panel"},al={class:"lookup-row"},nl=["disabled"],il={key:0,class:"manifest-meta"},ol={class:"meta-item"},rl={class:"meta-item"},ul={class:"meta-item"},dl={class:"meta-item"},pl={class:"form-grid"},cl={class:"actions"},ml=["disabled"],vl={key:1,class:"split-summary"},_l={class:"summary-grid"},fl={key:0},bl={key:1},hl={class:"grid grid-2"},yl={class:"card panel"},gl={class:"form-grid"},xl={class:"actions"},kl=["disabled"],$l={class:"card panel"},Sl={class:"lookup-row"},wl=["value"],Nl=["disabled"],Cl={key:0,class:"template-preview"},El={class:"table"},Ml={class:"actions"},Vl=["disabled"],jl={key:1,class:"suite-summary"},Rl={class:"meta-item"},Ul={class:"meta-item"},Bl={class:"card panel"},Fl={class:"lookup-row"},Il=["disabled"],Dl=["disabled"],Ol=["disabled"],Al={key:0,class:"result-grid"},Tl={class:"result-card"},Jl={class:"metric-grid"},Ll={class:"result-card"},Xl={class:"table compact"},zl={key:1,class:"result-grid"},Hl={class:"result-card"},ql={class:"meta-row"},Pl={class:"table compact"},Gl={class:"result-card"},Zl={class:"trace-row"},Wl={class:"trace-row"},Kl={class:"trace-row"},Ql={key:2,class:"result-card"},Yl={class:"table"},es=["disabled","onClick"],ts={class:"card panel"},ls={class:"compare-label"},ss={class:"actions actions-split"},as=["disabled"],ns=["disabled"],is=["disabled"],os={key:0,class:"viz-controls"},rs=["value"],us={key:1,class:"result-grid"},ds={class:"result-card"},ps=["viewBox"],cs=["x","y","width","height"],ms=["x1","x2","y1","y2"],vs=["x","y"],_s=["x1","x2","y1","y2"],fs=["cx","cy","fill"],bs=["x","y"],hs={key:0,class:"result-card"},ys=["viewBox"],gs=["x","y","width","height"],xs=["x","y","width","height"],ks=["x","y"],$s=["x","y"],Ss={key:2,class:"result-card"},ws={class:"table"},Ns={key:3,class:"result-card"},Cs={class:"table compact"},Es={key:4,class:"result-card"},Ms={class:"table compact"},Vs={__name:"ResearchWorkbench",setup(H){const v=Bt(),E=Ot(),we=At(),j=["auc","pr_auc","f1","brier","mae","rmse","paired_significance_p"],ve=new Set(["auc","pr_auc","f1"]),p=Se({register:!1,loadDataset:!1,split:!1,runExperiment:!1,loadTemplates:!1,runSuite:!1,loadResult:!1,loadArtifacts:!1,downloadArtifact:!1,compare:!1,exportEvidence:!1}),h=Se({dataset_id:"",description:"",label_column:"label",positive_values:"1",event_definition:"roof_pressure_event",time_window_hours:24,threshold:""}),b=Se({strategy:"time_borehole_block",train_ratio:.7,val_ratio:.15,test_ratio:.15,seed:42,time_column:"",borehole_column:""}),c=Se({dataset_id:"",dataset_version:"",split_id:"",experiment_name:"rsi_phasefield_v1",model_type:"rsi_phase_field",target_label_column:"label",metrics:"auc,pr_auc,brier,ece,f1,mae,rmse",seed:42}),C=L(null),g=L(null),je=L(null),ue=L(null),Ne=L({}),se=L(""),_e=L(null),K=L([]),ae=L(""),A=L(""),fe=L(""),Ce=L(""),M=L([]),oe=L("auc");let pe=null;const Ee=O(()=>{var l;return ae.value||((l=C.value)==null?void 0:l.dataset_id)||""}),et=O(()=>!!c.dataset_id&&!!c.dataset_version&&!!c.experiment_name),tt=O(()=>!!c.dataset_id&&!!c.dataset_version&&!!c.split_id),x=O(()=>_e.value||je.value),lt=O(()=>{var l;return Object.entries(((l=x.value)==null?void 0:l.metrics)||{})}),st=O(()=>{var l;return Object.entries(((l=x.value)==null?void 0:l.ci95)||{})}),Me=O(()=>Object.keys(Ne.value||{})),Re=O(()=>{var l;return((l=Ne.value)==null?void 0:l[se.value])||[]}),be=O(()=>{var e,a;const l=(a=(e=g.value)==null?void 0:e.leakage_audit)==null?void 0:a.overlap;return l?Number(l.boreholes_train_val||0)>0||Number(l.boreholes_train_test||0)>0||Number(l.boreholes_val_test||0)>0:!1}),at=O(()=>{const l=M.value||[],e={};for(const a of j){const n=l.map(i=>{var m;return Number((m=i==null?void 0:i.metrics)==null?void 0:m[a])}).filter(i=>Number.isFinite(i));n.length&&(e[a]=ve.has(a)?Math.max(...n):Math.min(...n))}return e}),re=O(()=>{var e,a;const l=new Map;for(const n of M.value||[]){const i=String(((e=n==null?void 0:n.spec)==null?void 0:e.model_type)||"unknown");l.has(i)||l.set(i,{model_type:i,sample_count:0,values:{},metrics:{}});const m=l.get(i);m.sample_count+=1;for(const f of j){const r=Number((a=n==null?void 0:n.metrics)==null?void 0:a[f]);Number.isFinite(r)&&(m.values[f]||(m.values[f]=[]),m.values[f].push(r))}}for(const n of l.values())for(const i of j){const m=n.values[i]||[];m.length&&(n.metrics[i]=m.reduce((f,r)=>f+r,0)/m.length)}return Array.from(l.values()).sort((n,i)=>n.model_type.localeCompare(i.model_type))}),de=O(()=>{var a,n,i,m;const l=M.value||[],e=[];for(const f of j){let r=null;for(const N of l){const $=Number((a=N==null?void 0:N.metrics)==null?void 0:a[f]);if(!Number.isFinite($))continue;if(!r){r=N;continue}const T=Number((n=r==null?void 0:r.metrics)==null?void 0:n[f]);(ve.has(f)?$>T:$<T)&&(r=N)}r&&e.push({metric:f,value:Number((i=r==null?void 0:r.metrics)==null?void 0:i[f]),exp_id:(r==null?void 0:r.exp_id)||"",model_type:((m=r==null?void 0:r.spec)==null?void 0:m.model_type)||"unknown"})}return e}),nt=O(()=>{const l={};for(const e of de.value)l[e.metric]=e.exp_id;return l}),k=O(()=>{const l=oe.value,e=(M.value||[]).map(_=>{var ne,ie,s;const V=Number((ne=_==null?void 0:_.metrics)==null?void 0:ne[l]);if(!Number.isFinite(V))return null;const G=(ie=_==null?void 0:_.ci95)==null?void 0:ie[l],ee=Number(G==null?void 0:G[0]),te=Number(G==null?void 0:G[1]);return{exp_id:_.exp_id,shortExpId:String(_.exp_id||"").slice(-8),value:V,ciLow:Number.isFinite(ee)?ee:V,ciHigh:Number.isFinite(te)?te:V,hasCi:Number.isFinite(ee)&&Number.isFinite(te),isChampion:((s=nt.value)==null?void 0:s[l])===_.exp_id}}).filter(Boolean);if(!e.length)return null;const a=900,n={top:20,right:34,bottom:34,left:110},i=28,m=Math.max(160,e.length*i),f=n.top+m+n.bottom,r=a-n.left-n.right,N=Math.min(...e.map(_=>Math.min(_.ciLow,_.value))),$=Math.max(...e.map(_=>Math.max(_.ciHigh,_.value))),z=Math.max($-N,1e-9)*.12,U=N-z,q=$+z,S=Math.max(q-U,1e-9),P=_=>n.left+(_-U)/S*r,Q=Array.from({length:5},(_,V)=>U+V/4*S),Y=e.map((_,V)=>xe(ge({},_),{y:n.top+14+V*i}));return{width:a,height:f,margin:n,plotWidth:r,plotHeight:m,rows:Y,ticks:Q,scaleX:P}}),I=O(()=>{const l=oe.value,e=(re.value||[]).map(_=>{var V;return{model_type:_.model_type,value:Number((V=_==null?void 0:_.metrics)==null?void 0:V[l])}}).filter(_=>Number.isFinite(_.value));if(!e.length)return null;const a=900,n={top:20,right:60,bottom:20,left:150},i=34,m=20,f=Math.max(140,e.length*i),r=n.top+f+n.bottom,N=a-n.left-n.right,$=Math.min(...e.map(_=>_.value)),T=Math.max(...e.map(_=>_.value)),U=Math.max(T-$,1e-9)*.1,q=Math.min(0,$-U),S=T+U,P=Math.max(S-q,1e-9),Q=_=>n.left+(_-q)/P*N,Y=e.map((_,V)=>xe(ge({},_),{y:n.top+16+V*i,height:m}));return{width:a,height:r,margin:n,plotWidth:N,plotHeight:f,rows:Y,scaleX:Q}}),Ue=l=>String(l||"").split(",").map(e=>e.trim()).filter(Boolean),it=l=>Array.from(new Set(String(l||"").split(/[\s,]+/g).map(e=>e.trim()).filter(Boolean))),ot=l=>Ue(l).map(e=>{if(/^(true|false)$/i.test(e))return e.toLowerCase()==="true";const a=Number(e);return Number.isFinite(a)?a:e}),rt=l=>{const e=String(l!=null?l:"").trim();if(!e)return null;const a=Number(e);return Number.isFinite(a)?a:null},Z=(l,e)=>{var a,n;return((n=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:n.detail)||(l==null?void 0:l.message)||e},X=(l,e=4)=>{const a=Number(l);return Number.isFinite(a)?a.toFixed(e):"-"},ut=l=>{const e=Number(l);return!Number.isFinite(e)||e<0?"-":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(2)} MB`},he=(l,e)=>{const a=URL.createObjectURL(l),n=document.createElement("a");n.href=a,n.download=e,n.click(),URL.revokeObjectURL(a)},Ve=()=>new Date().toISOString().replace(/[:.]/g,"-"),ye=l=>{var n;const e=String(l||"").trim();!e||String(((n=E.query)==null?void 0:n.exp_id)||"").trim()===e||we.replace({path:"/research-workbench",query:xe(ge({},E.query),{exp_id:e})}).catch(()=>{})},dt=()=>D(this,null,function*(){var e;const l=String(((e=E.query)==null?void 0:e.exp_id)||"").trim();l&&(A.value=l,yield Oe(),yield Ae())}),pt=()=>D(this,null,function*(){if(pe)return pe;const l=yield Ft(()=>import("./jszip-CsMIhXuR.js").then(e=>e.j),[]);if(pe=(l==null?void 0:l.default)||(l==null?void 0:l.JSZip)||null,!pe)throw new Error("JSZip 加载失败");return pe}),ct=(l,e)=>{const a=String(l||""),n=a.match(/filename\*=UTF-8''([^;]+)/i);if(n!=null&&n[1])try{return decodeURIComponent(n[1])}catch(m){return n[1]}const i=a.match(/filename="?([^";]+)"?/i);return(i==null?void 0:i[1])||e},mt=(l,e)=>{var i;const a=Number(e);if(!Number.isFinite(a))return!1;const n=Number((i=at.value)==null?void 0:i[l]);return Number.isFinite(n)?Math.abs(n-a)<=1e-12:!1},Be=l=>{var n;if(!(l!=null&&l.length))return"";const a=[["exp_id","model_type","dataset_id","dataset_version","split_id",...j,"created_at"].join(",")];for(const i of l){const m=((n=i==null?void 0:i.spec)==null?void 0:n.model_type)||"",f=[(i==null?void 0:i.exp_id)||"",m,(i==null?void 0:i.dataset_id)||"",(i==null?void 0:i.dataset_version)||"",(i==null?void 0:i.split_id)||"",...j.map(r=>{var N,$;return($=(N=i==null?void 0:i.metrics)==null?void 0:N[r])!=null?$:""}),(i==null?void 0:i.created_at)||""];a.push(f.map(r=>`"${String(r).replace(/"/g,'""')}"`).join(","))}return`${a.join(`
`)}
`},vt=l=>{if(!(l!=null&&l.length))return"";const a=[["model_type","sample_count",...j].join(",")];for(const n of l){const i=[n.model_type,n.sample_count,...j.map(m=>{var f,r;return(r=(f=n==null?void 0:n.metrics)==null?void 0:f[m])!=null?r:""})];a.push(i.map(m=>`"${String(m).replace(/"/g,'""')}"`).join(","))}return`${a.join(`
`)}
`},_t=()=>{var a,n,i,m,f,r,N,$,T,z,U,q,S,P,Q,Y,_,V,G,ee,te,ne,ie,s,R,W,ce,me,Te,Je,Le,Xe,ze,He,qe,Pe,Ge,Ze;const l=oe.value;return["# Methods Summary","","## Data Governance",`- Dataset ID: ${((a=C.value)==null?void 0:a.dataset_id)||"-"}`,`- Dataset Version: ${((n=C.value)==null?void 0:n.dataset_version)||"-"}`,`- Dataset Rows: ${(m=(i=C.value)==null?void 0:i.row_count)!=null?m:"-"}`,`- Label Column: ${((r=(f=C.value)==null?void 0:f.label_schema)==null?void 0:r.label_column)||"-"}`,`- Positive Values: ${((($=(N=C.value)==null?void 0:N.label_schema)==null?void 0:$.positive_values)||[]).join(", ")||"-"}`,"","## Split Strategy",`- Split ID: ${((T=g.value)==null?void 0:T.split_id)||((z=x.value)==null?void 0:z.split_id)||"-"}`,`- Strategy: ${((U=g.value)==null?void 0:U.strategy)||"-"}`,`- Ratios: train=${(P=(S=(q=g.value)==null?void 0:q.ratios)==null?void 0:S.train)!=null?P:"-"}, val=${(_=(Y=(Q=g.value)==null?void 0:Q.ratios)==null?void 0:Y.val)!=null?_:"-"}, test=${(ee=(G=(V=g.value)==null?void 0:V.ratios)==null?void 0:G.test)!=null?ee:"-"}`,`- Leakage Overlap: train-val=${(s=(ie=(ne=(te=g.value)==null?void 0:te.leakage_audit)==null?void 0:ne.overlap)==null?void 0:ie.boreholes_train_val)!=null?s:"-"}, train-test=${(me=(ce=(W=(R=g.value)==null?void 0:R.leakage_audit)==null?void 0:W.overlap)==null?void 0:ce.boreholes_train_test)!=null?me:"-"}, val-test=${(Xe=(Le=(Je=(Te=g.value)==null?void 0:Te.leakage_audit)==null?void 0:Je.overlap)==null?void 0:Le.boreholes_val_test)!=null?Xe:"-"}`,"","## Experiment Protocol",`- Primary Experiment ID: ${((ze=x.value)==null?void 0:ze.exp_id)||"-"}`,`- Model Type: ${((qe=(He=x.value)==null?void 0:He.spec)==null?void 0:qe.model_type)||"-"}`,`- Seed: ${(Ze=(Ge=(Pe=x.value)==null?void 0:Pe.spec)==null?void 0:Ge.seed)!=null?Ze:"-"}`,`- Metrics: ${j.join(", ")}`,"- Statistics: bootstrap 95% CI and paired significance (as implemented by backend experiment runner).","","## Comparison Snapshot",`- Compared Experiments: ${M.value.length}`,`- Visualized Metric: ${l}`,`- Model Groups: ${re.value.length}`,`- Champion Count: ${de.value.length}`,"","## Notes","- This material is generated from current reproducibility workspace state.","- Use this file as supplementary methods draft for manuscript preparation."].join(`
`)},Fe=l=>String(l!=null?l:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),ft=()=>{const l=k.value;if(!l)return"";const e=[];e.push(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${l.width} ${l.height}">`),e.push(`<rect x="0" y="0" width="${l.width}" height="${l.height}" fill="#ffffff"/>`);for(const a of l.ticks){const n=l.scaleX(a);e.push(`<line x1="${n}" y1="${l.margin.top}" x2="${n}" y2="${l.margin.top+l.plotHeight}" stroke="#e2e8f0" stroke-width="1"/>`),e.push(`<text x="${n}" y="${l.height-6}" fill="#64748b" font-size="10" text-anchor="middle">${Number(a).toFixed(4)}</text>`)}for(const a of l.rows)e.push(`<line x1="${l.scaleX(a.ciLow)}" y1="${a.y}" x2="${l.scaleX(a.ciHigh)}" y2="${a.y}" stroke="#94a3b8" stroke-width="1.6"/>`),e.push(`<circle cx="${l.scaleX(a.value)}" cy="${a.y}" r="4.5" fill="${a.isChampion?"#dc2626":"#0f766e"}"/>`),e.push(`<text x="${l.margin.left-8}" y="${a.y+4}" fill="#0f172a" font-size="10" text-anchor="end">${Fe(a.shortExpId)}</text>`);return e.push("</svg>"),e.join("")},bt=()=>{const l=I.value;if(!l)return"";const e=[];e.push(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${l.width} ${l.height}">`),e.push(`<rect x="0" y="0" width="${l.width}" height="${l.height}" fill="#ffffff"/>`);for(const a of l.rows){const n=l.scaleX(0),i=l.scaleX(a.value),m=Math.min(n,i),f=Math.abs(i-n);e.push(`<rect x="${m}" y="${a.y-a.height/2}" width="${f}" height="${a.height}" rx="4" fill="#0f766e" opacity="0.85"/>`),e.push(`<text x="${l.margin.left-8}" y="${a.y+4}" fill="#0f172a" font-size="10" text-anchor="end">${Fe(a.model_type)}</text>`),e.push(`<text x="${i+6}" y="${a.y+4}" fill="#475569" font-size="10">${Number(a.value).toFixed(4)}</text>`)}return e.push("</svg>"),e.join("")},Ie=l=>{var e;l&&(ae.value=l.dataset_id||ae.value,c.dataset_id=l.dataset_id||c.dataset_id,c.dataset_version=l.dataset_version||c.dataset_version,(e=l.label_schema)!=null&&e.label_column&&!c.target_label_column&&(c.target_label_column=l.label_schema.label_column))},ht=()=>D(this,null,function*(){p.register=!0;try{const l={dataset_id:h.dataset_id,description:h.description,label_schema:{label_column:h.label_column,positive_values:ot(h.positive_values),event_definition:h.event_definition,time_window_hours:Number(h.time_window_hours||24),threshold:rt(h.threshold)}},{data:e}=yield Jt(l);C.value=e,g.value=null,Ie(e),v.success(`注册成功：${e.dataset_id}`)}catch(l){v.error(Z(l,"数据集注册失败"))}finally{p.register=!1}}),yt=()=>D(this,null,function*(){if(ae.value){p.loadDataset=!0;try{const{data:l}=yield Lt(ae.value);C.value=l,Ie(l),v.success(`已加载 manifest：${l.dataset_id}`)}catch(l){v.error(Z(l,"数据集查询失败"))}finally{p.loadDataset=!1}}}),gt=()=>D(this,null,function*(){if(Ee.value){p.split=!0;try{const l={strategy:b.strategy,train_ratio:Number(b.train_ratio),val_ratio:Number(b.val_ratio),test_ratio:Number(b.test_ratio),seed:Number(b.seed),time_column:b.time_column||null,borehole_column:b.borehole_column||null},{data:e}=yield Xt(Ee.value,l);g.value=e,c.split_id=e.split_id||c.split_id,v[be.value?"warning":"success"](be.value?"切分完成，但检测到钻孔交叉":`切分成功：${e.split_id}`)}catch(l){v.error(Z(l,"数据切分失败"))}finally{p.split=!1}}}),xt=()=>D(this,null,function*(){p.runExperiment=!0;try{const l={dataset_id:c.dataset_id,dataset_version:c.dataset_version,split_id:c.split_id||null,experiment_name:c.experiment_name,model_type:c.model_type,target_label_column:c.target_label_column||null,metrics:Ue(c.metrics),seed:Number(c.seed)},{data:e}=yield zt(l);je.value=e,_e.value=e,A.value=e.exp_id,ye(e.exp_id),K.value=[],v.success(`实验完成：${e.exp_id}`)}catch(l){v.error(Z(l,"实验运行失败"))}finally{p.runExperiment=!1}}),De=()=>D(this,null,function*(){p.loadTemplates=!0;try{const{data:l}=yield Tt();Ne.value=(l==null?void 0:l.templates)||{},!se.value&&Me.value.length>0&&(se.value=Me.value[0])}catch(l){v.error(Z(l,"模板查询失败"))}finally{p.loadTemplates=!1}}),kt=()=>D(this,null,function*(){var l,e;if(se.value){p.runSuite=!0;try{const a={template_name:se.value,dataset_id:c.dataset_id,dataset_version:c.dataset_version,split_id:c.split_id,seed:Number(c.seed)},{data:n}=yield Ht(a);ue.value=n;const i=(e=(l=n==null?void 0:n.runs)==null?void 0:l[0])==null?void 0:e.exp_id;i&&(A.value=i,ye(i)),v.success(`模板实验完成：${n.suite_id}`)}catch(a){v.error(Z(a,"模板实验运行失败"))}finally{p.runSuite=!1}}}),Oe=()=>D(this,null,function*(){if(A.value){p.loadResult=!0;try{const{data:l}=yield Qe(A.value);_e.value=l,ye(l.exp_id),v.success(`已加载结果：${l.exp_id}`)}catch(l){v.error(Z(l,"实验结果查询失败"))}finally{p.loadResult=!1}}}),Ae=()=>D(this,null,function*(){if(A.value){p.loadArtifacts=!0;try{const{data:l}=yield qt(A.value);K.value=(l==null?void 0:l.artifacts)||[],v.success(`已加载产物：${K.value.length} 个`)}catch(l){v.error(Z(l,"实验产物查询失败"))}finally{p.loadArtifacts=!1}}}),$t=l=>D(this,null,function*(){var n,i;const e=A.value||((n=x.value)==null?void 0:n.exp_id),a=l==null?void 0:l.name;if(!(!e||!a)){p.downloadArtifact=!0,fe.value=a;try{const m=yield Ye(e,a),f=ct((i=m==null?void 0:m.headers)==null?void 0:i["content-disposition"],a);he(m.data,f),v.success(`已下载：${f}`)}catch(m){v.error(Z(m,"产物下载失败"))}finally{p.downloadArtifact=!1,fe.value=""}}}),St=()=>D(this,null,function*(){const l=it(Ce.value);if(!l.length){v.warning("请先输入至少一个 exp_id");return}p.compare=!0;try{const e=yield Promise.allSettled(l.map(i=>Qe(i))),a=[],n=[];e.forEach((i,m)=>{var f;i.status==="fulfilled"&&((f=i.value)!=null&&f.data)?a.push(i.value.data):n.push(l[m])}),M.value=a,a.length>0&&(_e.value=a[0],A.value=a[0].exp_id,ye(a[0].exp_id)),n.length>0&&v.warning(`部分实验加载失败：${n.join(", ")}`),a.length>0?v.success(`已加载 ${a.length} 个实验用于对比`):v.error("没有可用实验结果")}catch(e){v.error(Z(e,"实验对比加载失败"))}finally{p.compare=!1}}),wt=()=>{if(!M.value.length)return;const l=new Blob([Be(M.value)],{type:"text/csv;charset=utf-8;"});he(l,`research_comparison_${Ve()}.csv`),v.success("对比 CSV 已导出")},Nt=()=>{if(!M.value.length)return;const l={exported_at:new Date().toISOString(),comparison_metric_order:j,rows:M.value},e=new Blob([JSON.stringify(l,null,2)],{type:"application/json;charset=utf-8"});he(e,`research_comparison_${Ve()}.json`),v.success("对比 JSON 已导出")},Ct=()=>D(this,null,function*(){var l,e,a,n,i,m;p.exportEvidence=!0;try{const f=yield pt(),r=new f,N=Ve(),$=A.value||((l=x.value)==null?void 0:l.exp_id)||"",T=["# Research Evidence Bundle","",`exported_at: ${new Date().toISOString()}`,`dataset_id: ${((e=C.value)==null?void 0:e.dataset_id)||"-"}`,`dataset_version: ${((a=C.value)==null?void 0:a.dataset_version)||"-"}`,`split_id: ${((n=g.value)==null?void 0:n.split_id)||((i=x.value)==null?void 0:i.split_id)||"-"}`,`primary_exp_id: ${$||"-"}`,"","包含内容:","- manifests/dataset_manifest.json","- manifests/dataset_quality_report.json","- manifests/split_manifest.json","- results/latest_result.json","- results/suite_result.json","- methods/methods.md","- comparison/*.json|csv","- figures/*.svg","- artifacts/index.json (和可下载产物)"];if(r.file("README.md",T.join(`
`)),r.file("methods/methods.md",_t()),C.value&&(r.file("manifests/dataset_manifest.json",JSON.stringify(C.value,null,2)),(m=C.value)!=null&&m.quality_report&&r.file("manifests/dataset_quality_report.json",JSON.stringify(C.value.quality_report,null,2))),g.value&&r.file("manifests/split_manifest.json",JSON.stringify(g.value,null,2)),x.value&&r.file("results/latest_result.json",JSON.stringify(x.value,null,2)),ue.value&&r.file("results/suite_result.json",JSON.stringify(ue.value,null,2)),M.value.length&&(r.file("comparison/comparison_rows.json",JSON.stringify(M.value,null,2)),r.file("comparison/comparison_rows.csv",Be(M.value))),re.value.length&&(r.file("comparison/model_summary.json",JSON.stringify(re.value,null,2)),r.file("comparison/model_summary.csv",vt(re.value))),de.value.length&&r.file("comparison/champions.json",JSON.stringify(de.value,null,2)),k.value){r.file("comparison/point_chart_data.json",JSON.stringify(k.value.rows,null,2));const S=ft();S&&r.file("figures/comparison_point_chart.svg",S)}if(I.value){r.file("comparison/model_bar_chart_data.json",JSON.stringify(I.value.rows,null,2));const S=bt();S&&r.file("figures/model_summary_bar.svg",S)}r.file("artifacts/index.json",JSON.stringify(K.value||[],null,2));const z=[],U=[];if($&&K.value.length)for(const S of K.value)try{const P=yield Ye($,S.name);r.file(`artifacts/files/${S.name}`,P.data),z.push(S.name)}catch(P){U.push(S.name)}r.file("artifacts/download_report.json",JSON.stringify({exp_id:$,requested:K.value.map(S=>S.name),downloaded:z,failed:U},null,2));const q=yield r.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}});he(q,`research_evidence_bundle_${N}.zip`),U.length?v.warning(`证据包已导出，${U.length} 个产物未能打包`):v.success("证据包 ZIP 已导出")}catch(f){v.error(Z(f,"证据包导出失败"))}finally{p.exportEvidence=!1}});return It(()=>D(this,null,function*(){yield De(),yield dt()})),(l,e)=>{var a,n,i,m,f,r,N,$,T,z,U,q,S,P,Q,Y,_,V,G,ee,te,ne,ie;return d(),u("div",Pt,[t("header",Gt,[e[27]||(e[27]=t("div",null,[t("h1",null,"科研工作台"),t("p",null,"面向论文复现：数据版本化、泄漏审计、实验运行、结果归档一体化。")],-1)),t("div",Zt,[t("span",Wt,"Dataset "+o(((a=C.value)==null?void 0:a.dataset_id)||"-"),1),t("span",{class:ke(["status-pill",g.value?"ok":"idle"])},"Split "+o(((n=g.value)==null?void 0:n.split_id)||"-"),3),t("span",{class:ke(["status-pill",x.value?"ok":"idle"])},"Experiment "+o(((i=x.value)==null?void 0:i.exp_id)||"-"),3)])]),t("section",Kt,[t("article",Qt,[e[35]||(e[35]=t("div",{class:"panel-head"},[t("h2",null,"1) 数据集注册"),t("span",{class:"tip"},"固定标签口径与版本哈希")],-1)),t("div",Yt,[t("label",null,[e[28]||(e[28]=t("span",null,"dataset_id",-1)),y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>h.dataset_id=s),class:"input",placeholder:"例如 research_demo"},null,512),[[w,h.dataset_id,void 0,{trim:!0}]])]),t("label",null,[e[29]||(e[29]=t("span",null,"label_column",-1)),y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>h.label_column=s),class:"input",placeholder:"例如 label"},null,512),[[w,h.label_column,void 0,{trim:!0}]])]),t("label",null,[e[30]||(e[30]=t("span",null,"positive_values (逗号分隔)",-1)),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>h.positive_values=s),class:"input",placeholder:"例如 1,true,high"},null,512),[[w,h.positive_values,void 0,{trim:!0}]])]),t("label",null,[e[31]||(e[31]=t("span",null,"event_definition",-1)),y(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>h.event_definition=s),class:"input"},null,512),[[w,h.event_definition,void 0,{trim:!0}]])]),t("label",null,[e[32]||(e[32]=t("span",null,"time_window_hours",-1)),y(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>h.time_window_hours=s),type:"number",min:"1",class:"input"},null,512),[[w,h.time_window_hours,void 0,{number:!0}]])]),t("label",null,[e[33]||(e[33]=t("span",null,"threshold (可选)",-1)),y(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>h.threshold=s),class:"input",placeholder:"留空表示 null"},null,512),[[w,h.threshold,void 0,{trim:!0}]])]),t("label",el,[e[34]||(e[34]=t("span",null,"description",-1)),y(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>h.description=s),class:"input textarea",rows:"3",placeholder:"数据来源、标签定义、时间空间对齐说明"},null,512),[[w,h.description,void 0,{trim:!0}]])])]),t("div",tl,[t("button",{class:"btn",disabled:p.register||!h.dataset_id||!h.label_column,onClick:ht},o(p.register?"注册中...":"注册数据集"),9,ll)])]),t("article",sl,[e[52]||(e[52]=t("div",{class:"panel-head"},[t("h2",null,"2) 数据集查询与切分"),t("span",{class:"tip"},"防止时间/钻孔泄漏")],-1)),t("div",al,[y(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>ae.value=s),class:"input",placeholder:"输入 dataset_id 查询 manifest"},null,512),[[w,ae.value,void 0,{trim:!0}]]),t("button",{class:"btn secondary",disabled:p.loadDataset||!ae.value,onClick:yt},o(p.loadDataset?"查询中...":"查询"),9,nl)]),C.value?(d(),u("div",il,[t("span",ol,[e[36]||(e[36]=le("version: ",-1)),t("b",null,o(C.value.dataset_version),1)]),t("span",rl,[e[37]||(e[37]=le("rows: ",-1)),t("b",null,o(C.value.row_count),1)]),t("span",ul,[e[38]||(e[38]=le("cols: ",-1)),t("b",null,o(C.value.column_count),1)]),t("span",dl,[e[39]||(e[39]=le("file: ",-1)),t("b",null,o(C.value.dataset_file),1)])])):J("",!0),t("div",pl,[t("label",null,[e[41]||(e[41]=t("span",null,"strategy",-1)),y(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>b.strategy=s)},[...e[40]||(e[40]=[t("option",{value:"time_borehole_block"},"time_borehole_block",-1),t("option",{value:"borehole_block"},"borehole_block",-1),t("option",{value:"time_block"},"time_block",-1),t("option",{value:"random"},"random",-1)])],512),[[$e,b.strategy]])]),t("label",null,[e[42]||(e[42]=t("span",null,"train_ratio",-1)),y(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>b.train_ratio=s),type:"number",step:"0.05",min:"0.05",max:"0.95",class:"input"},null,512),[[w,b.train_ratio,void 0,{number:!0}]])]),t("label",null,[e[43]||(e[43]=t("span",null,"val_ratio",-1)),y(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>b.val_ratio=s),type:"number",step:"0.05",min:"0.05",max:"0.95",class:"input"},null,512),[[w,b.val_ratio,void 0,{number:!0}]])]),t("label",null,[e[44]||(e[44]=t("span",null,"test_ratio",-1)),y(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>b.test_ratio=s),type:"number",step:"0.05",min:"0.05",max:"0.95",class:"input"},null,512),[[w,b.test_ratio,void 0,{number:!0}]])]),t("label",null,[e[45]||(e[45]=t("span",null,"time_column (可选)",-1)),y(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>b.time_column=s),class:"input",placeholder:"例如 event_time"},null,512),[[w,b.time_column,void 0,{trim:!0}]])]),t("label",null,[e[46]||(e[46]=t("span",null,"borehole_column (可选)",-1)),y(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>b.borehole_column=s),class:"input",placeholder:"例如 borehole_name"},null,512),[[w,b.borehole_column,void 0,{trim:!0}]])]),t("label",null,[e[47]||(e[47]=t("span",null,"seed",-1)),y(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>b.seed=s),type:"number",class:"input"},null,512),[[w,b.seed,void 0,{number:!0}]])])]),t("div",cl,[t("button",{class:"btn",disabled:p.split||!Ee.value,onClick:gt},o(p.split?"切分中...":"执行切分"),9,ml)]),g.value?(d(),u("div",vl,[t("div",_l,[t("div",null,[e[48]||(e[48]=t("span",null,"train",-1)),t("strong",null,o((f=(m=g.value.counts)==null?void 0:m.train)!=null?f:0),1)]),t("div",null,[e[49]||(e[49]=t("span",null,"val",-1)),t("strong",null,o((N=(r=g.value.counts)==null?void 0:r.val)!=null?N:0),1)]),t("div",null,[e[50]||(e[50]=t("span",null,"test",-1)),t("strong",null,o((T=($=g.value.counts)==null?void 0:$.test)!=null?T:0),1)])]),t("div",{class:ke(["leakage",be.value?"warn":"safe"])},[e[51]||(e[51]=t("span",null,"泄漏审计",-1)),be.value?(d(),u("b",fl," train-val "+o(((U=(z=g.value.leakage_audit)==null?void 0:z.overlap)==null?void 0:U.boreholes_train_val)||0)+", train-test "+o(((S=(q=g.value.leakage_audit)==null?void 0:q.overlap)==null?void 0:S.boreholes_train_test)||0)+", val-test "+o(((Q=(P=g.value.leakage_audit)==null?void 0:P.overlap)==null?void 0:Q.boreholes_val_test)||0),1)):(d(),u("b",bl,"钻孔无交叉"))],2)])):J("",!0)])]),t("section",hl,[t("article",yl,[e[62]||(e[62]=t("div",{class:"panel-head"},[t("h2",null,"3) 单实验运行"),t("span",{class:"tip"},"输出 metrics + calibration + ci95")],-1)),t("div",gl,[t("label",null,[e[53]||(e[53]=t("span",null,"dataset_id",-1)),y(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>c.dataset_id=s),class:"input"},null,512),[[w,c.dataset_id,void 0,{trim:!0}]])]),t("label",null,[e[54]||(e[54]=t("span",null,"dataset_version",-1)),y(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>c.dataset_version=s),class:"input"},null,512),[[w,c.dataset_version,void 0,{trim:!0}]])]),t("label",null,[e[55]||(e[55]=t("span",null,"split_id",-1)),y(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>c.split_id=s),class:"input"},null,512),[[w,c.split_id,void 0,{trim:!0}]])]),t("label",null,[e[56]||(e[56]=t("span",null,"experiment_name",-1)),y(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>c.experiment_name=s),class:"input"},null,512),[[w,c.experiment_name,void 0,{trim:!0}]])]),t("label",null,[e[58]||(e[58]=t("span",null,"model_type",-1)),y(t("select",{"onUpdate:modelValue":e[19]||(e[19]=s=>c.model_type=s)},[...e[57]||(e[57]=[Dt('<option value="baseline" data-v-7fb219fe>baseline</option><option value="rsi_phase_field" data-v-7fb219fe>rsi_phase_field</option><option value="asi_ust" data-v-7fb219fe>asi_ust</option><option value="geomodel_aware" data-v-7fb219fe>geomodel_aware</option><option value="geomodel_ablation" data-v-7fb219fe>geomodel_ablation</option><option value="pinchout_sensitive" data-v-7fb219fe>pinchout_sensitive</option><option value="rk_enhanced" data-v-7fb219fe>rk_enhanced</option><option value="kriging_baseline" data-v-7fb219fe>kriging_baseline</option><option value="custom" data-v-7fb219fe>custom</option>',9)])],512),[[$e,c.model_type]])]),t("label",null,[e[59]||(e[59]=t("span",null,"target_label_column (可选)",-1)),y(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>c.target_label_column=s),class:"input"},null,512),[[w,c.target_label_column,void 0,{trim:!0}]])]),t("label",null,[e[60]||(e[60]=t("span",null,"metrics (逗号分隔)",-1)),y(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>c.metrics=s),class:"input"},null,512),[[w,c.metrics,void 0,{trim:!0}]])]),t("label",null,[e[61]||(e[61]=t("span",null,"seed",-1)),y(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>c.seed=s),type:"number",class:"input"},null,512),[[w,c.seed,void 0,{number:!0}]])])]),t("div",xl,[t("button",{class:"btn",disabled:p.runExperiment||!et.value,onClick:xt},o(p.runExperiment?"运行中...":"运行实验"),9,kl)])]),t("article",$l,[e[66]||(e[66]=t("div",{class:"panel-head"},[t("h2",null,"4) 模板批量实验"),t("span",{class:"tip"},"论文主实验与基线对照")],-1)),t("div",Sl,[y(t("select",{"onUpdate:modelValue":e[23]||(e[23]=s=>se.value=s)},[(d(!0),u(B,null,F(Me.value,s=>(d(),u("option",{key:s,value:s},o(s),9,wl))),128))],512),[[$e,se.value]]),t("button",{class:"btn secondary",disabled:p.loadTemplates,onClick:De},o(p.loadTemplates?"刷新中...":"刷新模板"),9,Nl)]),Re.value.length?(d(),u("div",Cl,[t("table",El,[e[63]||(e[63]=t("thead",null,[t("tr",null,[t("th",null,"experiment_name"),t("th",null,"model_type")])],-1)),t("tbody",null,[(d(!0),u(B,null,F(Re.value,s=>(d(),u("tr",{key:`${s.experiment_name}-${s.model_type}`},[t("td",null,o(s.experiment_name),1),t("td",null,o(s.model_type),1)]))),128))])])])):J("",!0),t("div",Ml,[t("button",{class:"btn",disabled:p.runSuite||!tt.value||!se.value,onClick:kt},o(p.runSuite?"运行中...":"运行模板实验"),9,Vl)]),ue.value?(d(),u("div",jl,[t("div",Rl,[e[64]||(e[64]=le("suite_id: ",-1)),t("b",null,o(ue.value.suite_id),1)]),t("div",Ul,[e[65]||(e[65]=le("runs: ",-1)),t("b",null,o(((Y=ue.value.runs)==null?void 0:Y.length)||0),1)])])):J("",!0)])]),t("section",Bl,[e[81]||(e[81]=t("div",{class:"panel-head"},[t("h2",null,"5) 实验结果与产物查询"),t("span",{class:"tip"},"按 exp_id 回溯证据链")],-1)),t("div",Fl,[y(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>A.value=s),class:"input",placeholder:"输入 exp_id 查询"},null,512),[[w,A.value,void 0,{trim:!0}]]),t("button",{class:"btn secondary",disabled:p.loadResult||!A.value,onClick:Oe},o(p.loadResult?"查询中...":"查结果"),9,Il),t("button",{class:"btn secondary",disabled:p.loadArtifacts||!A.value,onClick:Ae},o(p.loadArtifacts?"查询中...":"查产物"),9,Dl),t("button",{class:"btn secondary",disabled:p.exportEvidence||!x.value&&!M.value.length,onClick:Ct},o(p.exportEvidence?"打包中...":"导出证据 ZIP"),9,Ol)]),x.value?(d(),u("div",Al,[t("article",Tl,[e[67]||(e[67]=t("h3",null,"关键指标",-1)),t("div",Jl,[(d(!0),u(B,null,F(lt.value,([s,R])=>(d(),u("div",{key:s,class:"metric-item"},[t("span",null,o(s),1),t("b",null,o(X(R,6)),1)]))),128))])]),t("article",Ll,[e[69]||(e[69]=t("h3",null,"95% 置信区间",-1)),t("table",Xl,[e[68]||(e[68]=t("thead",null,[t("tr",null,[t("th",null,"metric"),t("th",null,"low"),t("th",null,"high")])],-1)),t("tbody",null,[(d(!0),u(B,null,F(st.value,([s,R])=>(d(),u("tr",{key:s},[t("td",null,o(s),1),t("td",null,o(X(R==null?void 0:R[0],6)),1),t("td",null,o(X(R==null?void 0:R[1],6)),1)]))),128))])])])])):J("",!0),x.value?(d(),u("div",zl,[t("article",Hl,[e[74]||(e[74]=t("h3",null,"校准报告",-1)),t("div",ql,[t("span",null,[e[70]||(e[70]=le("ECE: ",-1)),t("b",null,o(X((_=x.value.calibration)==null?void 0:_.ece,6)),1)]),t("span",null,[e[71]||(e[71]=le("MCE: ",-1)),t("b",null,o(X((V=x.value.calibration)==null?void 0:V.mce,6)),1)]),t("span",null,[e[72]||(e[72]=le("Bins: ",-1)),t("b",null,o((ee=(G=x.value.calibration)==null?void 0:G.bin_count)!=null?ee:0),1)])]),t("table",Pl,[e[73]||(e[73]=t("thead",null,[t("tr",null,[t("th",null,"bin"),t("th",null,"count"),t("th",null,"acc"),t("th",null,"conf"),t("th",null,"gap")])],-1)),t("tbody",null,[(d(!0),u(B,null,F((((te=x.value.calibration)==null?void 0:te.bins)||[]).slice(0,10),s=>(d(),u("tr",{key:s.bin},[t("td",null,o(s.bin),1),t("td",null,o(s.count),1),t("td",null,o(X(s.acc,4)),1),t("td",null,o(X(s.conf,4)),1),t("td",null,o(X(s.gap,4)),1)]))),128))])])]),t("article",Gl,[e[78]||(e[78]=t("h3",null,"Traceability",-1)),t("div",Zl,[e[75]||(e[75]=t("span",null,"dataset_manifest",-1)),t("code",null,o(((ne=x.value.traceability)==null?void 0:ne.dataset_manifest)||"-"),1)]),t("div",Wl,[e[76]||(e[76]=t("span",null,"split_manifest",-1)),t("code",null,o(((ie=x.value.traceability)==null?void 0:ie.split_manifest)||"-"),1)]),t("div",Kl,[e[77]||(e[77]=t("span",null,"created_at",-1)),t("code",null,o(x.value.created_at||"-"),1)])])])):J("",!0),K.value.length?(d(),u("article",Ql,[e[80]||(e[80]=t("h3",null,"Artifacts",-1)),t("table",Yl,[e[79]||(e[79]=t("thead",null,[t("tr",null,[t("th",null,"name"),t("th",null,"size"),t("th",null,"path"),t("th",null,"action")])],-1)),t("tbody",null,[(d(!0),u(B,null,F(K.value,s=>(d(),u("tr",{key:s.path},[t("td",null,o(s.name),1),t("td",null,o(ut(s.size_bytes)),1),t("td",null,[t("code",null,o(s.path),1)]),t("td",null,[t("button",{class:"btn secondary btn-inline",disabled:p.downloadArtifact&&fe.value===s.name,onClick:R=>$t(s)},o(p.downloadArtifact&&fe.value===s.name?"下载中...":"下载"),9,es)])]))),128))])])])):J("",!0)]),t("section",ts,[e[91]||(e[91]=t("div",{class:"panel-head"},[t("h2",null,"6) 实验对比看板"),t("span",{class:"tip"},"按多个 exp_id 横向比较，支持 CSV/JSON 导出")],-1)),t("label",ls,[e[82]||(e[82]=t("span",null,"exp_id 列表（逗号、空格或换行分隔）",-1)),y(t("textarea",{"onUpdate:modelValue":e[25]||(e[25]=s=>Ce.value=s),class:"input textarea",rows:"4",placeholder:"exp_20260208_120000_xxxxxx, exp_20260208_120500_yyyyyy"},null,512),[[w,Ce.value,void 0,{trim:!0}]])]),t("div",ss,[t("button",{class:"btn",disabled:p.compare,onClick:St},o(p.compare?"加载中...":"加载对比"),9,as),t("button",{class:"btn secondary",disabled:!M.value.length,onClick:wt}," 导出 CSV ",8,ns),t("button",{class:"btn secondary",disabled:!M.value.length,onClick:Nt}," 导出 JSON ",8,is)]),M.value.length?(d(),u("div",os,[t("label",null,[e[83]||(e[83]=t("span",null,"可视化指标",-1)),y(t("select",{"onUpdate:modelValue":e[26]||(e[26]=s=>oe.value=s)},[(d(),u(B,null,F(j,s=>t("option",{key:`viz-${s}`,value:s},o(s),9,rs)),64))],512),[[$e,oe.value]])])])):J("",!0),k.value?(d(),u("div",us,[t("article",ds,[t("h3",null,"实验分布与95%CI（"+o(oe.value)+"）",1),(d(),u("svg",{class:"compare-svg",viewBox:`0 0 ${k.value.width} ${k.value.height}`,preserveAspectRatio:"none"},[t("rect",{x:k.value.margin.left,y:k.value.margin.top,width:k.value.plotWidth,height:k.value.plotHeight,fill:"#f8fafc",stroke:"#e2e8f0"},null,8,cs),(d(!0),u(B,null,F(k.value.ticks,s=>(d(),u("g",{key:`tick-${s}`},[t("line",{x1:k.value.scaleX(s),x2:k.value.scaleX(s),y1:k.value.margin.top,y2:k.value.margin.top+k.value.plotHeight,stroke:"#cbd5e1","stroke-dasharray":"3 3"},null,8,ms),t("text",{x:k.value.scaleX(s),y:k.value.height-8,"text-anchor":"middle",class:"axis-label"},o(X(s,4)),9,vs)]))),128)),(d(!0),u(B,null,F(k.value.rows,s=>(d(),u("g",{key:`pt-${s.exp_id}`},[s.hasCi?(d(),u("line",{key:0,x1:k.value.scaleX(s.ciLow),x2:k.value.scaleX(s.ciHigh),y1:s.y,y2:s.y,stroke:"#64748b","stroke-width":"1.5"},null,8,_s)):J("",!0),t("circle",{cx:k.value.scaleX(s.value),cy:s.y,r:"4.5",fill:s.isChampion?"#0f766e":"#0e7490"},null,8,fs),t("text",{x:k.value.margin.left-6,y:s.y+4,"text-anchor":"end",class:"axis-label left"},o(s.shortExpId),9,bs)]))),128))],8,ps))]),I.value?(d(),u("article",hs,[t("h3",null,"模型均值条形图（"+o(oe.value)+"）",1),(d(),u("svg",{class:"compare-svg",viewBox:`0 0 ${I.value.width} ${I.value.height}`,preserveAspectRatio:"none"},[t("rect",{x:I.value.margin.left,y:I.value.margin.top,width:I.value.plotWidth,height:I.value.plotHeight,fill:"#f8fafc",stroke:"#e2e8f0"},null,8,gs),(d(!0),u(B,null,F(I.value.rows,s=>(d(),u("g",{key:`bar-${s.model_type}`},[t("rect",{x:I.value.margin.left,y:s.y-s.height/2,width:I.value.scaleX(s.value)-I.value.margin.left,height:s.height,rx:"6",fill:"#0f766e",opacity:"0.88"},null,8,xs),t("text",{x:I.value.margin.left-8,y:s.y+4,"text-anchor":"end",class:"axis-label left"},o(s.model_type),9,ks),t("text",{x:I.value.scaleX(s.value)+6,y:s.y+4,class:"axis-label"},o(X(s.value,4)),9,$s)]))),128))],8,ys))])):J("",!0)])):J("",!0),M.value.length?(d(),u("div",Ss,[t("table",ws,[t("thead",null,[t("tr",null,[e[84]||(e[84]=t("th",null,"exp_id",-1)),e[85]||(e[85]=t("th",null,"model_type",-1)),(d(),u(B,null,F(j,s=>t("th",{key:`head-${s}`},o(s),1)),64))])]),t("tbody",null,[(d(!0),u(B,null,F(M.value,s=>{var R;return d(),u("tr",{key:s.exp_id},[t("td",null,[t("code",null,o(s.exp_id),1)]),t("td",null,o(((R=s.spec)==null?void 0:R.model_type)||"-"),1),(d(),u(B,null,F(j,W=>{var ce,me;return t("td",{key:`${s.exp_id}-${W}`},[t("span",{class:ke({best:mt(W,(ce=s.metrics)==null?void 0:ce[W])})},o(X((me=s.metrics)==null?void 0:me[W],6)),3)])}),64))])}),128))])])])):J("",!0),re.value.length?(d(),u("div",Ns,[e[88]||(e[88]=t("h3",null,"按模型聚合（均值）",-1)),t("table",Cs,[t("thead",null,[t("tr",null,[e[86]||(e[86]=t("th",null,"model_type",-1)),e[87]||(e[87]=t("th",null,"samples",-1)),(d(),u(B,null,F(j,s=>t("th",{key:`model-head-${s}`},o(s),1)),64))])]),t("tbody",null,[(d(!0),u(B,null,F(re.value,s=>(d(),u("tr",{key:s.model_type},[t("td",null,o(s.model_type),1),t("td",null,o(s.sample_count),1),(d(),u(B,null,F(j,R=>{var W;return t("td",{key:`model-${s.model_type}-${R}`},o(X((W=s.metrics)==null?void 0:W[R],6)),1)}),64))]))),128))])])])):J("",!0),de.value.length?(d(),u("div",Es,[e[90]||(e[90]=t("h3",null,"指标冠军",-1)),t("table",Ms,[e[89]||(e[89]=t("thead",null,[t("tr",null,[t("th",null,"metric"),t("th",null,"best_value"),t("th",null,"exp_id"),t("th",null,"model_type")])],-1)),t("tbody",null,[(d(!0),u(B,null,F(de.value,s=>(d(),u("tr",{key:`champion-${s.metric}`},[t("td",null,o(s.metric),1),t("td",null,o(X(s.value,6)),1),t("td",null,[t("code",null,o(s.exp_id),1)]),t("td",null,o(s.model_type),1)]))),128))])])])):J("",!0)])])}}},Ds=Ut(Vs,[["__scopeId","data-v-7fb219fe"]]);export{Ds as default};
