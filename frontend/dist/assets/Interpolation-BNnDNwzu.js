var st=Object.defineProperty,nt=Object.defineProperties;var at=Object.getOwnPropertyDescriptors;var Ge=Object.getOwnPropertySymbols;var it=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var ee=Math.pow,Je=(X,j,H)=>j in X?st(X,j,{enumerable:!0,configurable:!0,writable:!0,value:H}):X[j]=H,Pe=(X,j)=>{for(var H in j||(j={}))it.call(j,H)&&Je(X,H,j[H]);if(Ge)for(var H of Ge(j))rt.call(j,H)&&Je(X,H,j[H]);return X},Be=(X,j)=>nt(X,at(j));var $e=(X,j,H)=>new Promise((w,he)=>{var oe=V=>{try{K(H.next(V))}catch($){he($)}},ie=V=>{try{K(H.throw(V))}catch($){he($)}},K=V=>V.done?w(V.value):Promise.resolve(V.value).then(oe,ie);K((H=H.apply(X,j)).next())});import{e as ot,v as ct,o as M,b as P,a as l,t as k,z as we,x as dt,y as J,F as Re,r as De,n as qe,d as T,k as xe,g as Se,C as Oe,D as Ze,E as ut,A as We,c as Qe,G as et}from"./vue-vendor-uHJg9g_5.js";import{_ as lt,u as ht}from"./index-BQuJNExo.js";import{g as vt,a as ft,b as gt,c as mt}from"./api-BlLoGSss.js";import"./index-T6nY3V_4.js";const pt={key:0,class:"error-placeholder"},yt={class:"error-detail"},xt={key:1,class:"loading-placeholder"},bt=["src"],kt=["viewBox"],_t={key:0},St=["x1","y1","x2","y2"],wt=["cx","cy"],Mt=["x","y"],Tt=["cx","cy"],Ct=["x","y"],Ft=["x","y"],At=["x1","y1","x2","y2"],Pt=["transform","onMouseenter"],Bt=["fill"],$t={class:"map-controls"},Wt={key:1,class:"legend"},Rt={class:"legend-title"},Dt={class:"legend-range"},Et={class:"legend-min"},It={class:"legend-bar"},Yt={class:"legend-max"},Xt={key:0,class:"tooltip-borehole"},zt={class:"tooltip-name"},Lt={class:"tooltip-coords"},Ht={class:"tooltip-value"},Ut={class:"tooltip-label"},Nt={class:"tooltip-number"},Vt={__name:"ContourMap",props:{imageUrl:{type:String,default:""},boreholes:{type:Array,default:()=>[]},bounds:{type:Object,default:()=>({})},property:{type:String,default:"thickness"},propertyLabel:{type:String,default:"åšåº¦"},valueRange:{type:Object,default:()=>({min:0,max:10})},colormap:{type:String,default:"YlOrBr"},crossSectionMode:{type:Boolean,default:!1}},emits:["crossSectionChange","crossSectionComplete"],setup(X,{expose:j,emit:H}){const w=X,he=H,oe=T(null),ie=T(800),K=T(600),V=T(!1),$=T(null),U=T(1),se=T(0),re=T(0),de=T(!1),L=T(!1),Z=T({x:0,y:0}),Q=T(null),ne=T({x:0,y:0}),ve=T(!0),p=T({start:null,end:null,distance:null}),ue=T(null),ge=xe(()=>{if(w.bounds&&w.bounds.min_x!==void 0)return{minX:w.bounds.min_x,maxX:w.bounds.max_x,minY:w.bounds.min_y,maxY:w.bounds.max_y,rangeX:w.bounds.max_x-w.bounds.min_x,rangeY:w.bounds.max_y-w.bounds.min_y};if(w.boreholes.length===0)return null;let g=1/0,u=-1/0,t=1/0,e=-1/0;return w.boreholes.forEach(a=>{a.x<g&&(g=a.x),a.x>u&&(u=a.x),a.y<t&&(t=a.y),a.y>e&&(e=a.y)}),{minX:g,maxX:u,minY:t,maxY:e,rangeX:u-g,rangeY:e-t}}),Me=xe(()=>{if(!ge.value||w.boreholes.length===0)return[];if(!V.value||!w.imageUrl)return[];const g=ge.value,u=ie.value,t=K.value,e=u*.1,a=u*(1-.1-.85),n=t*.1,c=t*(1-.1-.8),o=u-e-a,s=t-n-c;return console.log("Image dimensions:",u,"x",t),console.log("Plot area:",{leftPadding:e.toFixed(1),rightPadding:a.toFixed(1),topPadding:c.toFixed(1),bottomPadding:n.toFixed(1),plotWidth:o.toFixed(1),plotHeight:s.toFixed(1)}),w.boreholes.map(i=>{var A,h;const r=(A=i.x)!=null?A:i.borehole_x,d=(h=i.y)!=null?h:i.borehole_y;if(r==null||d==null)return null;const x=(r-g.minX)/g.rangeX,I=(d-g.minY)/g.rangeY,R=e+x*o,_=t-n-I*s;return(i.borehole==="ZK101"||i.borehole==="ZK102")&&console.log(`Borehole ${i.borehole}:`,{world:{x:r.toFixed(1),y:d.toFixed(1)},relative:{x:x.toFixed(3),y:I.toFixed(3)},canvas:{x:R.toFixed(1),y:_.toFixed(1)}}),Be(Pe({},i),{x:r,y:d,canvasX:Math.round(R*10)/10,canvasY:Math.round(_*10)/10,color:Ee(i[w.property]||i.thickness||i.burial_depth)})}).filter(i=>i!==null)}),Ee=g=>{var a,n;if(g==null)return"#3b82f6";const u=((a=w.valueRange)==null?void 0:a.min)||0,t=((n=w.valueRange)==null?void 0:n.max)||1,e=Math.max(0,Math.min(1,(g-u)/(t-u||1)));return w.colormap==="YlOrBr"?Te(e,[{t:0,r:255,g:255,b:204},{t:.25,r:255,g:230,b:153},{t:.5,r:255,g:190,b:121},{t:.75,r:230,g:140,b:80},{t:1,r:160,g:80,b:50}]):Te(e,[{t:0,r:68,g:1,b:84},{t:.25,r:59,g:82,b:139},{t:.5,r:33,g:154,b:141},{t:.75,r:94,g:201,b:98},{t:1,r:253,g:231,b:37}])},Te=(g,u)=>{let t=u[0],e=u[u.length-1];for(let s=0;s<u.length-1;s++)if(g>=u[s].t&&g<=u[s+1].t){t=u[s],e=u[s+1];break}const a=e.t!==t.t?(g-t.t)/(e.t-t.t):0,n=Math.round(t.r+(e.r-t.r)*a),c=Math.round(t.g+(e.g-t.g)*a),o=Math.round(t.b+(e.b-t.b)*a);return`rgb(${n}, ${c}, ${o})`},Ce=xe(()=>({transform:`scale(${U.value}) translate(${se.value/U.value}px, ${re.value/U.value}px)`,transformOrigin:"center center",transition:de.value?"none":"transform 0.1s ease-out"})),be=xe(()=>({position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) scale(${U.value}) translate(${se.value/U.value}px, ${re.value/U.value}px)`,transformOrigin:"center center",pointerEvents:"none",transition:de.value?"none":"transform 0.1s ease-out",maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"})),Fe=xe(()=>({left:ne.value.x+15+"px",top:ne.value.y+15+"px"})),Ie=xe(()=>w.colormap==="YlOrBr"?"background: linear-gradient(to right, #fffacc, #ffe699, #ffbe79, #e68c50, #a05032)":"background: linear-gradient(to right, #440154, #3b528b, #21918c, #5ec962, #fde725)"),Ae=g=>{ie.value=g.target.naturalWidth,K.value=g.target.naturalHeight,V.value=!0,$.value=null,console.log("Image loaded successfully:",ie.value,"x",K.value),console.log("Bounds:",w.bounds),console.log("Boreholes count:",w.boreholes.length),w.boreholes.length>0&&console.log("First borehole:",{name:w.boreholes[0].borehole,x:w.boreholes[0].x,y:w.boreholes[0].y,thickness:w.boreholes[0].thickness})},Ye=g=>{var u;$.value="å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ•°æ®",V.value=!1,console.error("Image load error:",g),console.log("ImageUrl:",((u=w.imageUrl)==null?void 0:u.substring(0,50))+"...")},Xe=()=>{U.value=Math.min(U.value*1.2,3)},ze=()=>{U.value=Math.max(U.value/1.2,.5)},me=()=>{U.value=1,se.value=0,re.value=0},Le=()=>{p.value={start:null,end:null,distance:null},ue.value=null,he("crossSectionChange",null)},ke=(g,u)=>{if(!oe.value)return null;const t=oe.value.getBoundingClientRect(),e=t.width/2,a=t.height/2,n=(g-e-se.value)/U.value+e,c=(u-a-re.value)/U.value+a,o=(t.width-ie.value)/2,s=(t.height-K.value)/2;return{x:n-o,y:c-s}},pe=(g,u)=>{if(!ge.value)return null;const t=ie.value,e=K.value,a=t*.1,n=t*(1-.1-.85),c=e*.1,o=e*(1-.1-.8),s=t-a-n,i=e-c-o,r=ge.value,d=r.minX+(g-a)/s*r.rangeX,x=r.minY+(e-u-c)/i*r.rangeY;return{x:d,y:x}},He=g=>{if(w.crossSectionMode){const u=ke(g.clientX,g.clientY);if(!u)return;if(!p.value.start)p.value.start=u,L.value=!0;else if(p.value.end)p.value={start:u,end:null,distance:null},L.value=!0;else{p.value.end=u,L.value=!1;const t=pe(u.x,u.y),e=pe(p.value.start.x,p.value.start.y);if(t&&e){const a=Math.sqrt(ee(e.x-t.x,2)+ee(e.y-t.y,2));p.value.distance=a}ue.value=null,he("crossSectionComplete",{start:pe(p.value.start.x,p.value.start.y),end:pe(p.value.end.x,p.value.end.y),startCanvas:p.value.start,endCanvas:p.value.end,distance:p.value.distance})}he("crossSectionChange",p.value)}else de.value=!0,Z.value={x:g.clientX-se.value,y:g.clientY-re.value}},_e=()=>{de.value=!1},Ue=g=>{if(!oe.value)return;const u=oe.value.getBoundingClientRect();if(g.clientX-u.left,g.clientY-u.top,w.crossSectionMode&&L.value){const t=ke(g.clientX,g.clientY);t&&(ue.value=t),ne.value={x:g.clientX,y:g.clientY};return}if(de.value){se.value=g.clientX-Z.value.x,re.value=g.clientY-Z.value.y;return}ne.value={x:g.clientX,y:g.clientY}},Ne=g=>{g.preventDefault();const u=g.deltaY>0?.9:1.1;U.value=Math.max(.5,Math.min(3,U.value*u))};return ot(()=>{}),ct(()=>w.imageUrl,g=>{me(),V.value=!1,$.value=null,console.log("ImageUrl changed:",g?g.substring(0,50)+"...":"null")}),j({resetView:me,resetCrossSection:Le,boreholes:Me,crossSectionLine:p}),(g,u)=>{var t,e,a,n,c,o;return M(),P("div",{class:qe(["contour-map-wrapper",{"cross-section-mode":X.crossSectionMode}])},[l("div",{ref_key:"imageContainer",ref:oe,class:"image-container",onMousedown:He,onMousemove:Ue,onMouseup:_e,onMouseleave:_e,onWheel:dt(Ne,["prevent"])},[$.value?(M(),P("div",pt,[u[2]||(u[2]=l("p",null,"âš ï¸ å›¾ç‰‡åŠ è½½å¤±è´¥",-1)),l("p",yt,k($.value),1),u[3]||(u[3]=l("p",{class:"error-hint"},"è¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ",-1))])):X.imageUrl?(M(),P("img",{key:2,src:X.imageUrl,class:"contour-image",style:we(Ce.value),alt:"Contour Map",onLoad:Ae,onError:Ye},null,44,bt)):(M(),P("div",xt,[...u[4]||(u[4]=[l("div",{class:"spinner"},null,-1),l("p",null,"æ­£åœ¨ç”Ÿæˆç­‰å€¼çº¿å›¾...",-1)])]))],544),X.imageUrl?(M(),P("svg",{key:0,class:"borehole-overlay",viewBox:`0 0 ${ie.value} ${K.value}`,style:we(be.value),preserveAspectRatio:"xMidYMid meet"},[u[6]||(u[6]=l("defs",null,[l("filter",{id:"shadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},[l("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2","flood-opacity":"0.3"})]),l("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto"},[l("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#f59e0b"})])],-1)),p.value.start&&p.value.end?(M(),P("g",_t,[l("line",{x1:p.value.start.x,y1:p.value.start.y,x2:p.value.end.x,y2:p.value.end.y,stroke:"#f59e0b","stroke-width":"3","stroke-dasharray":"8,4","marker-end":"url(#arrowhead)",class:"cross-section-line"},null,8,St),l("circle",{cx:p.value.start.x,cy:p.value.start.y,r:"8",fill:"#f59e0b",stroke:"white","stroke-width":"2",class:"cross-section-marker"},null,8,wt),l("text",{x:p.value.start.x,y:p.value.start.y-15,fill:"#f59e0b","font-size":"14","font-weight":"bold","text-anchor":"middle"},"A",8,Mt),l("circle",{cx:p.value.end.x,cy:p.value.end.y,r:"8",fill:"#f59e0b",stroke:"white","stroke-width":"2",class:"cross-section-marker"},null,8,Tt),l("text",{x:p.value.end.x,y:p.value.end.y-15,fill:"#f59e0b","font-size":"14","font-weight":"bold","text-anchor":"middle"},"A'",8,Ct),l("text",{x:(p.value.start.x+p.value.end.x)/2,y:(p.value.start.y+p.value.end.y)/2-15,fill:"white","font-size":"12","text-anchor":"middle",class:"distance-label"},k((t=p.value.distance)==null?void 0:t.toFixed(0))+"m",9,Ft)])):J("",!0),X.crossSectionMode&&p.value.start&&ue.value?(M(),P("line",{key:1,x1:p.value.start.x,y1:p.value.start.y,x2:ue.value.x,y2:ue.value.y,stroke:"rgba(245, 158, 11, 0.5)","stroke-width":"2","stroke-dasharray":"4,4"},null,8,At)):J("",!0),ve.value?(M(!0),P(Re,{key:2},De(Me.value,(s,i)=>(M(),P("g",{key:i,transform:`translate(${s.canvasX}, ${s.canvasY})`,class:"borehole-marker",onMouseenter:r=>Q.value=Be(Pe({},s),{isBorehole:!0}),onMouseleave:u[0]||(u[0]=r=>Q.value=null)},[u[5]||(u[5]=l("circle",{r:"9",fill:"rgba(255,255,255,0.95)",filter:"url(#shadow)"},null,-1)),l("circle",{r:"6",fill:s.color||"#3b82f6",stroke:"#1e3a8a","stroke-width":"1.5"},null,8,Bt)],40,Pt))),128)):J("",!0)],12,kt)):J("",!0),l("div",$t,[l("button",{class:"control-btn",onClick:Xe,title:"æ”¾å¤§"},[...u[7]||(u[7]=[l("span",null,"+",-1)])]),l("button",{class:"control-btn",onClick:ze,title:"ç¼©å°"},[...u[8]||(u[8]=[l("span",null,"âˆ’",-1)])]),l("button",{class:"control-btn",onClick:me,title:"é‡ç½®"},[...u[9]||(u[9]=[l("span",null,"âŸ²",-1)])]),l("button",{class:qe(["control-btn",{active:ve.value}]),onClick:u[1]||(u[1]=s=>ve.value=!ve.value),title:"é’»å­”ç‚¹"},[...u[10]||(u[10]=[l("span",null,"ğŸ“",-1)])],2)]),X.valueRange?(M(),P("div",Wt,[l("div",Rt,k(X.propertyLabel),1),l("div",Dt,[l("span",Et,k((e=X.valueRange.min)==null?void 0:e.toFixed(2))+"m",1),l("div",It,[l("div",{class:"legend-gradient",style:we(Ie.value)},null,4)]),l("span",Yt,k((a=X.valueRange.max)==null?void 0:a.toFixed(2))+"m",1)])])):J("",!0),Q.value?(M(),P("div",{key:2,class:"hover-tooltip",style:we(Fe.value)},[Q.value.isBorehole?(M(),P("div",Xt,[l("div",zt,k(Q.value.name||Q.value.borehole),1),l("div",Lt,"("+k((n=Q.value.x)==null?void 0:n.toFixed(1))+", "+k((c=Q.value.y)==null?void 0:c.toFixed(1))+")",1),l("div",Ht,[l("span",Ut,k(X.propertyLabel)+":",1),l("span",Nt,k((o=Q.value.value)==null?void 0:o.toFixed(2))+" m",1)])])):J("",!0)],4)):J("",!0)],2)}}},tt=lt(Vt,[["__scopeId","data-v-444e152a"]]),Ot={class:"page"},qt={class:"header"},jt={class:"muted"},Kt={key:0,class:"header-stats"},Gt={class:"stat-badge"},Jt={class:"stat-badge primary"},Zt={class:"stat-badge"},Qt={key:0,class:"card"},eo={class:"seam-selection-grid"},to=["onClick"],oo={class:"seam-card-header"},lo={class:"seam-name"},so={class:"seam-count"},no={class:"seam-card-stats"},ao={class:"mini-stat"},io={class:"mini-stat-value"},ro={class:"mini-stat"},co={class:"mini-stat-value"},uo={key:1,class:"grid"},ho={class:"card params-card compact-card"},vo={class:"param-row"},fo={class:"tab-buttons"},go=["onClick"],mo={class:"param-row"},po={class:"param-header"},yo={class:"param-value"},xo={class:"param-row"},bo={class:"param-header"},ko={class:"param-value"},_o={key:0,class:"param-row"},So={class:"toggle-btn",style:{width:"100%"}},wo={key:0,class:"hint-text"},Mo={class:"action-buttons"},To=["disabled"],Co={key:0,class:"spinner sm"},Fo={class:"card compact-card"},Ao={key:0,class:"histogram-wrapper"},Po={key:1,class:"empty-state"},Bo={key:2,class:"stats-grid"},$o={class:"stat-item"},Wo={class:"stat-value"},Ro={class:"stat-item"},Do={class:"stat-value"},Eo={class:"stat-item"},Io={class:"stat-value"},Yo={class:"stat-item"},Xo={class:"stat-value"},zo={class:"stat-item"},Lo={class:"stat-value"},Ho={class:"stat-item"},Uo={class:"stat-value"},No={class:"card compact-card"},Vo={class:"stratigraphic-wrapper"},Oo={class:"lithology-legend-compact"},qo={class:"legend-name"},jo={key:0,class:"map-row"},Ko={key:0,class:"card map-card-large"},Go={class:"map-header"},Jo={class:"section-desc"},Zo={class:"map-wrapper"},Qo={key:1,class:"empty-state"},el={key:1,class:"card map-card-large"},tl={class:"map-header"},ol={class:"section-desc"},ll={class:"map-wrapper"},sl={key:1,class:"empty-state"},nl={key:1,class:"card map-card-full"},al={class:"map-wrapper uncertainty-wrapper"},il={key:2,class:"card map-card-full"},rl={class:"map-header"},cl={class:"section-title"},dl={class:"section-badge"},ul={class:"cross-section-wrapper"},hl={__name:"Interpolation",setup(X,{expose:j}){const H=ht(),w=T(!1),he=T(null),oe=T(!1),ie=T([]),K=T(null),V=T(null),$=T([]),U=T([]),se=T("kriging"),re=T(80),de=T(10),L=T(null),Z=T(null),Q=T(!1),ne=T({line:null,points:[],depthProfile:[],distance:null,hasData:!1}),ve=T(null),p=T(null),ue=T(null),ge=T(null),Me=[{key:"kriging",label:"Kriging"},{key:"idw",label:"IDW"},{key:"linear",label:"Linear"},{key:"nearest",label:"Nearest"}],Ee={ç»†ç ‚å²©:"#FCEBB6",ç²‰ç ‚å²©:"#E0FFFF",æ³¥å²©:"#D3D3D3",ä¸­ç ‚å²©:"#FCEBB6",ç²—ç ‚å²©:"#F5DEB3",ç ¾å²©:"#DEB887",ç‚­è´¨æ³¥å²©:"#8B8B8B",ç ‚è´¨æ³¥å²©:"#D8D8D8",æ³¥è´¨ç ‚å²©:"#E8E8E8",çŸ³ç°å²©:"#B0E0E6",ç…¤:"#2F4F4F"},Te={ç»†ç ‚å²©:{facecolor:"#FCEBB6",hatch:"...",edgecolor:"#999999"},ç²‰ç ‚å²©:{facecolor:"#E0FFFF",hatch:"...",edgecolor:"#AAAAAA"},æ³¥å²©:{facecolor:"#D3D3D3",hatch:"---",edgecolor:"#666666"},ä¸­ç ‚å²©:{facecolor:"#FCEBB6",hatch:"...",edgecolor:"#999999"},ç²—ç ‚å²©:{facecolor:"#F5DEB3",hatch:"...",edgecolor:"#999999"},ç ¾å²©:{facecolor:"#DEB887",hatch:"ooo",edgecolor:"#8B4513"},ç‚­è´¨æ³¥å²©:{facecolor:"#8B8B8B",hatch:"---",edgecolor:"#444444"},ç ‚è´¨æ³¥å²©:{facecolor:"#D8D8D8",hatch:"-..",edgecolor:"#777777"},æ³¥è´¨ç ‚å²©:{facecolor:"#E8E8E8",hatch:".-.",edgecolor:"#888888"},çŸ³ç°å²©:{facecolor:"#B0E0E6",hatch:"+++",edgecolor:"#5F9EA0"},ç…¤:{facecolor:"#2F4F4F",hatch:"",edgecolor:"#1a1a1a"}},Ce=t=>({kriging:"Kriging",idw:"IDW",linear:"Linear",nearest:"Nearest"})[t]||t,be=()=>{const t=$.value.map(e=>e.thickness).filter(e=>e!=null);return t.length===0?0:t.reduce((e,a)=>e+a,0)/t.length},Fe=()=>{const t=$.value.map(n=>n.thickness).filter(n=>n!=null);if(t.length===0)return 0;const e=be(),a=t.reduce((n,c)=>n+ee(c-e,2),0)/t.length;return Math.sqrt(a)},Ie=()=>{const t=be();return t===0?0:Fe()/t*100},Ae=()=>{const t=$.value.map(e=>e.thickness).filter(e=>e!=null);return t.length===0?{min:0,max:0}:{min:Math.min(...t),max:Math.max(...t)}},Ye=()=>$e(this,null,function*(){w.value=!0;try{const{data:t}=yield vt();ie.value=t.seams||[]}catch(t){he.value="åŠ è½½ç…¤å±‚å¤±è´¥"}finally{w.value=!1}}),Xe=(t=[])=>{let e=0;return t.map(a=>{var s,i;const n=Number((s=a.thickness)!=null?s:0)||0;let c=Number(a.z_top),o=Number(a.z_bottom);if(Number.isFinite(c)||(c=e),Number.isFinite(o)||(o=c+n),!Number.isFinite(n)||n===0){const r=Math.max((o||0)-(c||0),0);r>0&&(a.thickness=r)}return e=o,Be(Pe({},a),{thickness:Number((i=a.thickness)!=null?i:n)||0,z_top:c,z_bottom:o})})},ze=t=>$e(this,null,function*(){var e,a,n;K.value=t,L.value=null,Z.value=null;try{const{data:c}=yield gt(t.name);V.value=c,$.value=c.points||[];try{const o=yield mt(t.name),s=((e=o==null?void 0:o.data)==null?void 0:e.boreholes)||[],i=s.reduce((d,x)=>{var _,A;const I=((_=d==null?void 0:d.layers)==null?void 0:_.length)||0;return(((A=x==null?void 0:x.layers)==null?void 0:A.length)||0)>I?x:d},s[0]),r=Xe((i==null?void 0:i.layers)||[]);U.value=r.sort((d,x)=>(d.z_top||0)-(x.z_top||0))}catch(o){U.value=[]}yield me(),yield et(),ke(),pe()}catch(c){H.add("åŠ è½½ç…¤å±‚è¯¦æƒ…å¤±è´¥: "+(((n=(a=c.response)==null?void 0:a.data)==null?void 0:n.detail)||c.message),"error")}}),me=()=>$e(this,null,function*(){var t,e,a,n,c,o,s,i,r,d,x,I,R,_,A;if(K.value){oe.value=!0;try{const{data:h}=yield ft(K.value.name,se.value,re.value,de.value);console.log("å®Œæ•´APIå“åº”:",h),console.log("data.thickness:",h.thickness),console.log("data.depth:",h.depth),h.thickness&&(console.log("thicknesså¯¹è±¡çš„keys:",Object.keys(h.thickness)),console.log("thickness.imageå­˜åœ¨å—?","image"in h.thickness),console.log("thicknessæ‰€æœ‰å±æ€§:",JSON.stringify(h.thickness,null,2))),h.depth&&(console.log("depthå¯¹è±¡çš„keys:",Object.keys(h.depth)),console.log("depth.imageå­˜åœ¨å—?","image"in h.depth)),console.log("API Response:",{hasThicknessImage:!!((t=h.thickness)!=null&&t.image),hasDepthImage:!!((e=h.depth)!=null&&e.image),thicknessImageLength:(n=(a=h.thickness)==null?void 0:a.image)==null?void 0:n.length,depthImageLength:(o=(c=h.depth)==null?void 0:c.image)==null?void 0:o.length,thicknessImagePrefix:(i=(s=h.thickness)==null?void 0:s.image)==null?void 0:i.substring(0,50),depthImagePrefix:(d=(r=h.depth)==null?void 0:r.image)==null?void 0:d.substring(0,50)}),$.value=h.boreholes||[],(x=h.thickness)!=null&&x.image?(L.value={imageUrl:`data:image/png;base64,${h.thickness.image}`,valueRange:h.thickness.value_range,bounds:h.bounds},console.log("Thickness imageUrl created:",L.value.imageUrl.substring(0,50)+"...")):console.error("âŒ åšåº¦å›¾ç‰‡æ•°æ®ç¼ºå¤±!"),(I=h.depth)!=null&&I.image?(Z.value={imageUrl:`data:image/png;base64,${h.depth.image}`,valueRange:h.depth.value_range,bounds:h.bounds},console.log("Depth imageUrl created:",Z.value.imageUrl.substring(0,50)+"...")):console.error("âŒ æ·±åº¦å›¾ç‰‡æ•°æ®ç¼ºå¤±!"),yield et(),Le(),ke(),console.log("âœ“ All chartsç»˜åˆ¶å®Œæˆ"),H.add("ç­‰å€¼çº¿å›¾ç”Ÿæˆå®Œæˆ","success")}catch(h){console.error("Interpolate error:",h),console.error("Error response:",(R=h.response)==null?void 0:R.data),H.add(((A=(_=h.response)==null?void 0:_.data)==null?void 0:A.detail)||"ç”Ÿæˆç­‰å€¼çº¿å›¾å¤±è´¥","error")}finally{oe.value=!1}}}),Le=()=>{if(console.log("calculateUncertainty called"),console.log("seamPoints.value.length:",$.value.length),console.log("thicknessResult.value:",L.value),!$.value.length||!L.value){console.log("âŒ Missing data for uncertainty map");return}const t=ge.value;if(console.log("uncertaintyCanvas.value:",t),!t){console.log("âŒ uncertaintyCanvas not found");return}console.log("âœ“ Starting uncertainty map calculation...");const e=t.getContext("2d"),a=t.width=900,n=t.height=550;console.log("Canvas size:",a,"x",n);const c=L.value.bounds,o=$.value.map(S=>({x:S.x,y:S.y}));console.log("Bounds:",c),console.log("Points count:",o.length),e.fillStyle="#ffffff",e.fillRect(0,0,a,n);const s={left:20,right:35,top:20,bottom:60},i=a-s.left-s.right-50,r=n-s.top-s.bottom,d=150,x=[],I=500;for(let S=0;S<d;S++){x[S]=[];for(let E=0;E<d;E++){const W=c.min_x+E/d*(c.max_x-c.min_x),ce=c.max_y-S/d*(c.max_y-c.min_y);let ae=1/0;for(const fe of o){const ye=Math.sqrt(ee(W-fe.x,2)+ee(ce-fe.y,2));ye<ae&&(ae=ye)}x[S][E]=Math.min(1.6,ae/I*1.6)}}const R=[],_=3;for(let S=0;S<d;S++){R[S]=[];for(let E=0;E<d;E++){let W=0,ce=0;for(let ae=-_;ae<=_;ae++)for(let fe=-_;fe<=_;fe++){const ye=S+ae,Ve=E+fe;if(ye>=0&&ye<d&&Ve>=0&&Ve<d){const je=Math.sqrt(fe*fe+ae*ae),Ke=Math.exp(-(je*je)/(2*_*_));W+=x[ye][Ve]*Ke,ce+=Ke}}R[S][E]=W/ce}}const A=S=>{const E=Math.min(1.5,Math.max(0,S))/1.5;if(E<.5){const W=E*2;return{r:Math.floor(49+206*W),g:Math.floor(130+125*W),b:Math.floor(189+-189*W)}}else{const W=(E-.5)*2;return{r:Math.floor(255+-40*W),g:Math.floor(255+-207*W),b:Math.floor(0+48*W)}}},h=i/d,te=r/d;for(let S=0;S<d;S++)for(let E=0;E<d;E++){const W=R[S][E],ce=A(W);e.fillStyle=`rgb(${ce.r}, ${ce.g}, ${ce.b})`,e.fillRect(s.left+E*h,s.top+(d-1-S)*te,h+1,te+1)}const N=6;for(const S of o){const E=s.left+(S.x-c.min_x)/(c.max_x-c.min_x)*i,W=s.top+(c.max_y-S.y)/(c.max_y-c.min_y)*r;e.beginPath(),e.arc(E,W,N,0,Math.PI*2),e.fillStyle="#000000",e.fill()}e.strokeStyle="#000000",e.lineWidth=2,e.strokeRect(s.left,s.top,i,r);const D=s.left+20,z=s.top+r-80,O=120,y=50;e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=1.5,e.fillRect(D,z,O,y),e.strokeRect(D,z,O,y),e.fillStyle="#d73027",e.fillRect(D+10,z+28,15,15),e.strokeStyle="#000000",e.lineWidth=1,e.strokeRect(D+10,z+28,15,15),e.fillStyle="#000000",e.font="12px Arial, sans-serif",e.textAlign="left",e.fillText("é«˜ä¸ç¡®å®šæ€§",D+32,z+40),e.beginPath(),e.arc(D+17,z+18,N,0,Math.PI*2),e.fillStyle="#000000",e.fill(),e.fillText("é’»å­”ä½ç½®",D+32,z+22);const Y=s.left+i-150,B=z,q=130,f=35;e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=1.5,e.fillRect(Y,B,q,f),e.strokeRect(Y,B,q,f),e.fillStyle="#000000",e.font="12px Arial, sans-serif",e.textAlign="left",e.fillText("0",Y+10,B+22),e.textAlign="center",e.fillText("500",Y+75,B+22),e.textAlign="right",e.fillText("1000 ç±³",Y+120,B+22);const v=B+12;e.strokeStyle="#000000",e.lineWidth=2,e.beginPath(),e.moveTo(Y+10,v),e.lineTo(Y+120,v),e.stroke(),e.lineWidth=4,e.beginPath(),e.moveTo(Y+10,v),e.lineTo(Y+75,v),e.stroke();const b=s.left+i+20,C=s.top,G=20,m=r;for(let S=0;S<m;S++){const E=(1-S/m)*1.5,W=A(E);e.fillStyle=`rgb(${W.r}, ${W.g}, ${W.b})`,e.fillRect(b,C+S,G,1)}e.strokeStyle="#000000",e.lineWidth=1.5,e.strokeRect(b,C,G,m),e.fillStyle="#000000",e.font="11px Arial, sans-serif",e.textAlign="left";const F=[0,.5,1,1.5],le=["0","0.5","1.0","1.5+"];F.forEach((S,E)=>{const W=C+m-S/1.5*m;e.beginPath(),e.moveTo(b+G,W),e.lineTo(b+G+4,W),e.strokeStyle="#000000",e.lineWidth=1,e.stroke(),e.fillText(le[E],b+G+8,W+4)}),e.save(),e.translate(b+G+35,C+m/2),e.rotate(-Math.PI/2),e.textAlign="center",e.font="12px Arial, sans-serif",e.fillText("æ–¹å·® (å½’ä¸€åŒ–)",0,0),e.restore(),e.fillStyle="#000000",e.font="bold 14px Arial, sans-serif",e.textAlign="center",e.fillText("æ’å€¼ä¸ç¡®å®šæ€§åˆ†å¸ƒå›¾",s.left+i/2,n-28),e.font="11px Arial, sans-serif",e.fillText("çº¢è‰²åŒºåŸŸè¡¨ç¤ºè¾ƒé«˜çš„ä¸ç¡®å®šæ€§ï¼›è“è‰²åŒºåŸŸæ›´åŠ å¯é ã€‚",s.left+i/2,n-12),console.log("âœ“ Uncertainty mapç»˜åˆ¶å®Œæˆ")},ke=()=>{console.log("drawHistogram called"),console.log("histogramCanvas.value:",ve.value),console.log("seamPoints.value.length:",$.value.length);const t=ve.value;if(!t){console.log("âŒ histogramCanvas not found");return}if($.value.length===0){console.log("âŒ No seam points data");return}console.log("âœ“ Starting histogram drawing...");const e=t.getContext("2d"),a=window.devicePixelRatio||1,n=t.parentElement,c=(n==null?void 0:n.clientWidth)||t.clientWidth||500,o=(n==null?void 0:n.clientHeight)||t.clientHeight||350;t.width=Math.round(c*a),t.height=Math.round(o*a),t.style.width=`${c}px`,t.style.height=`${o}px`,e.setTransform(a,0,0,a,0,0);const s=c,i=o,r=$.value.map(m=>m.thickness).filter(m=>m!=null);if(r.length===0)return;const d=Math.min(...r),x=Math.max(...r),I=r.reduce((m,F)=>m+F,0)/r.length,R=r.reduce((m,F)=>m+ee(F-I,2),0)/r.length,_=Math.sqrt(R),A=20,h=(x-d)/A,te=Array(A).fill(0);for(const m of r){const F=Math.min(Math.floor((m-d)/h),A-1);te[F]++}const N=Math.max(...te),D="#5D8AA8",z="#C8523C",O=.85;e.fillStyle="#ffffff",e.fillRect(0,0,s,i);const y={left:50,right:25,top:45,bottom:45},Y=s-y.left-y.right,B=i-y.top-y.bottom,q=Y/A,f=B/(N*1.1);e.fillStyle=D,e.globalAlpha=O;for(let m=0;m<A;m++){const F=te[m]*f,le=y.left+m*q,S=i-y.bottom-F;F>0&&(e.fillRect(le,S,q-1,F),e.strokeStyle="white",e.lineWidth=.8,e.strokeRect(le,S,q-1,F))}e.globalAlpha=1,e.strokeStyle=z,e.lineWidth=2,e.beginPath();for(let m=0;m<=100;m++){const F=y.left+m/100*Y,le=d+m/100*(x-d),E=1/(_*Math.sqrt(2*Math.PI))*Math.exp(-.5*ee((le-I)/_,2))*r.length*h,W=i-y.bottom-E*f;m===0?e.moveTo(F,W):e.lineTo(F,W)}e.stroke(),e.strokeStyle="#000000",e.lineWidth=1,e.beginPath(),e.moveTo(y.left,y.top),e.lineTo(y.left,i-y.bottom),e.stroke(),e.beginPath(),e.moveTo(y.left,i-y.bottom),e.lineTo(s-y.right,i-y.bottom),e.stroke();const v=4;e.strokeStyle="#000000",e.lineWidth=1;for(let m=0;m<=6;m++){const F=y.left+m/6*Y;e.beginPath(),e.moveTo(F,i-y.bottom),e.lineTo(F,i-y.bottom+v),e.stroke()}for(let m=0;m<=5;m++){const F=i-y.bottom-m/5*B;e.beginPath(),e.moveTo(y.left,F),e.lineTo(y.left-v,F),e.stroke()}e.fillStyle="#000000",e.font="10px Arial, sans-serif",e.textAlign="center";for(let m=0;m<=6;m++){const F=d+m/6*(x-d),le=y.left+m/6*Y;e.fillText(F.toFixed(1),le,i-y.bottom+15)}e.textAlign="right";for(let m=0;m<=5;m++){const F=Math.round(m/5*(N*1.1)),le=i-y.bottom-m/5*B;e.fillText(F.toString(),y.left-6,le+3)}e.fillStyle="#000000",e.font="11px Arial, sans-serif",e.textAlign="center",e.fillText("åšåº¦ (m)",y.left+Y/2,i-8),e.save(),e.translate(12,y.top+B/2),e.rotate(-Math.PI/2),e.fillText("é¢‘æ•°",0,0),e.restore(),e.fillStyle="#000000",e.font="bold 12px Arial, sans-serif",e.textAlign="left",e.fillText("Figure 1 | é’»å­”åšåº¦åˆ†å¸ƒ (n="+r.length+")",y.left,18),e.fillStyle="#000000",e.font="10px Arial, sans-serif",e.textAlign="left";const b=s-y.right-120,C=y.top+10;e.fillStyle=D,e.globalAlpha=O,e.fillRect(b,C-4,12,10),e.globalAlpha=1,e.strokeStyle="white",e.lineWidth=.8,e.strokeRect(b,C-4,12,10),e.fillText("è§‚æµ‹å€¼",b+16,C+4),e.strokeStyle=z,e.lineWidth=2,e.beginPath(),e.moveTo(b,C+20),e.lineTo(b+12,C+20),e.stroke(),e.fillStyle="#000000",e.fillText("å¯†åº¦æ‹Ÿåˆ",b+16,C+24),e.fillStyle="#666666",e.font="9px Arial, sans-serif",e.textAlign="left";const G=`Î¼=${I.toFixed(2)}  Ïƒ=${_.toFixed(2)}`;e.fillText(G,b,C+42),console.log("âœ“ Histogramç»˜åˆ¶å®Œæˆ")},pe=()=>{const t=ue.value;if(!t||U.value.length===0)return;const e=t.getContext("2d"),a=window.devicePixelRatio||1,n=t.parentElement,c=(n==null?void 0:n.clientWidth)||t.clientWidth||280,o=(n==null?void 0:n.clientHeight)||t.clientHeight||500;t.width=Math.round(c*a),t.height=Math.round(o*a),t.style.width=`${c}px`,t.style.height=`${o}px`,e.setTransform(a,0,0,a,0,0);const s=c,i=o;e.fillStyle="#FFFFFF",e.fillRect(0,0,s,i);const r=U.value;let d=Math.max(...r.map(B=>B.z_bottom||0));if((!Number.isFinite(d)||d<=0)&&(d=r.reduce((B,q)=>B+(Number(q.thickness)||0),0)),!Number.isFinite(d)||d<=0)return;const x={top:24,bottom:22},I=(i-x.top-x.bottom)/d,R=x.top,_=14,A=Math.max(110,Math.min(160,s*.3)),h=Math.max(80,Math.min(140,s*.22)),te=_+h+16+A,D=Math.max(16,(s-te)/2),z=D+_,O=z+h+16;e.fillStyle="#0F172A",e.font="bold 12px Arial, sans-serif",e.textAlign="left",e.fillText("åœ°å±‚æŸ±çŠ¶å›¾",z,18);const y=4,Y=Math.max(5,Math.ceil(d/6/5)*5)||10;e.strokeStyle="#E2E8F0",e.lineWidth=1,e.fillStyle="#64748B",e.font="10px Arial, sans-serif",e.textAlign="right",e.beginPath(),e.moveTo(D,R),e.lineTo(D,i-x.bottom),e.stroke();for(let B=0;B<=d;B+=Y){const q=R+B*I;e.beginPath(),e.moveTo(D,q),e.lineTo(D+y,q),e.stroke(),e.fillText(`${Math.round(B)} m`,D-6,q+3)}e.save(),e.translate(D-28,R+(i-x.bottom-R)/2),e.rotate(-Math.PI/2),e.textAlign="center",e.fillStyle="#64748B",e.font="11px Arial, sans-serif",e.fillText("æ·±åº¦",0,0),e.restore(),r.forEach((B,q)=>{const f=R+(B.z_top||0)*I,v=B.thickness||0,b=Math.max(v*I,3),C=Te[B.name]||{facecolor:"#D3D3D3",hatch:"---",edgecolor:"#666666"};e.fillStyle=C.facecolor,e.fillRect(z,f,h,b),b>6&&C.hatch&&He(e,C.hatch,z,f,h,b,C.edgecolor),e.strokeStyle="#1a1a1a",e.lineWidth=.5,e.strokeRect(z,f,h,b),b>10&&(e.fillStyle="#475569",e.font="10px Arial, sans-serif",e.textAlign="left",e.fillText(B.name,O,f+b/2+3),e.fillStyle="#2563EB",e.font="9px SF Mono, monospace",e.fillText(`${v.toFixed(1)}ç±³`,O,f+b/2+14))}),e.strokeStyle="#94A3B8",e.lineWidth=1,e.strokeRect(z,R,h,i-R-x.bottom)},He=(t,e,a,n,c,o,s)=>{t.save(),t.beginPath(),t.rect(a,n,c,o),t.clip(),t.strokeStyle=s,t.globalAlpha=.4,t.lineWidth=.5;const i=6;switch(e){case"...":case"ooo":t.fillStyle=s,t.globalAlpha=.3;for(let r=i/2;r<c;r+=i)for(let d=i/2;d<o;d+=i)t.beginPath(),e==="ooo"?t.arc(a+r,n+d,2.5,0,Math.PI*2):t.arc(a+r,n+d,1,0,Math.PI*2),t.fill();break;case"---":t.globalAlpha=.5;for(let r=4;r<o;r+=i)t.beginPath(),t.moveTo(a,n+r),t.lineTo(a+c,n+r),t.stroke();break;case"+++":case"xx":t.globalAlpha=.3;for(let r=i/2;r<c;r+=i)for(let d=i/2;d<o;d+=i)t.beginPath(),t.moveTo(a+r-3,n+d),t.lineTo(a+r+3,n+d),t.stroke(),t.beginPath(),t.moveTo(a+r,n+d-3),t.lineTo(a+r,n+d+3),t.stroke();break;case"-..":case".-.":t.globalAlpha=.5;for(let r=i;r<o;r+=i*1.5)t.beginPath(),t.moveTo(a,n+r),t.lineTo(a+c/2,n+r),t.stroke(),t.fillStyle=s,t.beginPath(),t.arc(a+c*.75,n+r,1.5,0,Math.PI*2),t.fill();break;case"//":case"\\\\":t.globalAlpha=.4;for(let r=-o;r<c;r+=i)t.beginPath(),t.moveTo(a+r,n),t.lineTo(a+r+o,n+o),t.stroke();break}t.restore()},_e=t=>{ne.value={line:{start:t.startCanvas,end:t.endCanvas},worldLine:{start:t.start,end:t.end},points:t.points||[],depthProfile:[],distance:t.distance,hasData:!0},Ue(t.start,t.end,t.distance)},Ue=(t,e,a)=>{if(!$.value.length||a===null)return;const n=p.value;if(!n)return;n.getContext("2d");const c=n.width=n.offsetWidth||900,o=n.height=300,s=100,i=(e.x-t.x)/s,r=(e.y-t.y)/s,d=[];for(let x=0;x<=s;x++){const I=t.x+i*x,R=t.y+r*x,_=$.value.map(A=>{const h=Math.sqrt(ee(I-A.x,2)+ee(R-A.y,2));return{depth:A.burial_depth,distance:h}}).filter(A=>A.depth!=null&&A.distance<500);if(_.length>0){let A=0,h=0;for(const te of _){const N=1/ee(te.distance+1,2);h+=te.depth*N,A+=N}d.push({distance:x/s*a,depth:h/A})}}ne.value.depthProfile=d,Ne(d,a,c,o)},Ne=(t,e,a,n)=>{var B,q;const c=p.value;if(!c)return;const o=c.getContext("2d");o.fillStyle="#FFFFFF",o.fillRect(0,0,a,n);const s={left:50,right:30,top:35,bottom:40},i=a-s.left-s.right,r=n-s.top-s.bottom,d=t.map(f=>f.depth),x=Math.min(...d),I=Math.max(...d),R=I-x||1,_={topSoil:"#8FBC8F",sandstone:"#F4A460",shale:"#778899",coal:"#2F2F2F",sandyShale:"#A9A9A9",limestone:"#B0C4DE"},h=r/6;[_.limestone,_.sandyShale,_.coal,_.shale,_.sandstone,_.topSoil].forEach((f,v)=>{const b=s.top+v*h;o.fillStyle=f,o.globalAlpha=.08,o.fillRect(s.left,b,i,h),o.globalAlpha=1}),o.strokeStyle="#E2E8F0",o.lineWidth=.8;const N=10;for(let f=0;f<=N;f++){const v=s.left+f/N*i;o.beginPath(),o.moveTo(v,s.top),o.lineTo(v,n-s.bottom),o.stroke()}const D=5;for(let f=0;f<=D;f++){const v=s.top+f/D*r;o.beginPath(),o.moveTo(s.left,v),o.lineTo(a-s.right,v),o.stroke()}o.strokeStyle="#94A3B8",o.lineWidth=1,o.beginPath(),o.moveTo(s.left,s.top),o.lineTo(s.left,n-s.bottom),o.stroke(),o.beginPath(),o.moveTo(s.left,n-s.bottom),o.lineTo(a-s.right,n-s.bottom),o.stroke();const z=4;o.strokeStyle="#CBD5E1",o.lineWidth=1;for(let f=0;f<=N;f++){const v=s.left+f/N*i;o.beginPath(),o.moveTo(v,n-s.bottom),o.lineTo(v,n-s.bottom+z),o.stroke()}for(let f=0;f<=D;f++){const v=n-s.bottom-f/D*r;o.beginPath(),o.moveTo(s.left,v),o.lineTo(s.left-z,v),o.stroke()}o.beginPath(),o.strokeStyle=_.sandstone,o.lineWidth=2.5,o.lineCap="round",o.lineJoin="round",t.forEach((f,v)=>{const b=s.left+f.distance/e*i,C=n-s.bottom-(f.depth-x)/R*r;v===0?o.moveTo(b,C):o.lineTo(b,C)}),o.stroke(),o.lineTo(s.left+i,n-s.bottom),o.lineTo(s.left,n-s.bottom),o.closePath(),o.fillStyle="rgba(244, 164, 96, 0.12)",o.fill();for(const f of $.value){if(f.burial_depth==null)continue;const v=f.x,b=f.y,C=((B=ne.value.worldLine)==null?void 0:B.start)||{x:0,y:0},G=((q=ne.value.worldLine)==null?void 0:q.end)||{x:0,y:0},m=Math.sqrt(ee(G.x-C.x,2)+ee(G.y-C.y,2));if(m===0)continue;const F=((v-C.x)*(G.x-C.x)+(b-C.y)*(G.y-C.y))/ee(m,2),le=C.x+F*(G.x-C.x),S=C.y+F*(G.y-C.y);if(Math.sqrt(ee(v-le,2)+ee(b-S,2))<50&&F>=0&&F<=1){const W=s.left+F*i,ce=n-s.bottom-(f.burial_depth-x)/R*r;o.beginPath(),o.arc(W,ce,4,0,Math.PI*2),o.fillStyle=_.coal,o.fill(),o.strokeStyle="#ffffff",o.lineWidth=1.5,o.stroke(),o.fillStyle="#64748B",o.font="10px Arial, sans-serif",o.textAlign="center";const ae=f.borehole||f.name||"";ae&&o.fillText(ae,W,ce-10)}}o.fillStyle="#64748B",o.font="11px Arial, sans-serif",o.textAlign="center";for(let f=0;f<=N;f++){const v=s.left+f/N*i,b=f/N*e;o.fillText(`${b.toFixed(0)}`,v,n-15)}o.textAlign="right";for(let f=0;f<=D;f++){const v=n-s.bottom-f/D*r,b=x+f/D*R;o.fillText(`${b.toFixed(0)}`,s.left-8,v+4)}o.fillStyle="#475569",o.font="12px Arial, sans-serif",o.textAlign="center",o.fillText("å‰–é¢è·ç¦» (ç±³)",s.left+i/2,n-5),o.save(),o.translate(12,s.top+r/2),o.rotate(-Math.PI/2),o.fillText("åŸ‹è—æ·±åº¦ (ç±³)",0,0),o.restore(),o.fillStyle="#0F172A",o.font="bold 13px Arial, sans-serif",o.textAlign="left",o.fillText(`å‰–é¢ A-A' | æ·±åº¦: ${x.toFixed(1)} - ${I.toFixed(1)} ç±³`,s.left,18);const O=a-s.right-80,y=n-s.bottom+12,Y=60;o.strokeStyle="#475569",o.lineWidth=2,o.beginPath(),o.moveTo(O,y),o.lineTo(O+Y,y),o.stroke(),o.beginPath(),o.moveTo(O,y-3),o.lineTo(O,y+3),o.stroke(),o.beginPath(),o.moveTo(O+Y,y-3),o.lineTo(O+Y,y+3),o.stroke(),o.fillStyle="#64748B",o.font="10px Arial, sans-serif",o.textAlign="center",o.fillText("æ¯”ä¾‹å°º: 60ç±³",O+Y/2,y+12)},g=()=>{Q.value=!1,ne.value={line:null,points:[],depthProfile:[],distance:null,hasData:!1},p.value&&p.value.getContext("2d").clearRect(0,0,p.value.width,p.value.height)};return ot(()=>{Ye()}),j({resetView:()=>{g()}}),(t,e)=>{var a,n,c,o,s,i,r,d,x,I,R,_,A,h,te,N,D,z,O,y,Y,B,q,f;return M(),P("div",Ot,[l("div",qt,[l("div",null,[e[4]||(e[4]=l("h2",null,"æ’å€¼åˆ†æ",-1)),l("div",jt,k(((a=K.value)==null?void 0:a.name)||"é€‰æ‹©ç…¤å±‚è¿›è¡Œç©ºé—´æ’å€¼åˆ†æ"),1)]),K.value&&V.value?(M(),P("div",Kt,[l("div",Gt,[e[5]||(e[5]=l("span",{class:"stat-label"},"åšåº¦èŒƒå›´",-1)),l("strong",null,k(((o=(c=(n=V.value)==null?void 0:n.thickness)==null?void 0:c.min)==null?void 0:o.toFixed(2))||"-")+" - "+k(((r=(i=(s=V.value)==null?void 0:s.thickness)==null?void 0:i.max)==null?void 0:r.toFixed(2))||"-")+" m",1)]),l("div",Jt,[e[6]||(e[6]=l("span",{class:"stat-label"},"å¹³å‡åšåº¦",-1)),l("strong",null,k(((I=(x=(d=V.value)==null?void 0:d.thickness)==null?void 0:x.mean)==null?void 0:I.toFixed(2))||"-")+" m",1)]),l("div",Zt,[e[7]||(e[7]=l("span",{class:"stat-label"},"é’»å­”æ•°é‡",-1)),l("strong",null,k(((R=V.value)==null?void 0:R.borehole_count)||$.value.length||"-"),1)])])):J("",!0)]),K.value?(M(),P("div",uo,[l("div",ho,[e[17]||(e[17]=Se('<h3 class="section-title" data-v-1d2ef65a><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1d2ef65a><circle cx="12" cy="12" r="3" data-v-1d2ef65a></circle><path d="M12 1v6m0 6v6" data-v-1d2ef65a></path><path d="m4.93 4.93 4.24 4.24m5.66 5.66 4.24 4.24" data-v-1d2ef65a></path><path d="m4.93 19.07 4.24-4.24m5.66-5.66 4.24-4.24" data-v-1d2ef65a></path></svg> æ’å€¼å‚æ•° </h3>',1)),l("div",vo,[e[11]||(e[11]=l("label",{class:"param-label"},"æ’å€¼æ–¹æ³•",-1)),l("div",fo,[(M(),P(Re,null,De(Me,v=>l("button",{key:v.key,class:qe(["tab-btn",{active:se.value===v.key}]),onClick:b=>se.value=v.key},k(v.label),11,go)),64))])]),l("div",mo,[l("div",po,[e[12]||(e[12]=l("label",{class:"param-label"},"ç½‘æ ¼å¯†åº¦",-1)),l("span",yo,k(re.value),1)]),Oe(l("input",{"onUpdate:modelValue":e[0]||(e[0]=v=>re.value=v),type:"range",min:"30",max:"150",step:"10",class:"slider"},null,512),[[Ze,re.value,void 0,{number:!0}]]),e[13]||(e[13]=l("div",{class:"slider-labels"},[l("span",null,"ç²—"),l("span",null,"ç»†")],-1))]),l("div",xo,[l("div",bo,[e[14]||(e[14]=l("label",{class:"param-label"},"ç­‰å€¼çº¿çº§åˆ«",-1)),l("span",ko,k(de.value),1)]),Oe(l("input",{"onUpdate:modelValue":e[1]||(e[1]=v=>de.value=v),type:"range",min:"5",max:"20",step:"1",class:"slider"},null,512),[[Ze,de.value,void 0,{number:!0}]]),e[15]||(e[15]=l("div",{class:"slider-labels"},[l("span",null,"å°‘"),l("span",null,"å¤š")],-1))]),L.value?(M(),P("div",_o,[l("label",So,[Oe(l("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=v=>Q.value=v)},null,512),[[ut,Q.value]]),e[16]||(e[16]=l("span",null,"ç»˜åˆ¶å‰–é¢çº¿",-1))]),Q.value?(M(),P("p",wo,"åœ¨åœ°å›¾ä¸Šç‚¹å‡»ä¸¤ç‚¹ç»˜åˆ¶å‰–é¢çº¿")):J("",!0)])):J("",!0),l("div",Mo,[l("button",{class:"btn primary",onClick:me,disabled:oe.value},[oe.value?(M(),P("span",Co)):J("",!0),We(" "+k(oe.value?"è®¡ç®—ä¸­...":"ç”Ÿæˆç­‰å€¼çº¿å›¾"),1)],8,To),l("button",{class:"btn outline",onClick:e[3]||(e[3]=v=>{K.value=null,L.value=null,Z.value=null})}," æ›´æ¢ç…¤å±‚ ")])]),l("div",Fo,[e[25]||(e[25]=Se('<h3 class="section-title" data-v-1d2ef65a><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1d2ef65a><line x1="18" y1="20" x2="18" y2="10" data-v-1d2ef65a></line><line x1="12" y1="20" x2="12" y2="4" data-v-1d2ef65a></line><line x1="6" y1="20" x2="6" y2="14" data-v-1d2ef65a></line></svg> æ•°æ®åˆ†å¸ƒ </h3>',1)),$.value.length>0?(M(),P("div",Ao,[l("canvas",{ref_key:"histogramCanvas",ref:ve,class:"histogram-canvas"},null,512)])):(M(),P("div",Po,[...e[18]||(e[18]=[l("p",null,"æš‚æ— æ•°æ®åˆ†å¸ƒ",-1)])])),$.value.length>0?(M(),P("div",Bo,[l("div",$o,[e[19]||(e[19]=l("span",{class:"stat-label"},"æ ·æœ¬æ•°",-1)),l("span",Wo,k($.value.length),1)]),l("div",Ro,[e[20]||(e[20]=l("span",{class:"stat-label"},"å‡å€¼",-1)),l("span",Do,k(be().toFixed(2))+"m",1)]),l("div",Eo,[e[21]||(e[21]=l("span",{class:"stat-label"},"æ ‡å‡†å·®",-1)),l("span",Io,k(Fe().toFixed(2))+"m",1)]),l("div",Yo,[e[22]||(e[22]=l("span",{class:"stat-label"},"å˜å¼‚ç³»æ•°",-1)),l("span",Xo,k(Ie().toFixed(2)),1)]),l("div",zo,[e[23]||(e[23]=l("span",{class:"stat-label"},"æœ€å°å€¼",-1)),l("span",Lo,k(Ae().min.toFixed(2))+"m",1)]),l("div",Ho,[e[24]||(e[24]=l("span",{class:"stat-label"},"æœ€å¤§å€¼",-1)),l("span",Uo,k(Ae().max.toFixed(2))+"m",1)])])):J("",!0)]),l("div",No,[e[26]||(e[26]=Se('<h3 class="section-title" data-v-1d2ef65a><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1d2ef65a><path d="M12 2L2 7l10 5 10-5-10-5z" data-v-1d2ef65a></path><path d="m2 17 10 5 10-5" data-v-1d2ef65a></path><path d="m2 12 10 5 10-5" data-v-1d2ef65a></path></svg> åœ°å±‚æŸ±çŠ¶å›¾ </h3>',1)),l("div",Vo,[l("canvas",{ref_key:"stratigraphicCanvas",ref:ue,class:"stratigraphic-canvas"},null,512)]),l("div",Oo,[(M(),P(Re,null,De(Ee,(v,b)=>l("div",{key:b,class:"legend-item-compact"},[l("div",{class:"legend-color",style:we({background:v})},null,4),l("span",qo,k(b),1)])),64))])]),L.value||Z.value?(M(),P("div",jo,[L.value?(M(),P("div",Ko,[l("div",Go,[l("div",null,[e[27]||(e[27]=l("h3",{class:"section-title"},[l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"})]),We(" ç…¤å±‚åšåº¦åˆ†å¸ƒ ")],-1)),l("p",Jo,k(Ce(se.value))+" Â· "+k((h=(A=(_=L.value)==null?void 0:_.valueRange)==null?void 0:A.min)==null?void 0:h.toFixed(1))+" - "+k((D=(N=(te=L.value)==null?void 0:te.valueRange)==null?void 0:N.max)==null?void 0:D.toFixed(1))+" m",1)])]),l("div",Zo,[L.value?(M(),Qe(tt,{key:0,"image-url":L.value.imageUrl,boreholes:$.value,bounds:L.value.bounds,property:"thickness","property-label":"åšåº¦","value-range":L.value.valueRange,colormap:"YlOrBr","cross-section-mode":Q.value,onCrossSectionComplete:_e},null,8,["image-url","boreholes","bounds","value-range","cross-section-mode"])):(M(),P("div",Qo,[...e[28]||(e[28]=[l("p",null,'è®¾ç½®å‚æ•°åç‚¹å‡»"ç”Ÿæˆç­‰å€¼çº¿å›¾"',-1)])]))])])):J("",!0),Z.value?(M(),P("div",el,[l("div",tl,[l("div",null,[e[29]||(e[29]=l("h3",{class:"section-title"},[l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),l("path",{d:"m2 17 10 5 10-5"})]),We(" ç…¤å±‚åŸ‹æ·±åˆ†å¸ƒ ")],-1)),l("p",ol,k(Ce(se.value))+" Â· "+k((y=(O=(z=Z.value)==null?void 0:z.valueRange)==null?void 0:O.min)==null?void 0:y.toFixed(1))+" - "+k((q=(B=(Y=Z.value)==null?void 0:Y.valueRange)==null?void 0:B.max)==null?void 0:q.toFixed(1))+" m",1)])]),l("div",ll,[Z.value?(M(),Qe(tt,{key:0,"image-url":Z.value.imageUrl,boreholes:$.value,bounds:Z.value.bounds,property:"burial_depth","property-label":"åŸ‹æ·±","value-range":Z.value.valueRange,colormap:"viridis","cross-section-mode":Q.value,onCrossSectionComplete:_e},null,8,["image-url","boreholes","bounds","value-range","cross-section-mode"])):(M(),P("div",sl,[...e[30]||(e[30]=[l("p",null,'è®¾ç½®å‚æ•°åç‚¹å‡»"ç”Ÿæˆç­‰å€¼çº¿å›¾"',-1)])]))])])):J("",!0)])):J("",!0),L.value?(M(),P("div",nl,[e[31]||(e[31]=Se('<div class="map-header" data-v-1d2ef65a><div data-v-1d2ef65a><h3 class="section-title" data-v-1d2ef65a><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1d2ef65a><circle cx="12" cy="12" r="10" data-v-1d2ef65a></circle><line x1="12" y1="8" x2="12" y2="12" data-v-1d2ef65a></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-1d2ef65a></line></svg> æ’å€¼ä¸ç¡®å®šæ€§åˆ†å¸ƒ </h3><p class="section-desc" data-v-1d2ef65a>çº¢è‰²åŒºåŸŸè¡¨ç¤ºé«˜ä¸ç¡®å®šæ€§ï¼Œè“è‰²åŒºåŸŸæ›´å¯é </p></div></div>',1)),l("div",al,[l("canvas",{ref_key:"uncertaintyCanvas",ref:ge,class:"uncertainty-canvas"},null,512)])])):J("",!0),ne.value.hasData?(M(),P("div",il,[l("div",rl,[l("div",null,[l("h3",cl,[e[32]||(e[32]=l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M3 3v18h18"}),l("path",{d:"m19 9-5 5-4-4-3 3"})],-1)),e[33]||(e[33]=We(" å‰–é¢åˆ‡ç‰‡ (A-A') ",-1)),l("span",dl,k((f=ne.value.distance)==null?void 0:f.toFixed(0))+"m",1)])]),l("button",{class:"btn outline small",onClick:g},"é‡ç½®")]),l("div",ul,[l("canvas",{ref_key:"crossSectionCanvas",ref:p,class:"cross-section-canvas"},null,512)])])):J("",!0)])):(M(),P("div",Qt,[e[10]||(e[10]=Se('<h3 class="section-title" data-v-1d2ef65a><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1d2ef65a><rect x="3" y="3" width="18" height="18" rx="2" ry="2" data-v-1d2ef65a></rect><line x1="3" y1="9" x2="21" y2="9" data-v-1d2ef65a></line><line x1="9" y1="21" x2="9" y2="9" data-v-1d2ef65a></line></svg> é€‰æ‹©åˆ†æç…¤å±‚ </h3><p class="section-desc" data-v-1d2ef65a>ä»ä»¥ä¸‹å¯ç”¨ç…¤å±‚ä¸­é€‰æ‹©ä¸€ä¸ªè¿›è¡Œæ’å€¼åˆ†æ</p>',2)),l("div",eo,[(M(!0),P(Re,null,De(ie.value,v=>{var b,C,G,m,F;return M(),P("div",{key:v.name,class:"seam-selection-card",onClick:le=>ze(v)},[l("div",oo,[l("span",lo,k(v.name),1),l("span",so,k(v.borehole_count)+" ä¸ªé’»å­”",1)]),l("div",no,[l("div",ao,[e[8]||(e[8]=l("span",{class:"mini-stat-label"},"å¹³å‡åšåº¦",-1)),l("span",io,k((b=v.avg_thickness)==null?void 0:b.toFixed(2))+" m",1)]),l("div",ro,[e[9]||(e[9]=l("span",{class:"mini-stat-label"},"åšåº¦èŒƒå›´",-1)),l("span",co,k((G=(C=v.thickness_range)==null?void 0:C.min)==null?void 0:G.toFixed(1))+"-"+k((F=(m=v.thickness_range)==null?void 0:m.max)==null?void 0:F.toFixed(1))+" m",1)])])],8,to)}),128))])]))])}}},yl=lt(hl,[["__scopeId","data-v-1d2ef65a"]]);export{yl as default};
