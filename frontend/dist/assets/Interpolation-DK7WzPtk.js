var ve=Object.defineProperty,fe=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var ot=Math.pow,ne=(X,Q,U)=>Q in X?ve(X,Q,{enumerable:!0,configurable:!0,writable:!0,value:U}):X[Q]=U,zt=(X,Q)=>{for(var U in Q||(Q={}))me.call(Q,U)&&ne(X,U,Q[U]);if(oe)for(var U of oe(Q))ge.call(Q,U)&&ne(X,U,Q[U]);return X},Lt=(X,Q)=>fe(X,he(Q));var Bt=(X,Q,U)=>new Promise((R,kt)=>{var ft=nt=>{try{ut(U.next(nt))}catch(ht){kt(ht)}},pt=nt=>{try{ut(U.throw(nt))}catch(ht){kt(ht)}},ut=nt=>nt.done?R(nt.value):Promise.resolve(nt.value).then(ft,pt);ut((U=U.apply(X,Q)).next())});import{w as pe,b5 as S,b8 as C,b7 as l,bb as _,bn as Wt,bm as ae,bi as tt,bc as Vt,b9 as Ut,ba as ee,b as w,c as Ct,bf as ye,bq as $t,br as te,bs as ie,bt as xe,bo as Ht,b6 as re,n as ce}from"./vendor-CA5Q5CdR.js";import{u as be,a as ke}from"./vue-router-D9BXaJFq.js";import{_ as ue,u as _e,a as Se}from"./index-D1RuNWc2.js";import{g as we,a as Te,b as Me,c as Ce}from"./api-BcwPnB85.js";import"./network-T6nY3V_4.js";const Fe={key:0,class:"error-placeholder"},Ae={class:"error-detail"},Pe={key:1,class:"loading-placeholder"},Be=["src"],$e=["viewBox"],We={key:0},Re=["x1","y1","x2","y2"],De=["cx","cy"],Ee=["x","y"],Ye=["cx","cy"],Ie=["x","y"],Xe=["x","y"],Ne=["x1","y1","x2","y2"],ze=["transform","onMouseenter"],Le=["fill"],He={class:"map-controls"},Ve={key:1,class:"legend"},Ue={class:"legend-title"},qe={class:"legend-range"},Oe={class:"legend-min"},je={class:"legend-bar"},Ke={class:"legend-max"},Ge={key:0,class:"tooltip-borehole"},Je={class:"tooltip-name"},Qe={class:"tooltip-coords"},Ze={class:"tooltip-value"},tl={class:"tooltip-label"},el={class:"tooltip-number"},ll={__name:"ContourMap",props:{imageUrl:{type:String,default:""},boreholes:{type:Array,default:()=>[]},bounds:{type:Object,default:()=>({})},property:{type:String,default:"thickness"},propertyLabel:{type:String,default:"åšåº¦"},valueRange:{type:Object,default:()=>({min:0,max:10})},colormap:{type:String,default:"YlOrBr"},crossSectionMode:{type:Boolean,default:!1}},emits:["crossSectionChange","crossSectionComplete"],setup(X,{expose:Q,emit:U}){const R=X,kt=U,ft=w(null),pt=w(800),ut=w(600),nt=w(!1),ht=w(null),q=w(1),mt=w(0),lt=w(0),ct=w(!1),Y=w(!1),_t=w({x:0,y:0}),gt=w(null),at=w(null),yt=w({x:0,y:0}),H=w(!0),f=w({start:null,end:null,distance:null}),dt=w(null),vt=Ct(()=>{if(R.bounds&&R.bounds.min_x!==void 0)return{minX:R.bounds.min_x,maxX:R.bounds.max_x,minY:R.bounds.min_y,maxY:R.bounds.max_y,rangeX:R.bounds.max_x-R.bounds.min_x,rangeY:R.bounds.max_y-R.bounds.min_y};if(R.boreholes.length===0)return null;let u=1/0,r=-1/0,y=1/0,k=-1/0;return R.boreholes.forEach(F=>{F.x<u&&(u=F.x),F.x>r&&(r=F.x),F.y<y&&(y=F.y),F.y>k&&(k=F.y)}),{minX:u,maxX:r,minY:y,maxY:k,rangeX:r-u,rangeY:k-y}}),Ft=Ct(()=>{if(!vt.value||R.boreholes.length===0)return[];if(!nt.value||!R.imageUrl)return[];const u=vt.value,r=pt.value,y=ut.value;if(!Number.isFinite(r)||!Number.isFinite(y)||r<=0||y<=0)return[];if(!Number.isFinite(u.rangeX)||!Number.isFinite(u.rangeY)||u.rangeX<=0||u.rangeY<=0)return[];const k=r*.1,F=r*(1-.1-.85),G=y*.1,st=y*(1-.1-.8),s=r-k-F,t=y-G-st;return R.boreholes.map(a=>{var m,g;const o=(m=a.x)!=null?m:a.borehole_x,d=(g=a.y)!=null?g:a.borehole_y;if(o==null||d==null)return null;const e=(o-u.minX)/u.rangeX,n=(d-u.minY)/u.rangeY,i=k+e*s,c=y-G-n*t;return Lt(zt({},a),{x:o,y:d,canvasX:Math.round(i*10)/10,canvasY:Math.round(c*10)/10,color:xt(a[R.property]||a.thickness||a.burial_depth)})}).filter(a=>a!==null)}),xt=u=>{var F,G;if(u==null)return"#3b82f6";const r=((F=R.valueRange)==null?void 0:F.min)||0,y=((G=R.valueRange)==null?void 0:G.max)||1,k=Math.max(0,Math.min(1,(u-r)/(y-r||1)));return R.colormap==="YlOrBr"?At(k,[{t:0,r:255,g:255,b:204},{t:.25,r:255,g:230,b:153},{t:.5,r:255,g:190,b:121},{t:.75,r:230,g:140,b:80},{t:1,r:160,g:80,b:50}]):At(k,[{t:0,r:68,g:1,b:84},{t:.25,r:59,g:82,b:139},{t:.5,r:33,g:154,b:141},{t:.75,r:94,g:201,b:98},{t:1,r:253,g:231,b:37}])},At=(u,r)=>{let y=r[0],k=r[r.length-1];for(let t=0;t<r.length-1;t++)if(u>=r[t].t&&u<=r[t+1].t){y=r[t],k=r[t+1];break}const F=k.t!==y.t?(u-y.t)/(k.t-y.t):0,G=Math.round(y.r+(k.r-y.r)*F),st=Math.round(y.g+(k.g-y.g)*F),s=Math.round(y.b+(k.b-y.b)*F);return`rgb(${G}, ${st}, ${s})`},Rt=Ct(()=>({transform:`scale(${q.value}) translate(${mt.value/q.value}px, ${lt.value/q.value}px)`,transformOrigin:"center center",transition:ct.value?"none":"transform 0.1s ease-out"})),qt=Ct(()=>({position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) scale(${q.value}) translate(${mt.value/q.value}px, ${lt.value/q.value}px)`,transformOrigin:"center center",pointerEvents:"none",transition:ct.value?"none":"transform 0.1s ease-out",maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"})),Ot=Ct(()=>({left:yt.value.x+15+"px",top:yt.value.y+15+"px"})),jt=Ct(()=>R.colormap==="YlOrBr"?"background: linear-gradient(to right, #fffacc, #ffe699, #ffbe79, #e68c50, #a05032)":"background: linear-gradient(to right, #440154, #3b528b, #21918c, #5ec962, #fde725)"),Dt=u=>{pt.value=u.target.naturalWidth,ut.value=u.target.naturalHeight,nt.value=!0,ht.value=null},Pt=u=>{var r;ht.value="å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ•°æ®",nt.value=!1,console.error("Image load error:",u,((r=R.imageUrl)==null?void 0:r.substring(0,50))+"...")},Et=()=>{q.value=Math.min(q.value*1.2,3)},Kt=()=>{q.value=Math.max(q.value/1.2,.5)},Tt=()=>{q.value=1,mt.value=0,lt.value=0},Gt=()=>{f.value={start:null,end:null,distance:null},dt.value=null,kt("crossSectionChange",null)},Yt=(u,r)=>{if(!ft.value)return null;const y=ft.value.getBoundingClientRect(),k=y.width/2,F=y.height/2,G=(u-k-mt.value)/q.value+k,st=(r-F-lt.value)/q.value+F,s=(y.width-pt.value)/2,t=(y.height-ut.value)/2;return{x:G-s,y:st-t}},wt=(u,r)=>{if(!vt.value)return null;const y=pt.value,k=ut.value,F=y*.1,G=y*(1-.1-.85),st=k*.1,s=k*(1-.1-.8),t=y-F-G,a=k-st-s,o=vt.value,d=o.minX+(u-F)/t*o.rangeX,e=o.minY+(k-r-st)/a*o.rangeY;return{x:d,y:e}},It=u=>{var r,y;if(!(u.pointerType!=="touch"&&u.button!==0))if(gt.value=u.pointerId,(y=(r=ft.value)==null?void 0:r.setPointerCapture)==null||y.call(r,u.pointerId),R.crossSectionMode){const k=Yt(u.clientX,u.clientY);if(!k)return;if(!f.value.start)f.value.start=k,Y.value=!0;else if(f.value.end)f.value={start:k,end:null,distance:null},Y.value=!0;else{f.value.end=k,Y.value=!1;const F=wt(k.x,k.y),G=wt(f.value.start.x,f.value.start.y);if(F&&G){const st=Math.sqrt(ot(G.x-F.x,2)+ot(G.y-F.y,2));f.value.distance=st}dt.value=null,kt("crossSectionComplete",{start:wt(f.value.start.x,f.value.start.y),end:wt(f.value.end.x,f.value.end.y),startCanvas:f.value.start,endCanvas:f.value.end,distance:f.value.distance})}kt("crossSectionChange",f.value)}else ct.value=!0,_t.value={x:u.clientX-mt.value,y:u.clientY-lt.value}},Xt=u=>{var r,y;gt.value!==null&&u.pointerId!==gt.value||(gt.value=null,(y=(r=ft.value)==null?void 0:r.releasePointerCapture)==null||y.call(r,u.pointerId),ct.value=!1)},Nt=u=>{if(ft.value){if(ft.value.getBoundingClientRect(),R.crossSectionMode&&Y.value){const r=Yt(u.clientX,u.clientY);r&&(dt.value=r),yt.value={x:u.clientX,y:u.clientY};return}if(ct.value){mt.value=u.clientX-_t.value.x,lt.value=u.clientY-_t.value.y;return}u.pointerType!=="touch"&&(yt.value={x:u.clientX,y:u.clientY})}},Jt=()=>{ct.value||(at.value=null)},Qt=u=>{u.preventDefault();const r=u.deltaY>0?.9:1.1;q.value=Math.max(.5,Math.min(3,q.value*r))};return pe(()=>R.imageUrl,()=>{Tt(),nt.value=!1,ht.value=null}),Q({resetView:Tt,resetCrossSection:Gt,boreholes:Ft,crossSectionLine:f}),(u,r)=>{var y,k,F,G,st,s;return S(),C("div",{class:ee(["contour-map-wrapper",{"cross-section-mode":X.crossSectionMode}])},[l("div",{ref_key:"imageContainer",ref:ft,class:"image-container",onPointerdown:It,onPointermove:Nt,onPointerup:Xt,onPointercancel:Xt,onPointerleave:Jt,onWheel:ae(Qt,["prevent"]),onContextmenu:r[0]||(r[0]=ae(()=>{},["prevent"]))},[ht.value?(S(),C("div",Fe,[r[3]||(r[3]=l("p",null,"âš ï¸ å›¾ç‰‡åŠ è½½å¤±è´¥",-1)),l("p",Ae,_(ht.value),1),r[4]||(r[4]=l("p",{class:"error-hint"},"è¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ",-1))])):X.imageUrl?(S(),C("img",{key:2,src:X.imageUrl,class:"contour-image",style:Wt(Rt.value),alt:"Contour Map",loading:"lazy",decoding:"async",onLoad:Dt,onError:Pt},null,44,Be)):(S(),C("div",Pe,[...r[5]||(r[5]=[l("div",{class:"spinner"},null,-1),l("p",null,"æ­£åœ¨ç”Ÿæˆç­‰å€¼çº¿å›¾...",-1)])]))],544),X.imageUrl?(S(),C("svg",{key:0,class:"borehole-overlay",viewBox:`0 0 ${pt.value} ${ut.value}`,style:Wt(qt.value),preserveAspectRatio:"xMidYMid meet"},[r[7]||(r[7]=l("defs",null,[l("filter",{id:"shadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},[l("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2","flood-opacity":"0.3"})]),l("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto"},[l("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#f59e0b"})])],-1)),f.value.start&&f.value.end?(S(),C("g",We,[l("line",{x1:f.value.start.x,y1:f.value.start.y,x2:f.value.end.x,y2:f.value.end.y,stroke:"#f59e0b","stroke-width":"3","stroke-dasharray":"8,4","marker-end":"url(#arrowhead)",class:"cross-section-line"},null,8,Re),l("circle",{cx:f.value.start.x,cy:f.value.start.y,r:"8",fill:"#f59e0b",stroke:"white","stroke-width":"2",class:"cross-section-marker"},null,8,De),l("text",{x:f.value.start.x,y:f.value.start.y-15,fill:"#f59e0b","font-size":"14","font-weight":"bold","text-anchor":"middle"},"A",8,Ee),l("circle",{cx:f.value.end.x,cy:f.value.end.y,r:"8",fill:"#f59e0b",stroke:"white","stroke-width":"2",class:"cross-section-marker"},null,8,Ye),l("text",{x:f.value.end.x,y:f.value.end.y-15,fill:"#f59e0b","font-size":"14","font-weight":"bold","text-anchor":"middle"},"A'",8,Ie),l("text",{x:(f.value.start.x+f.value.end.x)/2,y:(f.value.start.y+f.value.end.y)/2-15,fill:"white","font-size":"12","text-anchor":"middle",class:"distance-label"},_((y=f.value.distance)==null?void 0:y.toFixed(0))+"m",9,Xe)])):tt("",!0),X.crossSectionMode&&f.value.start&&dt.value?(S(),C("line",{key:1,x1:f.value.start.x,y1:f.value.start.y,x2:dt.value.x,y2:dt.value.y,stroke:"rgba(245, 158, 11, 0.5)","stroke-width":"2","stroke-dasharray":"4,4"},null,8,Ne)):tt("",!0),H.value?(S(!0),C(Vt,{key:2},Ut(Ft.value,(t,a)=>(S(),C("g",{key:a,transform:`translate(${t.canvasX}, ${t.canvasY})`,class:"borehole-marker",onMouseenter:o=>at.value=Lt(zt({},t),{isBorehole:!0}),onMouseleave:r[1]||(r[1]=o=>at.value=null)},[r[6]||(r[6]=l("circle",{r:"9",fill:"rgba(255,255,255,0.95)",filter:"url(#shadow)"},null,-1)),l("circle",{r:"6",fill:t.color||"#3b82f6",stroke:"#1e3a8a","stroke-width":"1.5"},null,8,Le)],40,ze))),128)):tt("",!0)],12,$e)):tt("",!0),l("div",He,[l("button",{class:"control-btn",onClick:Et,title:"æ”¾å¤§"},[...r[8]||(r[8]=[l("span",null,"+",-1)])]),l("button",{class:"control-btn",onClick:Kt,title:"ç¼©å°"},[...r[9]||(r[9]=[l("span",null,"âˆ’",-1)])]),l("button",{class:"control-btn",onClick:Tt,title:"é‡ç½®"},[...r[10]||(r[10]=[l("span",null,"âŸ²",-1)])]),l("button",{class:ee(["control-btn",{active:H.value}]),onClick:r[2]||(r[2]=t=>H.value=!H.value),title:"é’»å­”ç‚¹"},[...r[11]||(r[11]=[l("span",null,"ğŸ“",-1)])],2)]),X.valueRange?(S(),C("div",Ve,[l("div",Ue,_(X.propertyLabel),1),l("div",qe,[l("span",Oe,_((k=X.valueRange.min)==null?void 0:k.toFixed(2))+"m",1),l("div",je,[l("div",{class:"legend-gradient",style:Wt(jt.value)},null,4)]),l("span",Ke,_((F=X.valueRange.max)==null?void 0:F.toFixed(2))+"m",1)])])):tt("",!0),at.value?(S(),C("div",{key:2,class:"hover-tooltip",style:Wt(Ot.value)},[at.value.isBorehole?(S(),C("div",Ge,[l("div",Je,_(at.value.name||at.value.borehole),1),l("div",Qe,"("+_((G=at.value.x)==null?void 0:G.toFixed(1))+", "+_((st=at.value.y)==null?void 0:st.toFixed(1))+")",1),l("div",Ze,[l("span",tl,_(X.propertyLabel)+":",1),l("span",el,_((s=at.value.value)==null?void 0:s.toFixed(2))+" m",1)])])):tt("",!0)],4)):tt("",!0)],2)}}},de=ue(ll,[["__scopeId","data-v-f952f88d"]]),sl={class:"page"},ol={class:"header"},nl={class:"muted"},al={key:0,class:"header-stats"},il={class:"stat-badge"},rl={class:"stat-badge primary"},cl={class:"stat-badge"},dl={key:0,class:"card"},ul={class:"seam-selection-grid"},vl=["onClick"],fl={class:"seam-card-header"},hl={class:"seam-name"},ml={class:"seam-count"},gl={class:"seam-card-stats"},pl={class:"mini-stat"},yl={class:"mini-stat-value"},xl={class:"mini-stat"},bl={class:"mini-stat-value"},kl={key:1,class:"grid"},_l={class:"card params-card compact-card"},Sl={class:"param-row"},wl={class:"tab-buttons"},Tl=["onClick"],Ml={class:"param-row"},Cl={class:"param-header"},Fl={class:"param-value"},Al={class:"param-row"},Pl={class:"param-header"},Bl={class:"param-value"},$l={key:0,class:"param-row"},Wl={class:"toggle-btn",style:{width:"100%"}},Rl={key:0,class:"hint-text"},Dl={class:"action-buttons"},El=["disabled"],Yl={key:0,class:"spinner sm"},Il={class:"card compact-card"},Xl={key:0,class:"histogram-wrapper"},Nl={key:1,class:"empty-state"},zl={key:2,class:"stats-grid"},Ll={class:"stat-item"},Hl={class:"stat-value"},Vl={class:"stat-item"},Ul={class:"stat-value"},ql={class:"stat-item"},Ol={class:"stat-value"},jl={class:"stat-item"},Kl={class:"stat-value"},Gl={class:"stat-item"},Jl={class:"stat-value"},Ql={class:"stat-item"},Zl={class:"stat-value"},ts={class:"card compact-card"},es={class:"stratigraphic-wrapper"},ls={class:"lithology-legend-compact"},ss={class:"legend-name"},os={key:0,class:"map-row"},ns={key:0,class:"card map-card-large"},as={class:"map-header"},is={class:"section-desc"},rs={class:"map-wrapper"},cs={key:1,class:"empty-state"},ds={key:1,class:"card map-card-large"},us={class:"map-header"},vs={class:"section-desc"},fs={class:"map-wrapper"},hs={key:1,class:"empty-state"},ms={key:1,class:"card map-card-full"},gs={class:"map-wrapper uncertainty-wrapper"},ps={key:2,class:"card map-card-full"},ys={class:"map-header"},xs={class:"section-title"},bs={class:"section-badge"},ks={class:"cross-section-wrapper"},_s={__name:"Interpolation",setup(X,{expose:Q}){const U=Se(),R=be(),kt=ke(),{workspaceState:ft,setSelectedSeam:pt,markStepDone:ut}=_e(),nt=w(!1),ht=w(null),q=w(!1),mt=w([]),lt=w(null),ct=w(null),Y=w([]),_t=w([]),gt=w("kriging"),at=w(80),yt=w(10),H=w(null),f=w(null),dt=w(!1),vt=w({line:null,points:[],depthProfile:[],distance:null,hasData:!1}),Ft=w(null),xt=w(null),At=w(null),Rt=w(null),qt=[{key:"kriging",label:"Kriging"},{key:"idw",label:"IDW"},{key:"linear",label:"Linear"},{key:"nearest",label:"Nearest"}],Ot={ç»†ç ‚å²©:"#FCEBB6",ç²‰ç ‚å²©:"#E0FFFF",æ³¥å²©:"#D3D3D3",ä¸­ç ‚å²©:"#FCEBB6",ç²—ç ‚å²©:"#F5DEB3",ç ¾å²©:"#DEB887",ç‚­è´¨æ³¥å²©:"#8B8B8B",ç ‚è´¨æ³¥å²©:"#D8D8D8",æ³¥è´¨ç ‚å²©:"#E8E8E8",çŸ³ç°å²©:"#B0E0E6",ç…¤:"#2F4F4F"},jt={ç»†ç ‚å²©:{facecolor:"#FCEBB6",hatch:"...",edgecolor:"#999999"},ç²‰ç ‚å²©:{facecolor:"#E0FFFF",hatch:"...",edgecolor:"#AAAAAA"},æ³¥å²©:{facecolor:"#D3D3D3",hatch:"---",edgecolor:"#666666"},ä¸­ç ‚å²©:{facecolor:"#FCEBB6",hatch:"...",edgecolor:"#999999"},ç²—ç ‚å²©:{facecolor:"#F5DEB3",hatch:"...",edgecolor:"#999999"},ç ¾å²©:{facecolor:"#DEB887",hatch:"ooo",edgecolor:"#8B4513"},ç‚­è´¨æ³¥å²©:{facecolor:"#8B8B8B",hatch:"---",edgecolor:"#444444"},ç ‚è´¨æ³¥å²©:{facecolor:"#D8D8D8",hatch:"-..",edgecolor:"#777777"},æ³¥è´¨ç ‚å²©:{facecolor:"#E8E8E8",hatch:".-.",edgecolor:"#888888"},çŸ³ç°å²©:{facecolor:"#B0E0E6",hatch:"+++",edgecolor:"#5F9EA0"},ç…¤:{facecolor:"#2F4F4F",hatch:"",edgecolor:"#1a1a1a"}},Dt=s=>({kriging:"Kriging",idw:"IDW",linear:"Linear",nearest:"Nearest"})[s]||s,Pt=()=>{const s=Y.value.map(t=>t.thickness).filter(t=>t!=null);return s.length===0?0:s.reduce((t,a)=>t+a,0)/s.length},Et=()=>{const s=Y.value.map(o=>o.thickness).filter(o=>o!=null);if(s.length===0)return 0;const t=Pt(),a=s.reduce((o,d)=>o+ot(d-t,2),0)/s.length;return Math.sqrt(a)},Kt=()=>{const s=Pt();return s===0?0:Et()/s*100},Tt=()=>{const s=Y.value.map(t=>t.thickness).filter(t=>t!=null);return s.length===0?{min:0,max:0}:{min:Math.min(...s),max:Math.max(...s)}},Gt=()=>Bt(this,null,function*(){nt.value=!0;try{const{data:s}=yield we();mt.value=s.seams||[]}catch(s){ht.value="åŠ è½½ç…¤å±‚å¤±è´¥"}finally{nt.value=!1}}),Yt=(s=[])=>{let t=0;return s.map(a=>{var n,i;const o=Number((n=a.thickness)!=null?n:0)||0;let d=Number(a.z_top),e=Number(a.z_bottom);if(Number.isFinite(d)||(d=t),Number.isFinite(e)||(e=d+o),!Number.isFinite(o)||o===0){const c=Math.max((e||0)-(d||0),0);c>0&&(a.thickness=c)}return t=e,Lt(zt({},a),{thickness:Number((i=a.thickness)!=null?i:o)||0,z_top:d,z_bottom:e})})},wt=s=>Bt(this,null,function*(){var t,a,o;lt.value=s,pt((s==null?void 0:s.name)||""),H.value=null,f.value=null;try{const{data:d}=yield Te(s.name);ct.value=d,Y.value=d.points||[];try{const e=yield Me(s.name),n=((t=e==null?void 0:e.data)==null?void 0:t.boreholes)||[],i=n.reduce((m,g)=>{var $,A;const O=(($=m==null?void 0:m.layers)==null?void 0:$.length)||0;return(((A=g==null?void 0:g.layers)==null?void 0:A.length)||0)>O?g:m},n[0]),c=Yt((i==null?void 0:i.layers)||[]);_t.value=c.sort((m,g)=>(m.z_top||0)-(g.z_top||0))}catch(e){_t.value=[]}yield It(),yield ce(),Nt(),ut("Interpolation",{interpolationPoints:Y.value.length||0}),Jt()}catch(d){U.add("åŠ è½½ç…¤å±‚è¯¦æƒ…å¤±è´¥: "+(((o=(a=d.response)==null?void 0:a.data)==null?void 0:o.detail)||d.message),"error")}}),It=()=>Bt(this,null,function*(){var s,t,a,o,d;if(lt.value){q.value=!0;try{const{data:e}=yield Ce(lt.value.name,gt.value,at.value,yt.value);Y.value=e.boreholes||[],(s=e.thickness)!=null&&s.image?H.value={imageUrl:`data:image/png;base64,${e.thickness.image}`,valueRange:e.thickness.value_range,bounds:e.bounds}:H.value=null,(t=e.depth)!=null&&t.image?f.value={imageUrl:`data:image/png;base64,${e.depth.image}`,valueRange:e.depth.value_range,bounds:e.bounds}:f.value=null,yield ce(),Xt(),Nt(),ut("Interpolation",{interpolationPoints:Y.value.length||0}),U.add("ç­‰å€¼çº¿å›¾ç”Ÿæˆå®Œæˆ","success")}catch(e){console.error("Interpolate error:",e),console.error("Error response:",(a=e.response)==null?void 0:a.data),U.add(((d=(o=e.response)==null?void 0:o.data)==null?void 0:d.detail)||"ç”Ÿæˆç­‰å€¼çº¿å›¾å¤±è´¥","error")}finally{q.value=!1}}}),Xt=()=>{if(!Y.value.length||!H.value)return;const s=Rt.value;if(!s)return;const t=s.getContext("2d");if(!t)return;const a=s.width=900,o=s.height=550,d=H.value.bounds;if(!(d&&Number.isFinite(d.min_x)&&Number.isFinite(d.max_x)&&Number.isFinite(d.min_y)&&Number.isFinite(d.max_y)&&d.max_x>d.min_x&&d.max_y>d.min_y))return;const n=Y.value.map(p=>({x:Number(p.x),y:Number(p.y)})).filter(p=>Number.isFinite(p.x)&&Number.isFinite(p.y));if(n.length===0)return;t.fillStyle="#ffffff",t.fillRect(0,0,a,o);const i={left:20,right:35,top:20,bottom:60},c=a-i.left-i.right-50,m=o-i.top-i.bottom,g=150,O=[],j=500;for(let p=0;p<g;p++){O[p]=[];for(let B=0;B<g;B++){const W=d.min_x+B/g*(d.max_x-d.min_x),rt=d.max_y-p/g*(d.max_y-d.min_y);let bt=1/0;for(const St of n){const Mt=Math.sqrt(ot(W-St.x,2)+ot(rt-St.y,2));Mt<bt&&(bt=Mt)}O[p][B]=Math.min(1.6,bt/j*1.6)}}const $=[],A=3;for(let p=0;p<g;p++){$[p]=[];for(let B=0;B<g;B++){let W=0,rt=0;for(let bt=-A;bt<=A;bt++)for(let St=-A;St<=A;St++){const Mt=p+bt,Zt=B+St;if(Mt>=0&&Mt<g&&Zt>=0&&Zt<g){const le=Math.sqrt(St*St+bt*bt),se=Math.exp(-(le*le)/(2*A*A));W+=O[Mt][Zt]*se,rt+=se}}$[p][B]=W/rt}}const E=p=>{const B=Math.min(1.5,Math.max(0,p))/1.5;if(B<.5){const W=B*2;return{r:Math.floor(49+206*W),g:Math.floor(130+125*W),b:Math.floor(189+-189*W)}}else{const W=(B-.5)*2;return{r:Math.floor(255+-40*W),g:Math.floor(255+-207*W),b:Math.floor(0+48*W)}}},it=c/g,K=m/g;for(let p=0;p<g;p++)for(let B=0;B<g;B++){const W=$[p][B],rt=E(W);t.fillStyle=`rgb(${rt.r}, ${rt.g}, ${rt.b})`,t.fillRect(i.left+B*it,i.top+(g-1-p)*K,it+1,K+1)}const N=6;for(const p of n){const B=i.left+(p.x-d.min_x)/(d.max_x-d.min_x)*c,W=i.top+(d.max_y-p.y)/(d.max_y-d.min_y)*m;t.beginPath(),t.arc(B,W,N,0,Math.PI*2),t.fillStyle="#000000",t.fill()}t.strokeStyle="#000000",t.lineWidth=2,t.strokeRect(i.left,i.top,c,m);const L=i.left+20,I=i.top+m-80,Z=120,x=50;t.fillStyle="#ffffff",t.strokeStyle="#000000",t.lineWidth=1.5,t.fillRect(L,I,Z,x),t.strokeRect(L,I,Z,x),t.fillStyle="#d73027",t.fillRect(L+10,I+28,15,15),t.strokeStyle="#000000",t.lineWidth=1,t.strokeRect(L+10,I+28,15,15),t.fillStyle="#000000",t.font="12px Arial, sans-serif",t.textAlign="left",t.fillText("é«˜ä¸ç¡®å®šæ€§",L+32,I+40),t.beginPath(),t.arc(L+17,I+18,N,0,Math.PI*2),t.fillStyle="#000000",t.fill(),t.fillText("é’»å­”ä½ç½®",L+32,I+22);const T=i.left+c-150,z=I,v=130,h=35;t.fillStyle="#ffffff",t.strokeStyle="#000000",t.lineWidth=1.5,t.fillRect(T,z,v,h),t.strokeRect(T,z,v,h),t.fillStyle="#000000",t.font="12px Arial, sans-serif",t.textAlign="left",t.fillText("0",T+10,z+22),t.textAlign="center",t.fillText("500",T+75,z+22),t.textAlign="right",t.fillText("1000 ç±³",T+120,z+22);const M=z+12;t.strokeStyle="#000000",t.lineWidth=2,t.beginPath(),t.moveTo(T+10,M),t.lineTo(T+120,M),t.stroke(),t.lineWidth=4,t.beginPath(),t.moveTo(T+10,M),t.lineTo(T+75,M),t.stroke();const P=i.left+c+20,V=i.top,J=20,et=m;for(let p=0;p<et;p++){const B=(1-p/et)*1.5,W=E(B);t.fillStyle=`rgb(${W.r}, ${W.g}, ${W.b})`,t.fillRect(P,V+p,J,1)}t.strokeStyle="#000000",t.lineWidth=1.5,t.strokeRect(P,V,J,et),t.fillStyle="#000000",t.font="11px Arial, sans-serif",t.textAlign="left";const b=[0,.5,1,1.5],D=["0","0.5","1.0","1.5+"];b.forEach((p,B)=>{const W=V+et-p/1.5*et;t.beginPath(),t.moveTo(P+J,W),t.lineTo(P+J+4,W),t.strokeStyle="#000000",t.lineWidth=1,t.stroke(),t.fillText(D[B],P+J+8,W+4)}),t.save(),t.translate(P+J+35,V+et/2),t.rotate(-Math.PI/2),t.textAlign="center",t.font="12px Arial, sans-serif",t.fillText("æ–¹å·® (å½’ä¸€åŒ–)",0,0),t.restore(),t.fillStyle="#000000",t.font="bold 14px Arial, sans-serif",t.textAlign="center",t.fillText("æ’å€¼ä¸ç¡®å®šæ€§åˆ†å¸ƒå›¾",i.left+c/2,o-28),t.font="11px Arial, sans-serif",t.fillText("çº¢è‰²åŒºåŸŸè¡¨ç¤ºè¾ƒé«˜çš„ä¸ç¡®å®šæ€§ï¼›è“è‰²åŒºåŸŸæ›´åŠ å¯é ã€‚",i.left+c/2,o-12)},Nt=()=>{const s=Ft.value;if(!s||Y.value.length===0)return;const t=s.getContext("2d");if(!t)return;const a=window.devicePixelRatio||1,o=s.parentElement,d=(o==null?void 0:o.clientWidth)||s.clientWidth||500,e=(o==null?void 0:o.clientHeight)||s.clientHeight||350;s.width=Math.round(d*a),s.height=Math.round(e*a),s.style.width=`${d}px`,s.style.height=`${e}px`,t.setTransform(a,0,0,a,0,0);const n=d,i=e,c=Y.value.map(b=>b.thickness).filter(b=>b!=null);if(c.length===0)return;const m=Math.min(...c),g=Math.max(...c),O=c.reduce((b,D)=>b+D,0)/c.length,j=c.reduce((b,D)=>b+ot(D-O,2),0)/c.length,$=Math.sqrt(j),A=20,E=g-m,it=E>0?E/A:1,K=Array(A).fill(0);for(const b of c){const D=E>0?Math.floor((b-m)/it):Math.floor(A/2),p=Math.max(0,Math.min(D,A-1));K[p]++}const N=Math.max(...K),L="#5D8AA8",I="#C8523C",Z=.85;t.fillStyle="#ffffff",t.fillRect(0,0,n,i);const x={left:50,right:25,top:45,bottom:45},T=n-x.left-x.right,z=i-x.top-x.bottom,v=T/A,h=z/(N*1.1);t.fillStyle=L,t.globalAlpha=Z;for(let b=0;b<A;b++){const D=K[b]*h,p=x.left+b*v,B=i-x.bottom-D;D>0&&(t.fillRect(p,B,v-1,D),t.strokeStyle="white",t.lineWidth=.8,t.strokeRect(p,B,v-1,D))}t.globalAlpha=1;const M=$>Number.EPSILON&&E>0;if(M){t.strokeStyle=I,t.lineWidth=2,t.beginPath();for(let b=0;b<=100;b++){const D=x.left+b/100*T,p=m+b/100*E,W=1/($*Math.sqrt(2*Math.PI))*Math.exp(-.5*ot((p-O)/$,2))*c.length*it,rt=i-x.bottom-W*h;b===0?t.moveTo(D,rt):t.lineTo(D,rt)}t.stroke()}t.strokeStyle="#000000",t.lineWidth=1,t.beginPath(),t.moveTo(x.left,x.top),t.lineTo(x.left,i-x.bottom),t.stroke(),t.beginPath(),t.moveTo(x.left,i-x.bottom),t.lineTo(n-x.right,i-x.bottom),t.stroke();const P=4;t.strokeStyle="#000000",t.lineWidth=1;for(let b=0;b<=6;b++){const D=x.left+b/6*T;t.beginPath(),t.moveTo(D,i-x.bottom),t.lineTo(D,i-x.bottom+P),t.stroke()}for(let b=0;b<=5;b++){const D=i-x.bottom-b/5*z;t.beginPath(),t.moveTo(x.left,D),t.lineTo(x.left-P,D),t.stroke()}t.fillStyle="#000000",t.font="10px Arial, sans-serif",t.textAlign="center";for(let b=0;b<=6;b++){const D=m+b/6*(g-m),p=x.left+b/6*T;t.fillText(D.toFixed(1),p,i-x.bottom+15)}t.textAlign="right";for(let b=0;b<=5;b++){const D=Math.round(b/5*(N*1.1)),p=i-x.bottom-b/5*z;t.fillText(D.toString(),x.left-6,p+3)}t.fillStyle="#000000",t.font="11px Arial, sans-serif",t.textAlign="center",t.fillText("åšåº¦ (m)",x.left+T/2,i-8),t.save(),t.translate(12,x.top+z/2),t.rotate(-Math.PI/2),t.fillText("é¢‘æ•°",0,0),t.restore(),t.fillStyle="#000000",t.font="bold 12px Arial, sans-serif",t.textAlign="left",t.fillText("Figure 1 | é’»å­”åšåº¦åˆ†å¸ƒ (n="+c.length+")",x.left,18),t.fillStyle="#000000",t.font="10px Arial, sans-serif",t.textAlign="left";const V=n-x.right-120,J=x.top+10;t.fillStyle=L,t.globalAlpha=Z,t.fillRect(V,J-4,12,10),t.globalAlpha=1,t.strokeStyle="white",t.lineWidth=.8,t.strokeRect(V,J-4,12,10),t.fillText("è§‚æµ‹å€¼",V+16,J+4),M&&(t.strokeStyle=I,t.lineWidth=2,t.beginPath(),t.moveTo(V,J+20),t.lineTo(V+12,J+20),t.stroke(),t.fillStyle="#000000",t.fillText("å¯†åº¦æ‹Ÿåˆ",V+16,J+24)),t.fillStyle="#666666",t.font="9px Arial, sans-serif",t.textAlign="left";const et=`Î¼=${O.toFixed(2)}  Ïƒ=${$.toFixed(2)}`;t.fillText(et,V,J+42)},Jt=()=>{const s=At.value;if(!s||_t.value.length===0)return;const t=s.getContext("2d"),a=window.devicePixelRatio||1,o=s.parentElement,d=(o==null?void 0:o.clientWidth)||s.clientWidth||280,e=(o==null?void 0:o.clientHeight)||s.clientHeight||500;s.width=Math.round(d*a),s.height=Math.round(e*a),s.style.width=`${d}px`,s.style.height=`${e}px`,t.setTransform(a,0,0,a,0,0);const n=d,i=e;t.fillStyle="#FFFFFF",t.fillRect(0,0,n,i);const c=_t.value;let m=Math.max(...c.map(T=>T.z_bottom||0));if((!Number.isFinite(m)||m<=0)&&(m=c.reduce((T,z)=>T+(Number(z.thickness)||0),0)),!Number.isFinite(m)||m<=0)return;const g={top:24,bottom:22},O=(i-g.top-g.bottom)/m,j=g.top,$=14,A=Math.max(110,Math.min(160,n*.3)),E=Math.max(80,Math.min(140,n*.22)),it=$+E+16+A,N=Math.max(16,(n-it)/2),L=N+$,I=L+E+16;t.fillStyle="#0F172A",t.font="bold 12px Arial, sans-serif",t.textAlign="left",t.fillText("åœ°å±‚æŸ±çŠ¶å›¾",L,18);const Z=4,x=Math.max(5,Math.ceil(m/6/5)*5)||10;t.strokeStyle="#E2E8F0",t.lineWidth=1,t.fillStyle="#64748B",t.font="10px Arial, sans-serif",t.textAlign="right",t.beginPath(),t.moveTo(N,j),t.lineTo(N,i-g.bottom),t.stroke();for(let T=0;T<=m;T+=x){const z=j+T*O;t.beginPath(),t.moveTo(N,z),t.lineTo(N+Z,z),t.stroke(),t.fillText(`${Math.round(T)} m`,N-6,z+3)}t.save(),t.translate(N-28,j+(i-g.bottom-j)/2),t.rotate(-Math.PI/2),t.textAlign="center",t.fillStyle="#64748B",t.font="11px Arial, sans-serif",t.fillText("æ·±åº¦",0,0),t.restore(),c.forEach((T,z)=>{const v=j+(T.z_top||0)*O,h=T.thickness||0,M=Math.max(h*O,3),P=jt[T.name]||{facecolor:"#D3D3D3",hatch:"---",edgecolor:"#666666"};t.fillStyle=P.facecolor,t.fillRect(L,v,E,M),M>6&&P.hatch&&Qt(t,P.hatch,L,v,E,M,P.edgecolor),t.strokeStyle="#1a1a1a",t.lineWidth=.5,t.strokeRect(L,v,E,M),M>10&&(t.fillStyle="#475569",t.font="10px Arial, sans-serif",t.textAlign="left",t.fillText(T.name,I,v+M/2+3),t.fillStyle="#2563EB",t.font="9px SF Mono, monospace",t.fillText(`${h.toFixed(1)}ç±³`,I,v+M/2+14))}),t.strokeStyle="#94A3B8",t.lineWidth=1,t.strokeRect(L,j,E,i-j-g.bottom)},Qt=(s,t,a,o,d,e,n)=>{s.save(),s.beginPath(),s.rect(a,o,d,e),s.clip(),s.strokeStyle=n,s.globalAlpha=.4,s.lineWidth=.5;const i=6;switch(t){case"...":case"ooo":s.fillStyle=n,s.globalAlpha=.3;for(let c=i/2;c<d;c+=i)for(let m=i/2;m<e;m+=i)s.beginPath(),t==="ooo"?s.arc(a+c,o+m,2.5,0,Math.PI*2):s.arc(a+c,o+m,1,0,Math.PI*2),s.fill();break;case"---":s.globalAlpha=.5;for(let c=4;c<e;c+=i)s.beginPath(),s.moveTo(a,o+c),s.lineTo(a+d,o+c),s.stroke();break;case"+++":case"xx":s.globalAlpha=.3;for(let c=i/2;c<d;c+=i)for(let m=i/2;m<e;m+=i)s.beginPath(),s.moveTo(a+c-3,o+m),s.lineTo(a+c+3,o+m),s.stroke(),s.beginPath(),s.moveTo(a+c,o+m-3),s.lineTo(a+c,o+m+3),s.stroke();break;case"-..":case".-.":s.globalAlpha=.5;for(let c=i;c<e;c+=i*1.5)s.beginPath(),s.moveTo(a,o+c),s.lineTo(a+d/2,o+c),s.stroke(),s.fillStyle=n,s.beginPath(),s.arc(a+d*.75,o+c,1.5,0,Math.PI*2),s.fill();break;case"//":case"\\\\":s.globalAlpha=.4;for(let c=-e;c<d;c+=i)s.beginPath(),s.moveTo(a+c,o),s.lineTo(a+c+e,o+e),s.stroke();break}s.restore()},u=s=>{vt.value={line:{start:s.startCanvas,end:s.endCanvas},worldLine:{start:s.start,end:s.end},points:s.points||[],depthProfile:[],distance:s.distance,hasData:!0},r(s.start,s.end,s.distance)},r=(s,t,a)=>{if(!Y.value.length||a===null)return;const o=xt.value;if(!o)return;o.getContext("2d");const d=o.width=o.offsetWidth||900,e=o.height=300,n=100,i=(t.x-s.x)/n,c=(t.y-s.y)/n,m=[];for(let g=0;g<=n;g++){const O=s.x+i*g,j=s.y+c*g,$=Y.value.map(A=>{const E=Math.sqrt(ot(O-A.x,2)+ot(j-A.y,2));return{depth:A.burial_depth,distance:E}}).filter(A=>A.depth!=null&&A.distance<500);if($.length>0){let A=0,E=0;for(const it of $){const K=1/ot(it.distance+1,2);E+=it.depth*K,A+=K}m.push({distance:g/n*a,depth:E/A})}}vt.value.depthProfile=m,y(m,a,d,e)},y=(s,t,a,o)=>{var T,z;const d=xt.value;if(!d)return;const e=d.getContext("2d");e.fillStyle="#FFFFFF",e.fillRect(0,0,a,o);const n={left:50,right:30,top:35,bottom:40},i=a-n.left-n.right,c=o-n.top-n.bottom,m=s.map(v=>v.depth),g=Math.min(...m),O=Math.max(...m),j=O-g||1,$={topSoil:"#8FBC8F",sandstone:"#F4A460",shale:"#778899",coal:"#2F2F2F",sandyShale:"#A9A9A9",limestone:"#B0C4DE"},E=c/6;[$.limestone,$.sandyShale,$.coal,$.shale,$.sandstone,$.topSoil].forEach((v,h)=>{const M=n.top+h*E;e.fillStyle=v,e.globalAlpha=.08,e.fillRect(n.left,M,i,E),e.globalAlpha=1}),e.strokeStyle="#E2E8F0",e.lineWidth=.8;const K=10;for(let v=0;v<=K;v++){const h=n.left+v/K*i;e.beginPath(),e.moveTo(h,n.top),e.lineTo(h,o-n.bottom),e.stroke()}const N=5;for(let v=0;v<=N;v++){const h=n.top+v/N*c;e.beginPath(),e.moveTo(n.left,h),e.lineTo(a-n.right,h),e.stroke()}e.strokeStyle="#94A3B8",e.lineWidth=1,e.beginPath(),e.moveTo(n.left,n.top),e.lineTo(n.left,o-n.bottom),e.stroke(),e.beginPath(),e.moveTo(n.left,o-n.bottom),e.lineTo(a-n.right,o-n.bottom),e.stroke();const L=4;e.strokeStyle="#CBD5E1",e.lineWidth=1;for(let v=0;v<=K;v++){const h=n.left+v/K*i;e.beginPath(),e.moveTo(h,o-n.bottom),e.lineTo(h,o-n.bottom+L),e.stroke()}for(let v=0;v<=N;v++){const h=o-n.bottom-v/N*c;e.beginPath(),e.moveTo(n.left,h),e.lineTo(n.left-L,h),e.stroke()}e.beginPath(),e.strokeStyle=$.sandstone,e.lineWidth=2.5,e.lineCap="round",e.lineJoin="round",s.forEach((v,h)=>{const M=n.left+v.distance/t*i,P=o-n.bottom-(v.depth-g)/j*c;h===0?e.moveTo(M,P):e.lineTo(M,P)}),e.stroke(),e.lineTo(n.left+i,o-n.bottom),e.lineTo(n.left,o-n.bottom),e.closePath(),e.fillStyle="rgba(244, 164, 96, 0.12)",e.fill();for(const v of Y.value){if(v.burial_depth==null)continue;const h=v.x,M=v.y,P=((T=vt.value.worldLine)==null?void 0:T.start)||{x:0,y:0},V=((z=vt.value.worldLine)==null?void 0:z.end)||{x:0,y:0},J=Math.sqrt(ot(V.x-P.x,2)+ot(V.y-P.y,2));if(J===0)continue;const et=((h-P.x)*(V.x-P.x)+(M-P.y)*(V.y-P.y))/ot(J,2),b=P.x+et*(V.x-P.x),D=P.y+et*(V.y-P.y);if(Math.sqrt(ot(h-b,2)+ot(M-D,2))<50&&et>=0&&et<=1){const B=n.left+et*i,W=o-n.bottom-(v.burial_depth-g)/j*c;e.beginPath(),e.arc(B,W,4,0,Math.PI*2),e.fillStyle=$.coal,e.fill(),e.strokeStyle="#ffffff",e.lineWidth=1.5,e.stroke(),e.fillStyle="#64748B",e.font="10px Arial, sans-serif",e.textAlign="center";const rt=v.borehole||v.name||"";rt&&e.fillText(rt,B,W-10)}}e.fillStyle="#64748B",e.font="11px Arial, sans-serif",e.textAlign="center";for(let v=0;v<=K;v++){const h=n.left+v/K*i,M=v/K*t;e.fillText(`${M.toFixed(0)}`,h,o-15)}e.textAlign="right";for(let v=0;v<=N;v++){const h=o-n.bottom-v/N*c,M=g+v/N*j;e.fillText(`${M.toFixed(0)}`,n.left-8,h+4)}e.fillStyle="#475569",e.font="12px Arial, sans-serif",e.textAlign="center",e.fillText("å‰–é¢è·ç¦» (ç±³)",n.left+i/2,o-5),e.save(),e.translate(12,n.top+c/2),e.rotate(-Math.PI/2),e.fillText("åŸ‹è—æ·±åº¦ (ç±³)",0,0),e.restore(),e.fillStyle="#0F172A",e.font="bold 13px Arial, sans-serif",e.textAlign="left",e.fillText(`å‰–é¢ A-A' | æ·±åº¦: ${g.toFixed(1)} - ${O.toFixed(1)} ç±³`,n.left,18);const I=a-n.right-80,Z=o-n.bottom+12,x=60;e.strokeStyle="#475569",e.lineWidth=2,e.beginPath(),e.moveTo(I,Z),e.lineTo(I+x,Z),e.stroke(),e.beginPath(),e.moveTo(I,Z-3),e.lineTo(I,Z+3),e.stroke(),e.beginPath(),e.moveTo(I+x,Z-3),e.lineTo(I+x,Z+3),e.stroke(),e.fillStyle="#64748B",e.font="10px Arial, sans-serif",e.textAlign="center",e.fillText("æ¯”ä¾‹å°º: 60ç±³",I+x/2,Z+12)},k=()=>{dt.value=!1,vt.value={line:null,points:[],depthProfile:[],distance:null,hasData:!1},xt.value&&xt.value.getContext("2d").clearRect(0,0,xt.value.width,xt.value.height)},F=()=>{var s;kt.push({name:"AcademicAlgorithm",query:(s=lt.value)!=null&&s.name?{seam:lt.value.name}:void 0})},G=s=>Array.isArray(s)?s[0]||"":typeof s=="string"?s:"";return ye(()=>Bt(this,null,function*(){var a;yield Gt();const s=G((a=R.query)==null?void 0:a.seam)||ft.selectedSeam;if(!s)return;const t=mt.value.find(o=>o.name===s);t&&(yield wt(t))})),Q({resetView:()=>{k()}}),(s,t)=>{var a,o,d,e,n,i,c,m,g,O,j,$,A,E,it,K,N,L,I,Z,x,T,z,v;return S(),C("div",sl,[l("div",ol,[l("div",null,[t[4]||(t[4]=l("h2",null,"æ’å€¼åˆ†æ",-1)),l("div",nl,_(((a=lt.value)==null?void 0:a.name)||"é€‰æ‹©ç…¤å±‚è¿›è¡Œç©ºé—´æ’å€¼åˆ†æ"),1)]),lt.value&&ct.value?(S(),C("div",al,[l("div",il,[t[5]||(t[5]=l("span",{class:"stat-label"},"åšåº¦èŒƒå›´",-1)),l("strong",null,_(((e=(d=(o=ct.value)==null?void 0:o.thickness)==null?void 0:d.min)==null?void 0:e.toFixed(2))||"-")+" - "+_(((c=(i=(n=ct.value)==null?void 0:n.thickness)==null?void 0:i.max)==null?void 0:c.toFixed(2))||"-")+" m",1)]),l("div",rl,[t[6]||(t[6]=l("span",{class:"stat-label"},"å¹³å‡åšåº¦",-1)),l("strong",null,_(((O=(g=(m=ct.value)==null?void 0:m.thickness)==null?void 0:g.mean)==null?void 0:O.toFixed(2))||"-")+" m",1)]),l("div",cl,[t[7]||(t[7]=l("span",{class:"stat-label"},"é’»å­”æ•°é‡",-1)),l("strong",null,_(((j=ct.value)==null?void 0:j.borehole_count)||Y.value.length||"-"),1)])])):tt("",!0)]),lt.value?(S(),C("div",kl,[l("div",_l,[t[17]||(t[17]=$t('<h3 class="section-title" data-v-c6f7c681><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c6f7c681><circle cx="12" cy="12" r="3" data-v-c6f7c681></circle><path d="M12 1v6m0 6v6" data-v-c6f7c681></path><path d="m4.93 4.93 4.24 4.24m5.66 5.66 4.24 4.24" data-v-c6f7c681></path><path d="m4.93 19.07 4.24-4.24m5.66-5.66 4.24-4.24" data-v-c6f7c681></path></svg> æ’å€¼å‚æ•° </h3>',1)),l("div",Sl,[t[11]||(t[11]=l("label",{class:"param-label"},"æ’å€¼æ–¹æ³•",-1)),l("div",wl,[(S(),C(Vt,null,Ut(qt,h=>l("button",{key:h.key,class:ee(["tab-btn",{active:gt.value===h.key}]),onClick:M=>gt.value=h.key},_(h.label),11,Tl)),64))])]),l("div",Ml,[l("div",Cl,[t[12]||(t[12]=l("label",{class:"param-label"},"ç½‘æ ¼å¯†åº¦",-1)),l("span",Fl,_(at.value),1)]),te(l("input",{"onUpdate:modelValue":t[0]||(t[0]=h=>at.value=h),type:"range",min:"30",max:"150",step:"10",class:"slider"},null,512),[[ie,at.value,void 0,{number:!0}]]),t[13]||(t[13]=l("div",{class:"slider-labels"},[l("span",null,"ç²—"),l("span",null,"ç»†")],-1))]),l("div",Al,[l("div",Pl,[t[14]||(t[14]=l("label",{class:"param-label"},"ç­‰å€¼çº¿çº§åˆ«",-1)),l("span",Bl,_(yt.value),1)]),te(l("input",{"onUpdate:modelValue":t[1]||(t[1]=h=>yt.value=h),type:"range",min:"5",max:"20",step:"1",class:"slider"},null,512),[[ie,yt.value,void 0,{number:!0}]]),t[15]||(t[15]=l("div",{class:"slider-labels"},[l("span",null,"å°‘"),l("span",null,"å¤š")],-1))]),H.value?(S(),C("div",$l,[l("label",Wl,[te(l("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=h=>dt.value=h)},null,512),[[xe,dt.value]]),t[16]||(t[16]=l("span",null,"ç»˜åˆ¶å‰–é¢çº¿",-1))]),dt.value?(S(),C("p",Rl,"åœ¨åœ°å›¾ä¸Šç‚¹å‡»ä¸¤ç‚¹ç»˜åˆ¶å‰–é¢çº¿")):tt("",!0)])):tt("",!0),l("div",Dl,[l("button",{class:"btn primary",onClick:It,disabled:q.value},[q.value?(S(),C("span",Yl)):tt("",!0),Ht(" "+_(q.value?"è®¡ç®—ä¸­...":"ç”Ÿæˆç­‰å€¼çº¿å›¾"),1)],8,El),l("button",{class:"btn outline",onClick:t[3]||(t[3]=h=>{lt.value=null,H.value=null,f.value=null})}," æ›´æ¢ç…¤å±‚ "),H.value||f.value?(S(),C("button",{key:0,class:"btn outline",onClick:F}," ä¸‹ä¸€æ­¥ï¼šæ–°ç®—æ³•åŸç† ")):tt("",!0)])]),l("div",Il,[t[25]||(t[25]=$t('<h3 class="section-title" data-v-c6f7c681><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c6f7c681><line x1="18" y1="20" x2="18" y2="10" data-v-c6f7c681></line><line x1="12" y1="20" x2="12" y2="4" data-v-c6f7c681></line><line x1="6" y1="20" x2="6" y2="14" data-v-c6f7c681></line></svg> æ•°æ®åˆ†å¸ƒ </h3>',1)),Y.value.length>0?(S(),C("div",Xl,[l("canvas",{ref_key:"histogramCanvas",ref:Ft,class:"histogram-canvas"},null,512)])):(S(),C("div",Nl,[...t[18]||(t[18]=[l("p",null,"æš‚æ— æ•°æ®åˆ†å¸ƒ",-1)])])),Y.value.length>0?(S(),C("div",zl,[l("div",Ll,[t[19]||(t[19]=l("span",{class:"stat-label"},"æ ·æœ¬æ•°",-1)),l("span",Hl,_(Y.value.length),1)]),l("div",Vl,[t[20]||(t[20]=l("span",{class:"stat-label"},"å‡å€¼",-1)),l("span",Ul,_(Pt().toFixed(2))+"m",1)]),l("div",ql,[t[21]||(t[21]=l("span",{class:"stat-label"},"æ ‡å‡†å·®",-1)),l("span",Ol,_(Et().toFixed(2))+"m",1)]),l("div",jl,[t[22]||(t[22]=l("span",{class:"stat-label"},"å˜å¼‚ç³»æ•°",-1)),l("span",Kl,_(Kt().toFixed(2)),1)]),l("div",Gl,[t[23]||(t[23]=l("span",{class:"stat-label"},"æœ€å°å€¼",-1)),l("span",Jl,_(Tt().min.toFixed(2))+"m",1)]),l("div",Ql,[t[24]||(t[24]=l("span",{class:"stat-label"},"æœ€å¤§å€¼",-1)),l("span",Zl,_(Tt().max.toFixed(2))+"m",1)])])):tt("",!0)]),l("div",ts,[t[26]||(t[26]=$t('<h3 class="section-title" data-v-c6f7c681><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c6f7c681><path d="M12 2L2 7l10 5 10-5-10-5z" data-v-c6f7c681></path><path d="m2 17 10 5 10-5" data-v-c6f7c681></path><path d="m2 12 10 5 10-5" data-v-c6f7c681></path></svg> åœ°å±‚æŸ±çŠ¶å›¾ </h3>',1)),l("div",es,[l("canvas",{ref_key:"stratigraphicCanvas",ref:At,class:"stratigraphic-canvas"},null,512)]),l("div",ls,[(S(),C(Vt,null,Ut(Ot,(h,M)=>l("div",{key:M,class:"legend-item-compact"},[l("div",{class:"legend-color",style:Wt({background:h})},null,4),l("span",ss,_(M),1)])),64))])]),H.value||f.value?(S(),C("div",os,[H.value?(S(),C("div",ns,[l("div",as,[l("div",null,[t[27]||(t[27]=l("h3",{class:"section-title"},[l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"})]),Ht(" ç…¤å±‚åšåº¦åˆ†å¸ƒ ")],-1)),l("p",is,_(Dt(gt.value))+" Â· "+_((E=(A=($=H.value)==null?void 0:$.valueRange)==null?void 0:A.min)==null?void 0:E.toFixed(1))+" - "+_((N=(K=(it=H.value)==null?void 0:it.valueRange)==null?void 0:K.max)==null?void 0:N.toFixed(1))+" m",1)])]),l("div",rs,[H.value?(S(),re(de,{key:0,"image-url":H.value.imageUrl,boreholes:Y.value,bounds:H.value.bounds,property:"thickness","property-label":"åšåº¦","value-range":H.value.valueRange,colormap:"YlOrBr","cross-section-mode":dt.value,onCrossSectionComplete:u},null,8,["image-url","boreholes","bounds","value-range","cross-section-mode"])):(S(),C("div",cs,[...t[28]||(t[28]=[l("p",null,'è®¾ç½®å‚æ•°åç‚¹å‡»"ç”Ÿæˆç­‰å€¼çº¿å›¾"',-1)])]))])])):tt("",!0),f.value?(S(),C("div",ds,[l("div",us,[l("div",null,[t[29]||(t[29]=l("h3",{class:"section-title"},[l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),l("path",{d:"m2 17 10 5 10-5"})]),Ht(" ç…¤å±‚åŸ‹æ·±åˆ†å¸ƒ ")],-1)),l("p",vs,_(Dt(gt.value))+" Â· "+_((Z=(I=(L=f.value)==null?void 0:L.valueRange)==null?void 0:I.min)==null?void 0:Z.toFixed(1))+" - "+_((z=(T=(x=f.value)==null?void 0:x.valueRange)==null?void 0:T.max)==null?void 0:z.toFixed(1))+" m",1)])]),l("div",fs,[f.value?(S(),re(de,{key:0,"image-url":f.value.imageUrl,boreholes:Y.value,bounds:f.value.bounds,property:"burial_depth","property-label":"åŸ‹æ·±","value-range":f.value.valueRange,colormap:"viridis","cross-section-mode":dt.value,onCrossSectionComplete:u},null,8,["image-url","boreholes","bounds","value-range","cross-section-mode"])):(S(),C("div",hs,[...t[30]||(t[30]=[l("p",null,'è®¾ç½®å‚æ•°åç‚¹å‡»"ç”Ÿæˆç­‰å€¼çº¿å›¾"',-1)])]))])])):tt("",!0)])):tt("",!0),H.value?(S(),C("div",ms,[t[31]||(t[31]=$t('<div class="map-header" data-v-c6f7c681><div data-v-c6f7c681><h3 class="section-title" data-v-c6f7c681><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c6f7c681><circle cx="12" cy="12" r="10" data-v-c6f7c681></circle><line x1="12" y1="8" x2="12" y2="12" data-v-c6f7c681></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-c6f7c681></line></svg> æ’å€¼ä¸ç¡®å®šæ€§åˆ†å¸ƒ </h3><p class="section-desc" data-v-c6f7c681>çº¢è‰²åŒºåŸŸè¡¨ç¤ºé«˜ä¸ç¡®å®šæ€§ï¼Œè“è‰²åŒºåŸŸæ›´å¯é </p></div></div>',1)),l("div",gs,[l("canvas",{ref_key:"uncertaintyCanvas",ref:Rt,class:"uncertainty-canvas"},null,512)])])):tt("",!0),vt.value.hasData?(S(),C("div",ps,[l("div",ys,[l("div",null,[l("h3",xs,[t[32]||(t[32]=l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M3 3v18h18"}),l("path",{d:"m19 9-5 5-4-4-3 3"})],-1)),t[33]||(t[33]=Ht(" å‰–é¢åˆ‡ç‰‡ (A-A') ",-1)),l("span",bs,_((v=vt.value.distance)==null?void 0:v.toFixed(0))+"m",1)])]),l("button",{class:"btn outline small",onClick:k},"é‡ç½®")]),l("div",ks,[l("canvas",{ref_key:"crossSectionCanvas",ref:xt,class:"cross-section-canvas"},null,512)])])):tt("",!0)])):(S(),C("div",dl,[t[10]||(t[10]=$t('<h3 class="section-title" data-v-c6f7c681><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c6f7c681><rect x="3" y="3" width="18" height="18" rx="2" ry="2" data-v-c6f7c681></rect><line x1="3" y1="9" x2="21" y2="9" data-v-c6f7c681></line><line x1="9" y1="21" x2="9" y2="9" data-v-c6f7c681></line></svg> é€‰æ‹©åˆ†æç…¤å±‚ </h3><p class="section-desc" data-v-c6f7c681>ä»ä»¥ä¸‹å¯ç”¨ç…¤å±‚ä¸­é€‰æ‹©ä¸€ä¸ªè¿›è¡Œæ’å€¼åˆ†æ</p>',2)),l("div",ul,[(S(!0),C(Vt,null,Ut(mt.value,h=>{var M,P,V,J,et;return S(),C("div",{key:h.name,class:"seam-selection-card",onClick:b=>wt(h)},[l("div",fl,[l("span",hl,_(h.name),1),l("span",ml,_(h.borehole_count)+" ä¸ªé’»å­”",1)]),l("div",gl,[l("div",pl,[t[8]||(t[8]=l("span",{class:"mini-stat-label"},"å¹³å‡åšåº¦",-1)),l("span",yl,_((M=h.avg_thickness)==null?void 0:M.toFixed(2))+" m",1)]),l("div",xl,[t[9]||(t[9]=l("span",{class:"mini-stat-label"},"åšåº¦èŒƒå›´",-1)),l("span",bl,_((V=(P=h.thickness_range)==null?void 0:P.min)==null?void 0:V.toFixed(1))+"-"+_((et=(J=h.thickness_range)==null?void 0:J.max)==null?void 0:et.toFixed(1))+" m",1)])])],8,vl)}),128))])]))])}}},As=ue(_s,[["__scopeId","data-v-c6f7c681"]]);export{As as default};
