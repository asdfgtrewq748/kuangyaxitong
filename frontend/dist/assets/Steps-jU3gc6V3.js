var g=(A,d,v)=>new Promise((x,P)=>{var L=b=>{try{M(v.next(b))}catch(k){P(k)}},R=b=>{try{M(v.throw(b))}catch(k){P(k)}},M=b=>b.done?x(b.value):Promise.resolve(b.value).then(L,R);M((v=v.apply(A,d)).next())});import{b as u,a as e,C as m,I as C,D as U,y as f,A as W,t as p,i as J,F as K,r as X,d as n,k as rs,o as r}from"./vue-vendor-uHJg9g_5.js";import{_ as ds,u as ps}from"./index-BQuJNExo.js";import{H as Y}from"./HeatmapCanvas-CJVa-jBY.js";import{g as vs,o as cs,q as ms,r as bs,t as ys,w as _s,c as gs,m as fs,l as ks}from"./api-BlLoGSss.js";import"./index-T6nY3V_4.js";const hs={class:"page"},xs={class:"card"},Ms={class:"param-row"},ws={class:"param-group"},Ss={class:"param-group"},Us={class:"param-grid"},Ps={class:"param-group"},Vs={class:"param-group"},Is={class:"param-group"},Cs={class:"param-group"},Ls={class:"param-row"},Rs={class:"param-group"},Fs={class:"param-group"},Gs={key:0,class:"param-group"},Ns={class:"param-group"},Bs={class:"action-buttons"},zs=["disabled"],Ds={key:0,class:"spinner sm"},qs=["disabled"],Es=["disabled"],Os=["disabled"],Ts=["disabled"],$s={key:0,class:"result-box"},js={class:"result-values"},Hs={class:"result-value"},Qs={class:"result-number"},As={class:"result-value"},Ws={class:"result-number"},Js={key:0,class:"result-error"},Ks={key:0,class:"card"},Xs={class:"result-content"},Ys={class:"card"},Zs={class:"mpi-controls"},se={class:"param-group"},ee=["value"],te={class:"param-group"},ae={class:"param-group"},le=["disabled"],oe={key:0,class:"spinner sm"},ne={key:0,class:"result-content"},ie={class:"stats-row"},ue={class:"stat-item"},re={class:"stat-value"},de={class:"stat-item"},pe={class:"stat-value"},ve={class:"stat-item"},ce={class:"stat-value"},me={class:"mpi-suggestion"},be={class:"mpi-suggestion-text"},ye={key:1,class:"empty-state"},_e={key:1,class:"card"},ge={class:"section-desc"},fe={class:"table-wrapper"},ke={class:"table"},he={key:0,class:"table-more"},xe={__name:"Steps",setup(A){const d=ps(),v=n("fixed"),x=n("initial"),P=n(10),L=n(1),R=n(2),M=n(1),b=n("total"),k=n("density_thickness"),q=n(1),F=n(60),i=n(!1),V=n(null),E=n(null),w=n(null),O=n([]),h=n(""),j=n(60),H=n("idw"),Q=n(null),G=n({}),N=n(!1),T=new Map,Z=rs(()=>{var s;const a=(s=G.value)==null?void 0:s.mean;return a==null||Number.isNaN(a)?"æš‚æ— å»ºè®®ï¼Œè¯·å…ˆè®¡ç®—MPIåˆ†å¸ƒã€‚":a<60?"MPIåä½ï¼Œå»ºè®®é€‚å½“å‡å°æ¥å‹æ­¥è·æˆ–æé«˜æ”¯æŠ¤å¼ºåº¦ã€‚":a<80?"MPIä¸­ç­‰ï¼Œå»ºè®®æŒ‰å½“å‰æ­¥è·æ‰§è¡Œï¼Œå¹¶å…³æ³¨å±€éƒ¨é«˜é£é™©åŒºã€‚":"MPIåé«˜ï¼Œæ•´ä½“é£é™©è¾ƒä½ï¼Œå¯åœ¨å®‰å…¨æ¡ä»¶ä¸‹é€‚åº¦å¢å¤§æ­¥è·ã€‚"}),ss=()=>g(this,null,function*(){var a,s;i.value=!0;try{const{data:o}=yield cs(v.value,P.value,L.value,R.value,M.value);V.value=o,d.add("æ­¥è·è®¡ç®—å®Œæˆ","success")}catch(o){d.add(((s=(a=o.response)==null?void 0:a.data)==null?void 0:s.detail)||"è®¡ç®—å¤±è´¥","error")}finally{i.value=!1}}),es=()=>g(this,null,function*(){var a,s;i.value=!0;try{const{data:o}=yield ms(v.value,x.value,b.value,k.value,F.value,q.value);E.value=o,d.add("æ­¥è·ç½‘æ ¼ç”Ÿæˆå®Œæˆ","success")}catch(o){d.add(((s=(a=o.response)==null?void 0:a.data)==null?void 0:s.detail)||"ç”Ÿæˆå¤±è´¥","error")}finally{i.value=!1}}),ts=()=>g(this,null,function*(){var a,s,o;i.value=!0;try{const{data:c}=yield ys(v.value);w.value=c,d.add(`å·²è®¡ç®— ${((a=c.items)==null?void 0:a.length)||0} ä¸ªé’»å­”`,"success")}catch(c){d.add(((o=(s=c.response)==null?void 0:s.data)==null?void 0:o.detail)||"æ‰¹é‡è®¡ç®—å¤±è´¥","error")}finally{i.value=!1}}),as=()=>g(this,null,function*(){i.value=!0;try{const{data:a}=yield bs(v.value,x.value,b.value,k.value,F.value,q.value),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=`pressure_steps_grid_${v.value}_${x.value}_${F.value}.csv`,o.click(),URL.revokeObjectURL(s),d.add("å¯¼å‡ºæˆåŠŸ","success")}catch(a){d.add("å¯¼å‡ºå¤±è´¥","error")}finally{i.value=!1}}),ls=()=>g(this,null,function*(){i.value=!0;try{const{data:a}=yield _s(v.value),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=`pressure_steps_${v.value}.csv`,o.click(),URL.revokeObjectURL(s),d.add("å¯¼å‡ºæˆåŠŸ","success")}catch(a){d.add("å¯¼å‡ºå¤±è´¥","error")}finally{i.value=!1}}),os=()=>g(this,null,function*(){try{const{data:a}=yield vs();O.value=a.seams||[],!h.value&&O.value.length>0&&(h.value=O.value[0].name)}catch(a){d.add("åŠ è½½ç…¤å±‚å¤±è´¥","error")}}),ns=a=>g(this,null,function*(){if(!a)return null;if(T.has(a))return T.get(a);try{const{data:s}=yield ks(a);return T.set(a,s),s}catch(s){return T.set(a,null),null}}),is=(...s)=>g(this,[...s],function*(a=[]){var c,S;const o=[];for(const y of a){const B=y.layers||[],I=B.find(_=>_.name===h.value),$=B.filter(_=>_.name!==h.value),z=[];for(const _ of $){const l=yield ns(_.name);z.push({thickness:_.thickness||0,name:_.name||"",density:l==null?void 0:l.density,bulk_modulus:l==null?void 0:l.bulk_modulus,shear_modulus:l==null?void 0:l.shear_modulus,cohesion:l==null?void 0:l.cohesion,friction_angle:l==null?void 0:l.friction_angle,tensile_strength:l==null?void 0:l.tensile_strength,compressive_strength:l==null?void 0:l.compressive_strength,elastic_modulus:l==null?void 0:l.elastic_modulus,poisson_ratio:l==null?void 0:l.poisson_ratio})}const t=(S=(c=y.seam_top_depth)!=null?c:y.total_overburden_thickness)!=null?S:0,D=(I==null?void 0:I.thickness)||0;o.push({x:y.x,y:y.y,borehole:y.name,thickness:D,burial_depth:t,z_top:t,z_bottom:t+D,strata:z})}return o}),us=()=>g(this,null,function*(){var a,s;if(h.value){N.value=!0;try{const{data:o}=yield gs(h.value),c=o.boreholes||[];if(c.length===0){d.add("å½“å‰ç…¤å±‚æ— å¯ç”¨é’»å­”æ•°æ®","error");return}const S=yield is(c),{data:y}=yield fs(S,j.value,H.value);Q.value=y.grid,G.value=y.statistics||{},d.add("MPIåˆ†å¸ƒè®¡ç®—å®Œæˆ","success")}catch(o){d.add(((s=(a=o.response)==null?void 0:a.data)==null?void 0:s.detail)||"MPIè®¡ç®—å¤±è´¥","error")}finally{N.value=!1}}});return os(),(a,s)=>{var o,c,S,y,B,I,$,z;return r(),u("div",hs,[s[45]||(s[45]=e("div",{class:"page-header"},[e("h1",{class:"page-title"},"ğŸ“ æ¥å‹æ­¥è·è®¡ç®—"),e("p",{class:"page-subtitle"},"åŸºäºé¡¶æ¿å²©å±‚åŠ›å­¦å‚æ•°è®¡ç®—åˆæ¬¡æ¥å‹æ­¥è·å’Œå‘¨æœŸæ¥å‹æ­¥è·")],-1)),e("div",xs,[s[30]||(s[30]=e("h3",{class:"section-title"},"è®¡ç®—æ¨¡å‹é€‰æ‹©",-1)),e("div",Ms,[e("div",ws,[s[14]||(s[14]=e("label",{class:"param-label"},"åŠ›å­¦æ¨¡å‹",-1)),m(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t),class:"param-select"},[...s[13]||(s[13]=[e("option",{value:"fixed"},"å›ºæ”¯æ¢æ¨¡å‹",-1),e("option",{value:"simply"},"ç®€æ”¯æ¢æ¨¡å‹",-1),e("option",{value:"shear"},"å‰ªåˆ‡ç ´åæ¨¡å‹",-1),e("option",{value:"empirical"},"ç»éªŒæ¯”ä¾‹æ¨¡å‹",-1)])],512),[[C,v.value]])]),e("div",Ss,[s[16]||(s[16]=e("label",{class:"param-label"},"è®¡ç®—ç›®æ ‡",-1)),m(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),class:"param-select"},[...s[15]||(s[15]=[e("option",{value:"initial"},"åˆæ¬¡æ¥å‹æ­¥è·",-1),e("option",{value:"periodic"},"å‘¨æœŸæ¥å‹æ­¥è·",-1)])],512),[[C,x.value]])])]),e("div",Us,[e("div",Ps,[s[17]||(s[17]=e("label",{class:"param-label"},"é¡¶æ¿åšåº¦ h (m)",-1)),m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>P.value=t),type:"number",step:"0.1",class:"param-input"},null,512),[[U,P.value,void 0,{number:!0}]])]),e("div",Vs,[s[18]||(s[18]=e("label",{class:"param-label"},"è½½è· q (MPa)",-1)),m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>L.value=t),type:"number",step:"0.1",class:"param-input"},null,512),[[U,L.value,void 0,{number:!0}]])]),e("div",Is,[s[19]||(s[19]=e("label",{class:"param-label"},"æŠ—æ‹‰å¼ºåº¦ t (MPa)",-1)),m(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>R.value=t),type:"number",step:"0.1",class:"param-input"},null,512),[[U,R.value,void 0,{number:!0}]])]),e("div",Cs,[s[20]||(s[20]=e("label",{class:"param-label"},"æŠ—å‰ªå¼ºåº¦ s (MPa)",-1)),m(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>M.value=t),type:"number",step:"0.1",class:"param-input"},null,512),[[U,M.value,void 0,{number:!0}]])])]),e("div",Ls,[e("div",Rs,[s[22]||(s[22]=e("label",{class:"param-label"},"h å–å€¼æ–¹å¼",-1)),m(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>b.value=t),class:"param-select"},[...s[21]||(s[21]=[e("option",{value:"total"},"æ€»åšåº¦",-1)])],512),[[C,b.value]])]),e("div",Fs,[s[24]||(s[24]=e("label",{class:"param-label"},"q å–å€¼æ–¹å¼",-1)),m(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>k.value=t),class:"param-select"},[...s[23]||(s[23]=[e("option",{value:"density_thickness"},"å®¹é‡ Ã— åšåº¦",-1),e("option",{value:"default"},"é»˜è®¤å€¼",-1)])],512),[[C,k.value]])]),k.value==="default"?(r(),u("div",Gs,[s[25]||(s[25]=e("label",{class:"param-label"},"q é»˜è®¤å€¼",-1)),m(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>q.value=t),type:"number",step:"0.1",class:"param-input"},null,512),[[U,q.value,void 0,{number:!0}]])])):f("",!0),e("div",Ns,[s[26]||(s[26]=e("label",{class:"param-label"},"ç½‘æ ¼å¤§å°",-1)),m(e("input",{"onUpdate:modelValue":s[9]||(s[9]=t=>F.value=t),type:"number",min:"20",max:"120",class:"param-input"},null,512),[[U,F.value,void 0,{number:!0}]])])]),e("div",Bs,[e("button",{class:"btn primary",onClick:ss,disabled:i.value},[i.value?(r(),u("span",Ds)):f("",!0),W(" "+p(i.value?"è®¡ç®—ä¸­...":"è®¡ç®—æ­¥è·"),1)],8,zs),e("button",{class:"btn secondary",onClick:es,disabled:i.value}," ç”Ÿæˆæ­¥è·ç½‘æ ¼ ",8,qs),E.value?(r(),u("button",{key:0,class:"btn secondary",onClick:as,disabled:i.value}," å¯¼å‡ºç½‘æ ¼ ",8,Es)):f("",!0),e("button",{class:"btn secondary",onClick:ts,disabled:i.value}," æ‰¹é‡è®¡ç®— ",8,Os),w.value?(r(),u("button",{key:1,class:"btn secondary",onClick:ls,disabled:i.value}," å¯¼å‡ºæ‰¹é‡ç»“æœ ",8,Ts)):f("",!0)]),V.value?(r(),u("div",$s,[s[29]||(s[29]=e("div",{class:"result-header"},"è®¡ç®—ç»“æœ",-1)),e("div",js,[e("div",Hs,[s[27]||(s[27]=e("span",{class:"result-label"},"åˆæ¬¡æ¥å‹æ­¥è·",-1)),e("span",Qs,p(((o=V.value.initial_step)==null?void 0:o.toFixed(2))||"-")+" m",1)]),e("div",As,[s[28]||(s[28]=e("span",{class:"result-label"},"å‘¨æœŸæ¥å‹æ­¥è·",-1)),e("span",Ws,p(((c=V.value.periodic_step)==null?void 0:c.toFixed(2))||"-")+" m",1)])]),V.value.error?(r(),u("div",Js," æ³¨æ„ï¼š"+p(V.value.error),1)):f("",!0)])):f("",!0)]),E.value?(r(),u("div",Ks,[s[31]||(s[31]=e("h3",{class:"section-title"},"æ­¥è·åˆ†å¸ƒç½‘æ ¼",-1)),e("div",Xs,[J(Y,{grid:E.value.values,size:500},null,8,["grid"])])])):f("",!0),e("div",Ys,[s[41]||(s[41]=e("h3",{class:"section-title"},"MPIåˆ†å¸ƒä¸æ­¥è·å»ºè®®",-1)),s[42]||(s[42]=e("p",{class:"section-desc"},"åŸºäºç…¤å±‚ä¸Šè¦†å²©å±‚å‚æ•°è®¡ç®—MPIåˆ†å¸ƒï¼Œç”¨äºè¾…åŠ©æ­¥è·è°ƒæ•´",-1)),e("div",Zs,[e("div",se,[s[32]||(s[32]=e("label",{class:"param-label"},"ç…¤å±‚",-1)),m(e("select",{"onUpdate:modelValue":s[10]||(s[10]=t=>h.value=t),class:"param-select"},[(r(!0),u(K,null,X(O.value,t=>(r(),u("option",{key:t.name,value:t.name},p(t.name),9,ee))),128))],512),[[C,h.value]])]),e("div",te,[s[33]||(s[33]=e("label",{class:"param-label"},"ç½‘æ ¼åˆ†è¾¨ç‡",-1)),m(e("input",{"onUpdate:modelValue":s[11]||(s[11]=t=>j.value=t),type:"number",min:"20",max:"150",class:"param-input"},null,512),[[U,j.value,void 0,{number:!0}]])]),e("div",ae,[s[35]||(s[35]=e("label",{class:"param-label"},"æ’å€¼æ–¹æ³•",-1)),m(e("select",{"onUpdate:modelValue":s[12]||(s[12]=t=>H.value=t),class:"param-select"},[...s[34]||(s[34]=[e("option",{value:"idw"},"IDW",-1),e("option",{value:"linear"},"Linear",-1),e("option",{value:"nearest"},"Nearest",-1)])],512),[[C,H.value]])]),e("button",{class:"btn secondary",onClick:us,disabled:N.value||!h.value},[N.value?(r(),u("span",oe)):f("",!0),W(" "+p(N.value?"è®¡ç®—ä¸­...":"è®¡ç®—MPIåˆ†å¸ƒ"),1)],8,le)]),Q.value?(r(),u("div",ne,[J(Y,{grid:Q.value,size:420},null,8,["grid"]),e("div",ie,[e("div",ue,[s[36]||(s[36]=e("span",{class:"stat-label"},"æœ€å°å€¼",-1)),e("span",re,p(((S=G.value.min)==null?void 0:S.toFixed(2))||"-"),1)]),e("div",de,[s[37]||(s[37]=e("span",{class:"stat-label"},"æœ€å¤§å€¼",-1)),e("span",pe,p(((y=G.value.max)==null?void 0:y.toFixed(2))||"-"),1)]),e("div",ve,[s[38]||(s[38]=e("span",{class:"stat-label"},"å¹³å‡å€¼",-1)),e("span",ce,p(((B=G.value.mean)==null?void 0:B.toFixed(2))||"-"),1)])]),e("div",me,[s[39]||(s[39]=e("div",{class:"mpi-suggestion-title"},"æ­¥è·è°ƒæ•´å»ºè®®",-1)),e("p",be,p(Z.value),1)])])):(r(),u("div",ye,[...s[40]||(s[40]=[e("div",{class:"empty-icon"},"ğŸ“Š",-1),e("p",null,"è¯·é€‰æ‹©ç…¤å±‚å¹¶è®¡ç®—MPIåˆ†å¸ƒ",-1)])]))]),w.value?(r(),u("div",_e,[s[44]||(s[44]=e("h3",{class:"section-title"},"æ‰¹é‡è®¡ç®—ç»“æœ",-1)),e("p",ge,"å·²è®¡ç®— "+p(((I=w.value.items)==null?void 0:I.length)||0)+" ä¸ªé’»å­”çš„æ¥å‹æ­¥è·",1),e("div",fe,[e("table",ke,[s[43]||(s[43]=e("thead",null,[e("tr",null,[e("th",null,"åºå·"),e("th",null,"åˆæ¬¡æ¥å‹æ­¥è· (m)"),e("th",null,"å‘¨æœŸæ¥å‹æ­¥è· (m)")])],-1)),e("tbody",null,[(r(!0),u(K,null,X(($=w.value.items)==null?void 0:$.slice(0,20),(t,D)=>{var _,l;return r(),u("tr",{key:D},[e("td",null,p(D+1),1),e("td",null,p(((_=t.initial)==null?void 0:_.toFixed(2))||"-"),1),e("td",null,p(((l=t.periodic)==null?void 0:l.toFixed(2))||"-"),1)])}),128))])]),((z=w.value.items)==null?void 0:z.length)>20?(r(),u("div",he," è¿˜æœ‰ "+p(w.value.items.length-20)+" æ¡æ•°æ®... ",1)):f("",!0)])])):f("",!0)])}}},Ie=ds(xe,[["__scopeId","data-v-9adc5646"]]);export{Ie as default};
