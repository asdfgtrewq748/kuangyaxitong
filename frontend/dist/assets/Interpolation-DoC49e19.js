var Kt=Object.defineProperty,Zt=Object.defineProperties;var eo=Object.getOwnPropertyDescriptors;var It=Object.getOwnPropertySymbols;var to=Object.prototype.hasOwnProperty,oo=Object.prototype.propertyIsEnumerable;var fe=Math.pow,Et=(N,K,I)=>K in N?Kt(N,K,{enumerable:!0,configurable:!0,writable:!0,value:I}):N[K]=I,ht=(N,K)=>{for(var I in K||(K={}))to.call(K,I)&&Et(N,I,K[I]);if(It)for(var I of It(K))oo.call(K,I)&&Et(N,I,K[I]);return N},ft=(N,K)=>Zt(N,eo(K));var $e=(N,K,I)=>new Promise((P,Se)=>{var de=ce=>{try{ae(I.next(ce))}catch(be){Se(be)}},ge=ce=>{try{ae(I.throw(ce))}catch(be){Se(be)}},ae=ce=>ce.done?P(ce.value):Promise.resolve(ce.value).then(de,ge);ae((I=I.apply(N,K)).next())});import{bl as lo,b as x,w as so,b5 as m,b8 as f,b7 as o,bb as h,bn as st,bm as Dt,bi as H,bc as Oe,b9 as Ve,ba as Je,c as Ne,bf as no,bq as ot,br as lt,bs as Tt,bt as ao,bo as gt,u as we,bu as io,b6 as Yt,n as pt}from"./vendor-CcQzWQKD.js";import{u as ro,a as co}from"./vue-router-4_hPxHr_.js";import{_ as zt,a as uo,u as vo}from"./index-DAAno9XI.js";import{g as mo,l as ho,c as fo,a as go,b as po,d as yo,e as bo,f as xo}from"./api-PFloj90e.js";import"./network-T6nY3V_4.js";const ko=new Set(["completed","failed"]),_o=()=>{const N=x(""),K=x(null),I=x([]),P=x(!1),Se=x(!1),de=x("");let ge=null;const ae=()=>{Se.value=!1,ge&&(clearInterval(ge),ge=null)},ce=()=>$e(void 0,null,function*(){var ee;if(!N.value)return null;const{data:X}=yield mo(N.value);if(K.value=X,ko.has(X.status)&&(ae(),X.status==="completed")){const E=yield ho(N.value);I.value=((ee=E.data)==null?void 0:ee.artifacts)||[]}return X}),be=(X=1200)=>{ae(),Se.value=!0,ge=setInterval(()=>$e(void 0,null,function*(){var ee,E;try{yield ce()}catch(U){de.value=((E=(ee=U==null?void 0:U.response)==null?void 0:ee.data)==null?void 0:E.detail)||(U==null?void 0:U.message)||"轮询失败",ae()}}),X)},B=X=>$e(void 0,null,function*(){var ee,E;P.value=!0,de.value="",I.value=[];try{const{data:U}=yield fo(X);return N.value=U.job_id,K.value=U,be(),U}catch(U){throw de.value=((E=(ee=U==null?void 0:U.response)==null?void 0:ee.data)==null?void 0:E.detail)||(U==null?void 0:U.message)||"提交任务失败",U}finally{P.value=!1}}),Ce=()=>{ae(),N.value="",K.value=null,I.value=[],P.value=!1,de.value=""};return lo(()=>ae()),{jobId:N,job:K,artifacts:I,loading:P,polling:Se,error:de,submit:B,refresh:ce,clear:Ce,stopPolling:ae}},wo={key:0,class:"error-placeholder"},So={class:"error-detail"},Co={key:1,class:"loading-placeholder"},To=["src"],Mo=["viewBox"],Fo={key:0},Po=["x1","y1","x2","y2"],$o=["cx","cy"],Ao=["x","y"],Ro=["cx","cy"],Bo=["x","y"],Wo=["x","y"],No=["x1","y1","x2","y2"],Io=["transform","onMouseenter"],Eo=["fill"],Do={class:"map-controls"},Yo={key:1,class:"legend"},Lo={class:"legend-title"},Xo={class:"legend-range"},zo={class:"legend-min"},qo={class:"legend-bar"},Ho={class:"legend-max"},Uo={class:"legend-mid"},Oo={key:0,class:"tooltip-borehole"},Vo={class:"tooltip-name"},Jo={class:"tooltip-coords"},jo={class:"tooltip-value"},Go={class:"tooltip-label"},Qo={class:"tooltip-number"},Ko={__name:"ContourMap",props:{imageUrl:{type:String,default:""},boreholes:{type:Array,default:()=>[]},bounds:{type:Object,default:()=>({})},property:{type:String,default:"thickness"},propertyLabel:{type:String,default:"厚度"},valueRange:{type:Object,default:()=>({min:0,max:10})},colormap:{type:String,default:"YlOrBr"},crossSectionMode:{type:Boolean,default:!1}},emits:["crossSectionChange","crossSectionComplete"],setup(N,{expose:K,emit:I}){const P=N,Se=I,de=x(null),ge=x(800),ae=x(600),ce=x(!1),be=x(null),B=x(1),Ce=x(0),X=x(0),ee=x(!1),E=x(!1),U=x({x:0,y:0}),Pe=x(null),ve=x(null),Ae=x({x:0,y:0}),Te=x(!0),y=x({start:null,end:null,distance:null}),Z=x(null),me=Ne(()=>{if(P.bounds&&P.bounds.min_x!==void 0)return{minX:P.bounds.min_x,maxX:P.bounds.max_x,minY:P.bounds.min_y,maxY:P.bounds.max_y,rangeX:P.bounds.max_x-P.bounds.min_x,rangeY:P.bounds.max_y-P.bounds.min_y};if(P.boreholes.length===0)return null;let a=1/0,c=-1/0,p=1/0,w=-1/0;return P.boreholes.forEach($=>{$.x<a&&(a=$.x),$.x>c&&(c=$.x),$.y<p&&(p=$.y),$.y>w&&(w=$.y)}),{minX:a,maxX:c,minY:p,maxY:w,rangeX:c-a,rangeY:w-p}}),Ie=Ne(()=>{if(!me.value||P.boreholes.length===0)return[];if(!ce.value||!P.imageUrl)return[];const a=me.value,c=ge.value,p=ae.value;if(!Number.isFinite(c)||!Number.isFinite(p)||c<=0||p<=0)return[];if(!Number.isFinite(a.rangeX)||!Number.isFinite(a.rangeY)||a.rangeX<=0||a.rangeY<=0)return[];const w=c*.1,$=c*(1-.1-.85),se=p*.1,he=p*(1-.1-.8),xe=c-w-$,S=p-se-he;return P.boreholes.map(ie=>{var vt,mt;const Me=(vt=ie.x)!=null?vt:ie.borehole_x,Fe=(mt=ie.y)!=null?mt:ie.borehole_y;if(Me==null||Fe==null)return null;const Xe=(Me-a.minX)/a.rangeX,dt=(Fe-a.minY)/a.rangeY,_t=w+Xe*xe,wt=p-se-dt*S;return ft(ht({},ie),{x:Me,y:Fe,canvasX:Math.round(_t*10)/10,canvasY:Math.round(wt*10)/10,color:Ee(ie[P.property]||ie.thickness||ie.burial_depth)})}).filter(ie=>ie!==null)}),Ee=a=>{var $,se;if(a==null)return"#3b82f6";const c=(($=P.valueRange)==null?void 0:$.min)||0,p=((se=P.valueRange)==null?void 0:se.max)||1,w=Math.max(0,Math.min(1,(a-c)/(p-c||1)));return P.colormap==="YlOrBr"?Ze(w,[{t:0,r:255,g:255,b:204},{t:.25,r:255,g:230,b:153},{t:.5,r:255,g:190,b:121},{t:.75,r:230,g:140,b:80},{t:1,r:160,g:80,b:50}]):Ze(w,[{t:0,r:68,g:1,b:84},{t:.25,r:59,g:82,b:139},{t:.5,r:33,g:154,b:141},{t:.75,r:94,g:201,b:98},{t:1,r:253,g:231,b:37}])},Ze=(a,c)=>{let p=c[0],w=c[c.length-1];for(let S=0;S<c.length-1;S++)if(a>=c[S].t&&a<=c[S+1].t){p=c[S],w=c[S+1];break}const $=w.t!==p.t?(a-p.t)/(w.t-p.t):0,se=Math.round(p.r+(w.r-p.r)*$),he=Math.round(p.g+(w.g-p.g)*$),xe=Math.round(p.b+(w.b-p.b)*$);return`rgb(${se}, ${he}, ${xe})`},De=Ne(()=>({transform:`scale(${B.value}) translate(${Ce.value/B.value}px, ${X.value/B.value}px)`,transformOrigin:"center center",transition:ee.value?"none":"transform 0.1s ease-out"})),nt=Ne(()=>({position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) scale(${B.value}) translate(${Ce.value/B.value}px, ${X.value/B.value}px)`,transformOrigin:"center center",pointerEvents:"none",transition:ee.value?"none":"transform 0.1s ease-out",maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"})),at=Ne(()=>({left:Ae.value.x+15+"px",top:Ae.value.y+15+"px"})),et=Ne(()=>P.colormap==="YlOrBr"?"background: linear-gradient(to right, #fffacc, #ffe699, #ffbe79, #e68c50, #a05032)":"background: linear-gradient(to right, #440154, #3b528b, #21918c, #5ec962, #fde725)"),tt=Ne(()=>{var p,w;const a=Number((p=P.valueRange)==null?void 0:p.min),c=Number((w=P.valueRange)==null?void 0:w.max);return!Number.isFinite(a)||!Number.isFinite(c)?0:(a+c)/2}),yt=a=>{ge.value=a.target.naturalWidth,ae.value=a.target.naturalHeight,ce.value=!0,be.value=null},qe=a=>{var c;be.value="图片加载失败，请检查数据",ce.value=!1,console.error("Image load error:",a,((c=P.imageUrl)==null?void 0:c.substring(0,50))+"...")},He=()=>{B.value=Math.min(B.value*1.2,3)},it=()=>{B.value=Math.max(B.value/1.2,.5)},je=()=>{B.value=1,Ce.value=0,X.value=0},bt=()=>{y.value={start:null,end:null,distance:null},Z.value=null,Se("crossSectionChange",null)},Ge=(a,c)=>{if(!de.value)return null;const p=de.value.getBoundingClientRect(),w=p.width/2,$=p.height/2,se=(a-w-Ce.value)/B.value+w,he=(c-$-X.value)/B.value+$,xe=(p.width-ge.value)/2,S=(p.height-ae.value)/2;return{x:se-xe,y:he-S}},Qe=(a,c)=>{if(!me.value)return null;const p=ge.value,w=ae.value,$=p*.1,se=p*(1-.1-.85),he=w*.1,xe=w*(1-.1-.8),S=p-$-se,ie=w-he-xe,Me=me.value,Fe=Me.minX+(a-$)/S*Me.rangeX,Xe=Me.minY+(w-c-he)/ie*Me.rangeY;return{x:Fe,y:Xe}},xt=a=>{var c,p;if(!(a.pointerType!=="touch"&&a.button!==0))if(Pe.value=a.pointerId,(p=(c=de.value)==null?void 0:c.setPointerCapture)==null||p.call(c,a.pointerId),P.crossSectionMode){const w=Ge(a.clientX,a.clientY);if(!w)return;if(!y.value.start)y.value.start=w,E.value=!0;else if(y.value.end)y.value={start:w,end:null,distance:null},E.value=!0;else{y.value.end=w,E.value=!1;const $=Qe(w.x,w.y),se=Qe(y.value.start.x,y.value.start.y);if($&&se){const he=Math.sqrt(fe(se.x-$.x,2)+fe(se.y-$.y,2));y.value.distance=he}Z.value=null,Se("crossSectionComplete",{start:Qe(y.value.start.x,y.value.start.y),end:Qe(y.value.end.x,y.value.end.y),startCanvas:y.value.start,endCanvas:y.value.end,distance:y.value.distance})}Se("crossSectionChange",y.value)}else ee.value=!0,U.value={x:a.clientX-Ce.value,y:a.clientY-X.value}},rt=a=>{var c,p;Pe.value!==null&&a.pointerId!==Pe.value||(Pe.value=null,(p=(c=de.value)==null?void 0:c.releasePointerCapture)==null||p.call(c,a.pointerId),ee.value=!1)},kt=a=>{if(de.value){if(de.value.getBoundingClientRect(),P.crossSectionMode&&E.value){const c=Ge(a.clientX,a.clientY);c&&(Z.value=c),Ae.value={x:a.clientX,y:a.clientY};return}if(ee.value){Ce.value=a.clientX-U.value.x,X.value=a.clientY-U.value.y;return}a.pointerType!=="touch"&&(Ae.value={x:a.clientX,y:a.clientY})}},ct=()=>{ee.value||(ve.value=null)},ut=a=>{a.preventDefault();const c=a.deltaY>0?.9:1.1;B.value=Math.max(.5,Math.min(3,B.value*c))};return so(()=>P.imageUrl,()=>{je(),ce.value=!1,be.value=null}),K({resetView:je,resetCrossSection:bt,boreholes:Ie,crossSectionLine:y}),(a,c)=>{var p,w,$,se,he,xe;return m(),f("div",{class:Je(["contour-map-wrapper",{"cross-section-mode":N.crossSectionMode}])},[o("div",{ref_key:"imageContainer",ref:de,class:"image-container",onPointerdown:xt,onPointermove:kt,onPointerup:rt,onPointercancel:rt,onPointerleave:ct,onWheel:Dt(ut,["prevent"]),onContextmenu:c[0]||(c[0]=Dt(()=>{},["prevent"]))},[be.value?(m(),f("div",wo,[c[3]||(c[3]=o("p",null,"⚠️ 图片加载失败",-1)),o("p",So,h(be.value),1),c[4]||(c[4]=o("p",{class:"error-hint"},"请检查后端服务是否正常运行",-1))])):N.imageUrl?(m(),f("img",{key:2,src:N.imageUrl,class:"contour-image",style:st(De.value),alt:"Contour Map",loading:"lazy",decoding:"async",onLoad:yt,onError:qe},null,44,To)):(m(),f("div",Co,[...c[5]||(c[5]=[o("div",{class:"spinner"},null,-1),o("p",null,"正在生成等值线图...",-1)])]))],544),N.imageUrl?(m(),f("svg",{key:0,class:"borehole-overlay",viewBox:`0 0 ${ge.value} ${ae.value}`,style:st(nt.value),preserveAspectRatio:"xMidYMid meet"},[c[7]||(c[7]=o("defs",null,[o("filter",{id:"shadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},[o("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2","flood-opacity":"0.3"})]),o("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto"},[o("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#f59e0b"})])],-1)),y.value.start&&y.value.end?(m(),f("g",Fo,[o("line",{x1:y.value.start.x,y1:y.value.start.y,x2:y.value.end.x,y2:y.value.end.y,stroke:"#f59e0b","stroke-width":"3","stroke-dasharray":"8,4","marker-end":"url(#arrowhead)",class:"cross-section-line"},null,8,Po),o("circle",{cx:y.value.start.x,cy:y.value.start.y,r:"8",fill:"#f59e0b",stroke:"white","stroke-width":"2",class:"cross-section-marker"},null,8,$o),o("text",{x:y.value.start.x,y:y.value.start.y-15,fill:"#f59e0b","font-size":"14","font-weight":"bold","text-anchor":"middle"},"A",8,Ao),o("circle",{cx:y.value.end.x,cy:y.value.end.y,r:"8",fill:"#f59e0b",stroke:"white","stroke-width":"2",class:"cross-section-marker"},null,8,Ro),o("text",{x:y.value.end.x,y:y.value.end.y-15,fill:"#f59e0b","font-size":"14","font-weight":"bold","text-anchor":"middle"},"A'",8,Bo),o("text",{x:(y.value.start.x+y.value.end.x)/2,y:(y.value.start.y+y.value.end.y)/2-15,fill:"white","font-size":"12","text-anchor":"middle",class:"distance-label"},h((p=y.value.distance)==null?void 0:p.toFixed(0))+"m",9,Wo)])):H("",!0),N.crossSectionMode&&y.value.start&&Z.value?(m(),f("line",{key:1,x1:y.value.start.x,y1:y.value.start.y,x2:Z.value.x,y2:Z.value.y,stroke:"rgba(245, 158, 11, 0.5)","stroke-width":"2","stroke-dasharray":"4,4"},null,8,No)):H("",!0),Te.value?(m(!0),f(Oe,{key:2},Ve(Ie.value,(S,ie)=>(m(),f("g",{key:ie,transform:`translate(${S.canvasX}, ${S.canvasY})`,class:"borehole-marker",onMouseenter:Me=>ve.value=ft(ht({},S),{isBorehole:!0}),onMouseleave:c[1]||(c[1]=Me=>ve.value=null)},[c[6]||(c[6]=o("circle",{r:"9",fill:"rgba(255,255,255,0.95)",filter:"url(#shadow)"},null,-1)),o("circle",{r:"6",fill:S.color||"#3b82f6",stroke:"#1e3a8a","stroke-width":"1.5"},null,8,Eo)],40,Io))),128)):H("",!0)],12,Mo)):H("",!0),o("div",Do,[o("button",{class:"control-btn",onClick:He,title:"放大"},[...c[8]||(c[8]=[o("span",null,"+",-1)])]),o("button",{class:"control-btn",onClick:it,title:"缩小"},[...c[9]||(c[9]=[o("span",null,"−",-1)])]),o("button",{class:"control-btn",onClick:je,title:"重置"},[...c[10]||(c[10]=[o("span",null,"⟲",-1)])]),o("button",{class:Je(["control-btn",{active:Te.value}]),onClick:c[2]||(c[2]=S=>Te.value=!Te.value),title:"显示或隐藏钻孔点"},[...c[11]||(c[11]=[o("span",null,"◉",-1)])],2)]),N.valueRange?(m(),f("div",Yo,[o("div",Lo,h(N.propertyLabel),1),o("div",Xo,[o("span",zo,h((w=N.valueRange.min)==null?void 0:w.toFixed(2))+"m",1),o("div",qo,[o("div",{class:"legend-gradient",style:st(et.value)},null,4)]),o("span",Ho,h(($=N.valueRange.max)==null?void 0:$.toFixed(2))+"m",1)]),o("div",Uo,"中值 "+h(tt.value.toFixed(2))+" m",1)])):H("",!0),ve.value?(m(),f("div",{key:2,class:"hover-tooltip",style:st(at.value)},[ve.value.isBorehole?(m(),f("div",Oo,[o("div",Vo,h(ve.value.name||ve.value.borehole),1),o("div",Jo,"("+h((se=ve.value.x)==null?void 0:se.toFixed(1))+", "+h((he=ve.value.y)==null?void 0:he.toFixed(1))+")",1),o("div",jo,[o("span",Go,h(N.propertyLabel)+":",1),o("span",Qo,h((xe=ve.value.value)==null?void 0:xe.toFixed(2))+" m",1)])])):H("",!0)],4)):H("",!0)],2)}}},Lt=zt(Ko,[["__scopeId","data-v-c959f615"]]),Zo={class:"page"},el={class:"header"},tl={class:"muted"},ol={key:0,class:"header-stats"},ll={class:"stat-badge"},sl={class:"stat-badge primary"},nl={class:"stat-badge"},al={key:0,class:"card"},il={class:"seam-selection-grid"},rl=["onClick"],cl={class:"seam-card-header"},ul={class:"seam-name"},dl={class:"seam-count"},vl={class:"seam-card-stats"},ml={class:"mini-stat"},hl={class:"mini-stat-value"},fl={class:"mini-stat"},gl={class:"mini-stat-value"},pl={key:1,class:"grid"},yl={class:"card params-card compact-card"},bl={class:"param-row"},xl={class:"tab-buttons"},kl=["onClick"],_l={class:"param-row"},wl={class:"param-header"},Sl={class:"param-value"},Cl={class:"param-row"},Tl={class:"param-header"},Ml={class:"param-value"},Fl={class:"param-row"},Pl={class:"tab-buttons quality-tabs"},$l=["onClick"],Al={key:0,class:"param-row"},Rl={class:"toggle-btn",style:{width:"100%"}},Bl={key:0,class:"hint-text"},Wl={class:"action-buttons"},Nl=["disabled"],Il={key:0,class:"spinner sm"},El={key:1,class:"status-text"},Dl={key:2,class:"geomodel-panel"},Yl={class:"geomodel-head"},Ll={key:0,class:"geomodel-jobid"},Xl={class:"geomodel-controls"},zl=["value"],ql={class:"geomodel-range"},Hl=["disabled"],Ul={key:0,class:"geomodel-status"},Ol={key:0},Vl={key:1},Jl={key:1,class:"geomodel-error"},jl={key:2,class:"geomodel-summary"},Gl={class:"summary-item"},Ql={class:"summary-item"},Kl={class:"summary-item"},Zl={key:3,class:"geomodel-files"},es=["onClick"],ts={class:"card compact-card"},os={key:0,class:"histogram-wrapper"},ls={key:1,class:"empty-state"},ss={key:2,class:"stats-grid"},ns={class:"stat-item"},as={class:"stat-value"},is={class:"stat-item"},rs={class:"stat-value"},cs={class:"stat-item"},us={class:"stat-value"},ds={class:"stat-item"},vs={class:"stat-value"},ms={class:"stat-item"},hs={class:"stat-value"},fs={class:"stat-item"},gs={class:"stat-value"},ps={class:"card compact-card"},ys={class:"stratigraphic-wrapper"},bs={class:"lithology-legend-compact"},xs={class:"legend-name"},ks={key:0,class:"map-row"},_s={class:"card map-card-large"},ws={class:"map-header"},Ss={key:0,class:"section-desc"},Cs={key:1,class:"section-desc"},Ts={class:"map-wrapper"},Ms={key:0,class:"spinner"},Fs={class:"card map-card-large"},Ps={class:"map-header"},$s={key:0,class:"section-desc"},As={key:1,class:"section-desc"},Rs={class:"map-wrapper"},Bs={key:0,class:"spinner"},Ws={key:1,class:"card map-card-full"},Ns={class:"map-wrapper uncertainty-wrapper"},Is={key:0,class:"spinner"},Es={key:2,class:"card map-card-full"},Ds={class:"map-header"},Ys={class:"section-title"},Ls={class:"section-badge"},Xs={class:"cross-section-wrapper"},Xt="interpolation:lastContour:v1",zs={__name:"Interpolation",setup(N,{expose:K}){const I=uo(),P=ro(),Se=co(),{workspaceState:de,setSelectedSeam:ge,markStepDone:ae}=vo(),ce=x(!1),be=x(null),B=x(!1),Ce=x([]),X=x(null),ee=x(null),E=x([]),U=x([]),Pe=x("kriging"),ve=x(80),Ae=x(10),Te=x("standard"),y=x(""),Z=x(null),me=x(null),Ie=x(!1),Ee=x({line:null,points:[],depthProfile:[],distance:null,hasData:!1}),Ze=x(null),De=x(null),nt=x(null),at=x(null),et=x("thickness"),tt=x(20),yt=[{key:"thickness",label:"厚度建模"},{key:"hybrid",label:"混合建模"},{key:"regression_kriging",label:"回归克里金"},{key:"smart_pinchout",label:"智能尖灭"}],{jobId:qe,job:He,artifacts:it,loading:je,polling:bt,error:Ge,submit:Qe,refresh:xt}=_o(),rt=[{key:"kriging",label:"Kriging"},{key:"idw",label:"IDW"},{key:"linear",label:"Linear"},{key:"nearest",label:"Nearest"}],kt=[{key:"fast",label:"快速"},{key:"standard",label:"标准"},{key:"high",label:"高精"}],ct={fast:{dpi:120,smoothSigma:.75,label:"快速"},standard:{dpi:200,smoothSigma:1.15,label:"标准"},high:{dpi:300,smoothSigma:1.35,label:"高精"}},ut={fast:72,standard:96,high:128},a={textColor:"#111827",subTextColor:"#475569",axisColor:"#1f2937",gridColor:"rgba(148, 163, 184, 0.28)",fontFamily:"'Helvetica Neue', Arial, 'PingFang SC', 'Microsoft YaHei', sans-serif",monoFamily:"'JetBrains Mono', 'SFMono-Regular', Consolas, monospace"};let c=0,p=0,w=null,$=null;const se={细砂岩:"#FCEBB6",粉砂岩:"#E0FFFF",泥岩:"#D3D3D3",中砂岩:"#FCEBB6",粗砂岩:"#F5DEB3",砾岩:"#DEB887",炭质泥岩:"#8B8B8B",砂质泥岩:"#D8D8D8",泥质砂岩:"#E8E8E8",石灰岩:"#B0E0E6",煤:"#2F4F4F"},he={细砂岩:{facecolor:"#FCEBB6",hatch:"...",edgecolor:"#999999"},粉砂岩:{facecolor:"#E0FFFF",hatch:"...",edgecolor:"#AAAAAA"},泥岩:{facecolor:"#D3D3D3",hatch:"---",edgecolor:"#666666"},中砂岩:{facecolor:"#FCEBB6",hatch:"...",edgecolor:"#999999"},粗砂岩:{facecolor:"#F5DEB3",hatch:"...",edgecolor:"#999999"},砾岩:{facecolor:"#DEB887",hatch:"ooo",edgecolor:"#8B4513"},炭质泥岩:{facecolor:"#8B8B8B",hatch:"---",edgecolor:"#444444"},砂质泥岩:{facecolor:"#D8D8D8",hatch:"-..",edgecolor:"#777777"},泥质砂岩:{facecolor:"#E8E8E8",hatch:".-.",edgecolor:"#888888"},石灰岩:{facecolor:"#B0E0E6",hatch:"+++",edgecolor:"#5F9EA0"},煤:{facecolor:"#2F4F4F",hatch:"",edgecolor:"#1a1a1a"}},xe=t=>({kriging:"Kriging",idw:"IDW",linear:"Linear",nearest:"Nearest"})[t]||t,S=(t,e=400,r=!1)=>{const n=r?a.monoFamily:a.fontFamily;return`${e} ${t}px ${n}`},ie=t=>{t.imageSmoothingEnabled=!0,"imageSmoothingQuality"in t&&(t.imageSmoothingQuality="high"),t.lineCap="round",t.lineJoin="round"},Me=Ne(()=>E.value.map(t=>Number(t.thickness)).filter(t=>Number.isFinite(t))),Fe=Ne(()=>{const t=Me.value,e=t.length;if(!e)return{count:0,mean:0,stdDev:0,cv:0,min:0,max:0};const r=t.reduce((s,b)=>s+b,0)/e,n=t.reduce((s,b)=>s+fe(b-r,2),0)/e,g=Math.sqrt(n),l=Math.min(...t),i=Math.max(...t),u=r>0?g/r*100:0;return{count:e,mean:r,stdDev:g,cv:u,min:l,max:i}}),Xe=Ne(()=>{var t,e;return((e=(t=He.value)==null?void 0:t.result_manifest)==null?void 0:e.quality_summary)||null}),dt=t=>{var e,r;E.value=(t==null?void 0:t.boreholes)||E.value,(e=t==null?void 0:t.thickness)!=null&&e.image?Z.value={imageUrl:`data:image/png;base64,${t.thickness.image}`,valueRange:t.thickness.value_range,bounds:t.bounds}:Z.value=null,(r=t==null?void 0:t.depth)!=null&&r.image?me.value={imageUrl:`data:image/png;base64,${t.depth.image}`,valueRange:t.depth.value_range,bounds:t.bounds}:me.value=null},_t=t=>{var e;if(typeof window=="undefined")return null;try{const r=window.sessionStorage.getItem(Xt);if(!r)return null;const n=JSON.parse(r);return!(n!=null&&n.seamName)||n.seamName!==t||!((e=n==null?void 0:n.data)!=null&&e.bounds)?null:n}catch(r){return null}},wt=(t,e)=>{if(typeof window!="undefined")try{const r={seamName:t,updatedAt:Date.now(),method:Pe.value,gridSize:ve.value,contourLevels:Ae.value,quality:Te.value,data:{bounds:(e==null?void 0:e.bounds)||null,boreholes:(e==null?void 0:e.boreholes)||[],thickness:(e==null?void 0:e.thickness)||null,depth:(e==null?void 0:e.depth)||null}};window.sessionStorage.setItem(Xt,JSON.stringify(r))}catch(r){}},vt=()=>$e(this,null,function*(){ce.value=!0;try{const{data:t}=yield go();Ce.value=t.seams||[]}catch(t){be.value="加载煤层失败"}finally{ce.value=!1}}),mt=(t=[])=>{let e=0;return t.map(r=>{var i,u;const n=Number((i=r.thickness)!=null?i:0)||0;let g=Number(r.z_top),l=Number(r.z_bottom);if(Number.isFinite(g)||(g=e),Number.isFinite(l)||(l=g+n),!Number.isFinite(n)||n===0){const s=Math.max((l||0)-(g||0),0);s>0&&(r.thickness=s)}return e=l,ft(ht({},r),{thickness:Number((u=r.thickness)!=null?u:n)||0,z_top:g,z_bottom:l})})},Mt=t=>$e(this,null,function*(){var r,n;const e=++p;X.value=t,ge((t==null?void 0:t.name)||""),Z.value=null,me.value=null,U.value=[],y.value="";try{const g=_t(t.name);g!=null&&g.data&&(dt(g.data),y.value="已加载上次缓存结果，正在后台刷新...",yield pt(),Pt());const l=po(t.name),i=yo(t.name).catch(()=>null),{data:u}=yield l;if(e!==p)return;ee.value=u,E.value=u.points||[],yield pt(),$t(),ae("Interpolation",{interpolationPoints:E.value.length||0}),Ft({presetKey:"fast",forceRefresh:!1,silent:!0,autoMode:!0}),$e(this,null,function*(){var M;const s=yield i;if(e!==p)return;const b=((M=s==null?void 0:s.data)==null?void 0:M.boreholes)||[],R=b.reduce((A,Q)=>{var j,z;const G=((j=A==null?void 0:A.layers)==null?void 0:j.length)||0;return(((z=Q==null?void 0:Q.layers)==null?void 0:z.length)||0)>G?Q:A},b[0]),T=mt((R==null?void 0:R.layers)||[]);U.value=T.sort((A,Q)=>(A.z_top||0)-(Q.z_top||0)),yield pt(),Ut()})}catch(g){if(e!==p)return;I.add("加载煤层详情失败: "+(((n=(r=g.response)==null?void 0:r.data)==null?void 0:n.detail)||g.message),"error")}}),qt=()=>$e(this,null,function*(){var t;if(!((t=X.value)!=null&&t.name)){I.add("请先选择煤层后再发起建模任务","warning");return}try{yield Qe({method:et.value,seam_name:X.value.name,resolution:tt.value,output_formats:["vtk","vtp","summary","quality"]}),I.add("建模任务已提交，正在后台计算","success")}catch(e){I.add(Ge.value||"建模任务提交失败","error")}}),Ht=t=>$e(this,null,function*(){var e,r;if(qe.value)try{const n=yield xo(qe.value,t),g=new Blob([n.data],{type:"application/octet-stream"}),l=URL.createObjectURL(g),i=document.createElement("a");i.href=l,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(l)}catch(n){I.add(((r=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:r.detail)||"下载产物失败","error")}}),Ft=(...e)=>$e(this,[...e],function*(t={}){var b,R,T;if(!X.value)return;const{presetKey:r=Te.value,forceRefresh:n=!1,silent:g=!1,autoMode:l=!1}=t,i=ct[r]||ct.standard,u=X.value.name,s=++c;B.value=!0,y.value=l?`正在生成${i.label}预览图...`:`正在渲染${i.label}质量结果...`;try{const{data:M}=yield bo(u,Pe.value,ve.value,Ae.value,i.dpi,i.smoothSigma,{forceRefresh:n});if(s!==c)return;dt(M),wt(u,M),yield pt(),Pt(),$t(),ae("Interpolation",{interpolationPoints:E.value.length||0}),g||I.add("等值线图生成完成","success")}catch(M){console.error("Interpolate error:",M),console.error("Error response:",(b=M.response)==null?void 0:b.data),I.add(((T=(R=M.response)==null?void 0:R.data)==null?void 0:T.detail)||"生成等值线图失败","error")}finally{s===c&&(B.value=!1,y.value="")}}),Pt=()=>{if(typeof window=="undefined"){St();return}if(typeof window.cancelIdleCallback=="function"&&w!==null&&(window.cancelIdleCallback(w),w=null),$!==null&&(window.clearTimeout($),$=null),typeof window.requestIdleCallback=="function"){w=window.requestIdleCallback(()=>{w=null,St()},{timeout:240});return}$=window.setTimeout(()=>{$=null,St()},16)},St=()=>{var L,_e;if(!E.value.length||!Z.value)return;const t=at.value;if(!t)return;const e=t.getContext("2d");if(!e)return;const r=(L=t.parentElement)==null?void 0:L.getBoundingClientRect(),n=Math.max(720,Math.floor((r==null?void 0:r.width)||900)),g=Math.max(420,Math.floor((r==null?void 0:r.height)||550)),l=typeof window!="undefined"&&window.devicePixelRatio||1;t.width=Math.floor(n*l),t.height=Math.floor(g*l),t.style.width=`${n}px`,t.style.height=`${g}px`,e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),e.setTransform(l,0,0,l,0,0),ie(e);const i=n,u=g,s=Z.value.bounds;if(!(s&&Number.isFinite(s.min_x)&&Number.isFinite(s.max_x)&&Number.isFinite(s.min_y)&&Number.isFinite(s.max_y)&&s.max_x>s.min_x&&s.max_y>s.min_y))return;const R=E.value.map(F=>({x:Number(F.x),y:Number(F.y)})).filter(F=>Number.isFinite(F.x)&&Number.isFinite(F.y));if(R.length===0)return;e.fillStyle="#ffffff",e.fillRect(0,0,i,u);const T={left:56,right:48,top:26,bottom:76},M=i-T.left-T.right-58,A=u-T.top-T.bottom,Q=Math.max(30,Number(ve.value)||80),G=ut[Te.value]||ut.standard,W=Math.max(64,Math.min(144,Math.round((Q+G)/2))),j=[],z=500;for(let F=0;F<W;F++){j[F]=[];for(let V=0;V<W;V++){const J=s.min_x+V/W*(s.max_x-s.min_x),Ye=s.max_y-F/W*(s.max_y-s.min_y);let Le=1/0;for(const ze of R){const Ke=Math.sqrt(fe(J-ze.x,2)+fe(Ye-ze.y,2));Ke<Le&&(Le=Ke)}j[F][V]=Math.min(1.6,Le/z*1.6)}}const te=[],q=Te.value==="high"?3:Te.value==="standard"?2.4:2,ue=Math.max(1,Math.ceil(q*2));for(let F=0;F<W;F++){te[F]=[];for(let V=0;V<W;V++){let J=0,Ye=0;for(let Le=-ue;Le<=ue;Le++)for(let ze=-ue;ze<=ue;ze++){const Ke=F+Le,Ct=V+ze;if(Ke>=0&&Ke<W&&Ct>=0&&Ct<W){const Bt=Math.sqrt(ze*ze+Le*Le),Wt=Math.exp(-(Bt*Bt)/(2*q*q)),Nt=(_e=j[Ke])==null?void 0:_e[Ct];if(!Number.isFinite(Nt))continue;J+=Nt*Wt,Ye+=Wt}}te[F][V]=Ye>0?J/Ye:j[F][V]}}const ke=F=>{const V=Math.min(1.5,Math.max(0,F))/1.5;if(V<.5){const J=V*2;return{r:Math.floor(49+206*J),g:Math.floor(130+125*J),b:Math.floor(189+-189*J)}}else{const J=(V-.5)*2;return{r:Math.floor(255+-40*J),g:Math.floor(255+-207*J),b:Math.floor(0+48*J)}}},O=M/W,le=A/W;for(let F=0;F<W;F++)for(let V=0;V<W;V++){const J=te[F][V],Ye=ke(J);e.fillStyle=`rgb(${Ye.r}, ${Ye.g}, ${Ye.b})`,e.fillRect(T.left+V*O,T.top+(W-1-F)*le,O+1,le+1)}const oe=6;for(const F of R){const V=T.left+(F.x-s.min_x)/(s.max_x-s.min_x)*M,J=T.top+(s.max_y-F.y)/(s.max_y-s.min_y)*A;e.beginPath(),e.arc(V,J,oe,0,Math.PI*2),e.fillStyle="#000000",e.fill()}e.strokeStyle="#000000",e.lineWidth=2,e.strokeRect(T.left,T.top,M,A);const d=T.left+20,D=T.top+A-80,k=120,v=50;e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=1.5,e.fillRect(d,D,k,v),e.strokeRect(d,D,k,v),e.fillStyle="#d73027",e.fillRect(d+10,D+28,15,15),e.strokeStyle="#000000",e.lineWidth=1,e.strokeRect(d+10,D+28,15,15),e.fillStyle=a.textColor,e.font=S(12),e.textAlign="left",e.fillText("高不确定性",d+32,D+40),e.beginPath(),e.arc(d+17,D+18,oe,0,Math.PI*2),e.fillStyle="#000000",e.fill(),e.fillText("钻孔位置",d+32,D+22);const C=T.left+M-150,Y=D,re=130,pe=35;e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=1.5,e.fillRect(C,Y,re,pe),e.strokeRect(C,Y,re,pe),e.fillStyle=a.textColor,e.font=S(11),e.textAlign="left",e.fillText("0",C+10,Y+22),e.textAlign="center",e.fillText("500",C+75,Y+22),e.textAlign="right",e.fillText("1000 米",C+120,Y+22);const Re=Y+12;e.strokeStyle="#000000",e.lineWidth=2,e.beginPath(),e.moveTo(C+10,Re),e.lineTo(C+120,Re),e.stroke(),e.lineWidth=4,e.beginPath(),e.moveTo(C+10,Re),e.lineTo(C+75,Re),e.stroke();const ne=T.left+M+20,ye=T.top,Be=20,We=A;for(let F=0;F<We;F++){const V=(1-F/We)*1.5,J=ke(V);e.fillStyle=`rgb(${J.r}, ${J.g}, ${J.b})`,e.fillRect(ne,ye+F,Be,1)}e.strokeStyle="#000000",e.lineWidth=1.5,e.strokeRect(ne,ye,Be,We),e.fillStyle=a.subTextColor,e.font=S(10),e.textAlign="left";const Ue=[0,.5,1,1.5],_=["0","0.5","1.0","1.5+"];Ue.forEach((F,V)=>{const J=ye+We-F/1.5*We;e.beginPath(),e.moveTo(ne+Be,J),e.lineTo(ne+Be+4,J),e.strokeStyle="#000000",e.lineWidth=1,e.stroke(),e.fillText(_[V],ne+Be+8,J+4)}),e.save(),e.translate(ne+Be+35,ye+We/2),e.rotate(-Math.PI/2),e.textAlign="center",e.font=S(11,500),e.fillText("不确定性 (归一化)",0,0),e.restore(),e.fillStyle=a.textColor,e.font=S(13,700),e.textAlign="center",e.fillText("Fig. 3 | 插值不确定性分布",T.left+M/2,u-28),e.fillStyle=a.subTextColor,e.font=S(10),e.fillText("红色区域表示较高不确定性，蓝色区域表示相对可靠。",T.left+M/2,u-12)},$t=()=>{var We,Ue;const t=Ze.value;if(!t||E.value.length===0)return;const e=t.getContext("2d");if(!e)return;const r=window.devicePixelRatio||1,n=t.parentElement,g=(n==null?void 0:n.clientWidth)||t.clientWidth||500,l=(n==null?void 0:n.clientHeight)||t.clientHeight||350;t.width=Math.round(g*r),t.height=Math.round(l*r),t.style.width=`${g}px`,t.style.height=`${l}px`,e.setTransform(r,0,0,r,0,0),ie(e);const i=g,u=l,s=E.value.map(_=>Number(_.thickness)).filter(_=>Number.isFinite(_));if(s.length===0)return;const b=Math.min(...s),R=Math.max(...s),T=s.reduce((_,L)=>_+L,0)/s.length,M=s.reduce((_,L)=>_+fe(L-T,2),0)/s.length,A=Math.sqrt(M),Q=R-b,G=[...s].sort((_,L)=>_-L),W=(We=G[Math.floor((G.length-1)*.25)])!=null?We:b,j=(Ue=G[Math.floor((G.length-1)*.75)])!=null?Ue:R,z=Math.max(j-W,0),te=z>Number.EPSILON?2*z/Math.cbrt(G.length):0,q=te>0&&Q>0?Math.round(Q/te):16,ue=Math.max(10,Math.min(28,q||16)),ke=Q>0?Q/ue:1,O=Array(ue).fill(0);for(const _ of s){const L=Q>0?Math.floor((_-b)/ke):Math.floor(ue/2),_e=Math.max(0,Math.min(L,ue-1));O[_e]++}const le=Math.max(...O),oe="#5f8fb0",d="#c5523a",D=.85;e.fillStyle="#ffffff",e.fillRect(0,0,i,u);const k={left:50,right:25,top:45,bottom:45},v=i-k.left-k.right,C=u-k.top-k.bottom,Y=v/ue,re=C/(le*1.1);e.fillStyle=oe,e.globalAlpha=D;for(let _=0;_<ue;_++){const L=O[_]*re,_e=k.left+_*Y,F=u-k.bottom-L;L>0&&(e.fillRect(_e,F,Y-1,L),e.strokeStyle="white",e.lineWidth=.8,e.strokeRect(_e,F,Y-1,L))}e.globalAlpha=1;const pe=A>Number.EPSILON&&Q>0;if(pe){e.strokeStyle=d,e.lineWidth=2,e.beginPath();for(let _=0;_<=100;_++){const L=k.left+_/100*v,_e=b+_/100*Q,V=1/(A*Math.sqrt(2*Math.PI))*Math.exp(-.5*fe((_e-T)/A,2))*s.length*ke,J=u-k.bottom-V*re;_===0?e.moveTo(L,J):e.lineTo(L,J)}e.stroke()}e.strokeStyle=a.axisColor,e.lineWidth=1,e.beginPath(),e.moveTo(k.left,k.top),e.lineTo(k.left,u-k.bottom),e.stroke(),e.beginPath(),e.moveTo(k.left,u-k.bottom),e.lineTo(i-k.right,u-k.bottom),e.stroke();const Re=4;e.strokeStyle=a.axisColor,e.lineWidth=1;for(let _=0;_<=6;_++){const L=k.left+_/6*v;e.beginPath(),e.moveTo(L,u-k.bottom),e.lineTo(L,u-k.bottom+Re),e.stroke()}for(let _=0;_<=5;_++){const L=u-k.bottom-_/5*C;e.beginPath(),e.moveTo(k.left,L),e.lineTo(k.left-Re,L),e.stroke()}e.fillStyle=a.subTextColor,e.font=S(10),e.textAlign="center";for(let _=0;_<=6;_++){const L=b+_/6*(R-b),_e=k.left+_/6*v;e.fillText(L.toFixed(1),_e,u-k.bottom+15)}e.textAlign="right";for(let _=0;_<=5;_++){const L=Math.round(_/5*(le*1.1)),_e=u-k.bottom-_/5*C;e.fillText(L.toString(),k.left-6,_e+3)}e.fillStyle=a.subTextColor,e.font=S(11),e.textAlign="center",e.fillText("厚度 (m)",k.left+v/2,u-8),e.save(),e.translate(12,k.top+C/2),e.rotate(-Math.PI/2),e.fillText("频数",0,0),e.restore(),e.fillStyle=a.textColor,e.font=S(12,700),e.textAlign="left",e.fillText("Fig. 1 | 煤层厚度频率分布 (n="+s.length+")",k.left,18),e.fillStyle=a.textColor,e.font=S(10),e.textAlign="left";const ne=i-k.right-120,ye=k.top+10;e.fillStyle=oe,e.globalAlpha=D,e.fillRect(ne,ye-4,12,10),e.globalAlpha=1,e.strokeStyle="white",e.lineWidth=.8,e.strokeRect(ne,ye-4,12,10),e.fillText("观测值",ne+16,ye+4),pe&&(e.strokeStyle=d,e.lineWidth=2,e.beginPath(),e.moveTo(ne,ye+20),e.lineTo(ne+12,ye+20),e.stroke(),e.fillStyle="#000000",e.fillText("密度拟合",ne+16,ye+24)),e.fillStyle=a.subTextColor,e.font=S(9,400,!0),e.textAlign="left";const Be=`μ=${T.toFixed(2)}  σ=${A.toFixed(2)}`;e.fillText(Be,ne,ye+42)},Ut=()=>{const t=nt.value;if(!t||U.value.length===0)return;const e=t.getContext("2d"),r=window.devicePixelRatio||1,n=t.parentElement,g=(n==null?void 0:n.clientWidth)||t.clientWidth||280,l=(n==null?void 0:n.clientHeight)||t.clientHeight||500;t.width=Math.round(g*r),t.height=Math.round(l*r),t.style.width=`${g}px`,t.style.height=`${l}px`,e.setTransform(r,0,0,r,0,0),ie(e);const i=g,u=l;e.fillStyle="#FFFFFF",e.fillRect(0,0,i,u);const s=U.value;let b=Math.max(...s.map(O=>O.z_bottom||0));if((!Number.isFinite(b)||b<=0)&&(b=s.reduce((O,le)=>O+(Number(le.thickness)||0),0)),!Number.isFinite(b)||b<=0)return;const R={top:24,bottom:22},T=(u-R.top-R.bottom)/b,M=R.top,A=14,Q=Math.max(110,Math.min(160,i*.3)),G=Math.max(80,Math.min(140,i*.22)),W=A+G+16+Q,z=Math.max(16,(i-W)/2),te=z+A,q=te+G+16;e.fillStyle=a.textColor,e.font=S(12,700),e.textAlign="left",e.fillText("Fig. 2 | 代表性钻孔地层柱状图",te,18);const ue=4,ke=Math.max(5,Math.ceil(b/6/5)*5)||10;e.strokeStyle=a.gridColor,e.lineWidth=1,e.fillStyle=a.subTextColor,e.font=S(10),e.textAlign="right",e.beginPath(),e.moveTo(z,M),e.lineTo(z,u-R.bottom),e.stroke();for(let O=0;O<=b;O+=ke){const le=M+O*T;e.beginPath(),e.moveTo(z,le),e.lineTo(z+ue,le),e.stroke(),e.fillText(`${Math.round(O)} m`,z-6,le+3)}e.save(),e.translate(z-28,M+(u-R.bottom-M)/2),e.rotate(-Math.PI/2),e.textAlign="center",e.fillStyle=a.subTextColor,e.font=S(11),e.fillText("深度 (m)",0,0),e.restore(),s.forEach((O,le)=>{const oe=M+(O.z_top||0)*T,d=O.thickness||0,D=Math.max(d*T,3),k=he[O.name]||{facecolor:"#D3D3D3",hatch:"---",edgecolor:"#666666"};e.fillStyle=k.facecolor,e.fillRect(te,oe,G,D),D>6&&k.hatch&&Ot(e,k.hatch,te,oe,G,D,k.edgecolor),e.strokeStyle="#1a1a1a",e.lineWidth=.5,e.strokeRect(te,oe,G,D),D>10&&(e.fillStyle=a.subTextColor,e.font=S(10),e.textAlign="left",e.fillText(O.name,q,oe+D/2+3),e.fillStyle="#2563EB",e.font=S(9,500,!0),e.fillText(`${d.toFixed(1)}米`,q,oe+D/2+14))}),e.strokeStyle="#94A3B8",e.lineWidth=1,e.strokeRect(te,M,G,u-M-R.bottom)},Ot=(t,e,r,n,g,l,i)=>{t.save(),t.beginPath(),t.rect(r,n,g,l),t.clip(),t.strokeStyle=i,t.globalAlpha=.4,t.lineWidth=.5;const u=6;switch(e){case"...":case"ooo":t.fillStyle=i,t.globalAlpha=.3;for(let s=u/2;s<g;s+=u)for(let b=u/2;b<l;b+=u)t.beginPath(),e==="ooo"?t.arc(r+s,n+b,2.5,0,Math.PI*2):t.arc(r+s,n+b,1,0,Math.PI*2),t.fill();break;case"---":t.globalAlpha=.5;for(let s=4;s<l;s+=u)t.beginPath(),t.moveTo(r,n+s),t.lineTo(r+g,n+s),t.stroke();break;case"+++":case"xx":t.globalAlpha=.3;for(let s=u/2;s<g;s+=u)for(let b=u/2;b<l;b+=u)t.beginPath(),t.moveTo(r+s-3,n+b),t.lineTo(r+s+3,n+b),t.stroke(),t.beginPath(),t.moveTo(r+s,n+b-3),t.lineTo(r+s,n+b+3),t.stroke();break;case"-..":case".-.":t.globalAlpha=.5;for(let s=u;s<l;s+=u*1.5)t.beginPath(),t.moveTo(r,n+s),t.lineTo(r+g/2,n+s),t.stroke(),t.fillStyle=i,t.beginPath(),t.arc(r+g*.75,n+s,1.5,0,Math.PI*2),t.fill();break;case"//":case"\\\\":t.globalAlpha=.4;for(let s=-l;s<g;s+=u)t.beginPath(),t.moveTo(r+s,n),t.lineTo(r+s+l,n+l),t.stroke();break}t.restore()},At=t=>{Ee.value={line:{start:t.startCanvas,end:t.endCanvas},worldLine:{start:t.start,end:t.end},points:t.points||[],depthProfile:[],distance:t.distance,hasData:!0},Vt(t.start,t.end,t.distance)},Vt=(t,e,r)=>{if(!E.value.length||r===null)return;const n=De.value;if(!n)return;const g=n.getContext("2d");if(!g)return;const l=typeof window!="undefined"&&window.devicePixelRatio||1,i=Math.max(640,n.offsetWidth||900),u=300;n.width=Math.round(i*l),n.height=Math.round(u*l),n.style.width=`${i}px`,n.style.height=`${u}px`,g.setTransform(l,0,0,l,0,0);const s=100,b=(e.x-t.x)/s,R=(e.y-t.y)/s,T=[];for(let M=0;M<=s;M++){const A=t.x+b*M,Q=t.y+R*M,G=E.value.map(W=>{const j=Math.sqrt(fe(A-W.x,2)+fe(Q-W.y,2));return{depth:W.burial_depth,distance:j}}).filter(W=>W.depth!=null&&W.distance<500);if(G.length>0){let W=0,j=0;for(const z of G){const te=1/fe(z.distance+1,2);j+=z.depth*te,W+=te}T.push({distance:M/s*r,depth:j/W})}}Ee.value.depthProfile=T,Jt(T,r,i,u)},Jt=(t,e,r,n)=>{var D,k;const g=De.value;if(!g)return;const l=g.getContext("2d");if(!l)return;if(ie(l),l.fillStyle="#FFFFFF",l.fillRect(0,0,r,n),!t.length||!Number.isFinite(e)||e<=0){l.fillStyle=a.subTextColor,l.font=S(14),l.textAlign="center",l.fillText("当前剖面线附近缺少可用埋深数据，请重选剖面线。",r/2,n/2);return}const i={left:50,right:30,top:35,bottom:40},u=r-i.left-i.right,s=n-i.top-i.bottom,b=t.map(v=>v.depth),R=Math.min(...b),T=Math.max(...b),M=T-R||1,A={topSoil:"#8FBC8F",sandstone:"#F4A460",shale:"#778899",coal:"#2F2F2F",sandyShale:"#A9A9A9",limestone:"#B0C4DE"},G=s/6;[A.limestone,A.sandyShale,A.coal,A.shale,A.sandstone,A.topSoil].forEach((v,C)=>{const Y=i.top+C*G;l.fillStyle=v,l.globalAlpha=.08,l.fillRect(i.left,Y,u,G),l.globalAlpha=1}),l.strokeStyle=a.gridColor,l.lineWidth=.8;const j=10;for(let v=0;v<=j;v++){const C=i.left+v/j*u;l.beginPath(),l.moveTo(C,i.top),l.lineTo(C,n-i.bottom),l.stroke()}const z=5;for(let v=0;v<=z;v++){const C=i.top+v/z*s;l.beginPath(),l.moveTo(i.left,C),l.lineTo(r-i.right,C),l.stroke()}l.strokeStyle=a.axisColor,l.lineWidth=1,l.beginPath(),l.moveTo(i.left,i.top),l.lineTo(i.left,n-i.bottom),l.stroke(),l.beginPath(),l.moveTo(i.left,n-i.bottom),l.lineTo(r-i.right,n-i.bottom),l.stroke();const te=4;l.strokeStyle="rgba(148, 163, 184, 0.75)",l.lineWidth=1;for(let v=0;v<=j;v++){const C=i.left+v/j*u;l.beginPath(),l.moveTo(C,n-i.bottom),l.lineTo(C,n-i.bottom+te),l.stroke()}for(let v=0;v<=z;v++){const C=n-i.bottom-v/z*s;l.beginPath(),l.moveTo(i.left,C),l.lineTo(i.left-te,C),l.stroke()}l.beginPath(),l.strokeStyle=A.sandstone,l.lineWidth=2.5,l.lineCap="round",l.lineJoin="round";const q=t.map(v=>({x:i.left+v.distance/e*u,y:n-i.bottom-(v.depth-R)/M*s}));if(l.moveTo(q[0].x,q[0].y),q.length>2){for(let Y=1;Y<q.length-1;Y++){const re=(q[Y].x+q[Y+1].x)/2,pe=(q[Y].y+q[Y+1].y)/2;l.quadraticCurveTo(q[Y].x,q[Y].y,re,pe)}const v=q[q.length-1],C=q[q.length-2];l.quadraticCurveTo(C.x,C.y,v.x,v.y)}else q.length===2&&l.lineTo(q[1].x,q[1].y);l.stroke(),l.lineTo(i.left+u,n-i.bottom),l.lineTo(i.left,n-i.bottom),l.closePath(),l.fillStyle="rgba(244, 164, 96, 0.12)",l.fill();for(const v of E.value){if(v.burial_depth==null)continue;const C=v.x,Y=v.y,re=((D=Ee.value.worldLine)==null?void 0:D.start)||{x:0,y:0},pe=((k=Ee.value.worldLine)==null?void 0:k.end)||{x:0,y:0},Re=Math.sqrt(fe(pe.x-re.x,2)+fe(pe.y-re.y,2));if(Re===0)continue;const ne=((C-re.x)*(pe.x-re.x)+(Y-re.y)*(pe.y-re.y))/fe(Re,2),ye=re.x+ne*(pe.x-re.x),Be=re.y+ne*(pe.y-re.y);if(Math.sqrt(fe(C-ye,2)+fe(Y-Be,2))<50&&ne>=0&&ne<=1){const Ue=i.left+ne*u,_=n-i.bottom-(v.burial_depth-R)/M*s;l.beginPath(),l.arc(Ue,_,4,0,Math.PI*2),l.fillStyle=A.coal,l.fill(),l.strokeStyle="#ffffff",l.lineWidth=1.5,l.stroke(),l.fillStyle=a.subTextColor,l.font=S(10),l.textAlign="center";const L=v.borehole||v.name||"";L&&l.fillText(L,Ue,_-10)}}l.fillStyle=a.subTextColor,l.font=S(11),l.textAlign="center";for(let v=0;v<=j;v++){const C=i.left+v/j*u,Y=v/j*e;l.fillText(`${Y.toFixed(0)}`,C,n-15)}l.textAlign="right";for(let v=0;v<=z;v++){const C=n-i.bottom-v/z*s,Y=R+v/z*M;l.fillText(`${Y.toFixed(0)}`,i.left-8,C+4)}l.fillStyle=a.subTextColor,l.font=S(12),l.textAlign="center",l.fillText("剖面距离 (米)",i.left+u/2,n-5),l.save(),l.translate(12,i.top+s/2),l.rotate(-Math.PI/2),l.fillText("埋藏深度 (米)",0,0),l.restore(),l.fillStyle=a.textColor,l.font=S(13,700),l.textAlign="left",l.fillText(`Fig. 4 | 剖面 A-A' 深度分布 (${R.toFixed(1)}-${T.toFixed(1)} m)`,i.left,18);const ue=Math.max(10,e/4),ke=[10,20,50,100,200,500,1e3];let O=ke[0];for(const v of ke)v<=ue&&(O=v);const le=Math.max(34,Math.min(110,O/e*u)),oe=r-i.right-le-16,d=n-i.bottom+12;l.strokeStyle=a.axisColor,l.lineWidth=2,l.beginPath(),l.moveTo(oe,d),l.lineTo(oe+le,d),l.stroke(),l.beginPath(),l.moveTo(oe,d-3),l.lineTo(oe,d+3),l.stroke(),l.beginPath(),l.moveTo(oe+le,d-3),l.lineTo(oe+le,d+3),l.stroke(),l.fillStyle=a.subTextColor,l.font=S(10,500),l.textAlign="center",l.fillText(`比例尺: ${Math.round(O)} m`,oe+le/2,d+12)},Rt=()=>{Ie.value=!1,Ee.value={line:null,points:[],depthProfile:[],distance:null,hasData:!1},De.value&&De.value.getContext("2d").clearRect(0,0,De.value.width,De.value.height)},jt=()=>{var t;Se.push({name:"AcademicAlgorithm",query:(t=X.value)!=null&&t.name?{seam:X.value.name}:void 0})},Gt=t=>Array.isArray(t)?t[0]||"":typeof t=="string"?t:"",Qt=t=>Array.isArray(t)?t[0]||"":typeof t=="string"?t.trim():"";return no(()=>$e(this,null,function*(){var n,g,l,i,u;yield vt();const t=Qt(((n=P.query)==null?void 0:n.geomodel_job_id)||((g=P.query)==null?void 0:g.geomodelJobId));if(t){qe.value=t;try{yield xt()}catch(s){I.add("读取 Geomodel 任务状态失败: "+(((i=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:i.detail)||(s==null?void 0:s.message)||""),"warning")}}const e=Gt((u=P.query)==null?void 0:u.seam)||de.selectedSeam;if(!e)return;const r=Ce.value.find(s=>s.name===e);r&&(yield Mt(r))})),K({resetView:()=>{Rt()}}),(t,e)=>{var r,n,g,l,i,u,s,b,R,T,M,A,Q,G,W,j,z,te,q,ue,ke,O,le,oe;return m(),f("div",Zo,[o("div",el,[o("div",null,[e[7]||(e[7]=o("h2",null,"插值分析",-1)),o("div",tl,h(((r=X.value)==null?void 0:r.name)||"请选择煤层并执行空间插值分析"),1)]),X.value&&ee.value?(m(),f("div",ol,[o("div",ll,[e[8]||(e[8]=o("span",{class:"stat-label"},"厚度范围",-1)),o("strong",null,h(((l=(g=(n=ee.value)==null?void 0:n.thickness)==null?void 0:g.min)==null?void 0:l.toFixed(2))||"-")+" - "+h(((s=(u=(i=ee.value)==null?void 0:i.thickness)==null?void 0:u.max)==null?void 0:s.toFixed(2))||"-")+" m",1)]),o("div",sl,[e[9]||(e[9]=o("span",{class:"stat-label"},"平均厚度",-1)),o("strong",null,h(((T=(R=(b=ee.value)==null?void 0:b.thickness)==null?void 0:R.mean)==null?void 0:T.toFixed(2))||"-")+" m",1)]),o("div",nl,[e[10]||(e[10]=o("span",{class:"stat-label"},"钻孔数量",-1)),o("strong",null,h(((M=ee.value)==null?void 0:M.borehole_count)||E.value.length||"-"),1)])])):H("",!0)]),X.value?(m(),f("div",pl,[o("div",yl,[e[27]||(e[27]=ot('<h3 class="section-title" data-v-aae2a171><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-aae2a171><circle cx="12" cy="12" r="3" data-v-aae2a171></circle><path d="M12 1v6m0 6v6" data-v-aae2a171></path><path d="m4.93 4.93 4.24 4.24m5.66 5.66 4.24 4.24" data-v-aae2a171></path><path d="m4.93 19.07 4.24-4.24m5.66-5.66 4.24-4.24" data-v-aae2a171></path></svg> 插值参数 </h3>',1)),o("div",bl,[e[14]||(e[14]=o("label",{class:"param-label"},"插值方法",-1)),o("div",xl,[(m(),f(Oe,null,Ve(rt,d=>o("button",{key:d.key,class:Je(["tab-btn",{active:Pe.value===d.key}]),onClick:D=>Pe.value=d.key},h(d.label),11,kl)),64))])]),o("div",_l,[o("div",wl,[e[15]||(e[15]=o("label",{class:"param-label"},"网格密度",-1)),o("span",Sl,h(ve.value),1)]),lt(o("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>ve.value=d),type:"range",min:"30",max:"150",step:"10",class:"slider"},null,512),[[Tt,ve.value,void 0,{number:!0}]]),e[16]||(e[16]=o("div",{class:"slider-labels"},[o("span",null,"粗"),o("span",null,"细")],-1))]),o("div",Cl,[o("div",Tl,[e[17]||(e[17]=o("label",{class:"param-label"},"等值线级别",-1)),o("span",Ml,h(Ae.value),1)]),lt(o("input",{"onUpdate:modelValue":e[1]||(e[1]=d=>Ae.value=d),type:"range",min:"5",max:"20",step:"1",class:"slider"},null,512),[[Tt,Ae.value,void 0,{number:!0}]]),e[18]||(e[18]=o("div",{class:"slider-labels"},[o("span",null,"少"),o("span",null,"多")],-1))]),o("div",Fl,[e[19]||(e[19]=o("label",{class:"param-label"},"渲染质量",-1)),o("div",Pl,[(m(),f(Oe,null,Ve(kt,d=>o("button",{key:d.key,class:Je(["tab-btn",{active:Te.value===d.key}]),onClick:D=>Te.value=d.key},h(d.label),11,$l)),64))]),e[20]||(e[20]=o("div",{class:"slider-labels quality-hint"},[o("span",null,"默认先快速预览，需要时再切换更高质量重算。")],-1))]),Z.value?(m(),f("div",Al,[o("label",Rl,[lt(o("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=d=>Ie.value=d)},null,512),[[ao,Ie.value]]),e[21]||(e[21]=o("span",null,"绘制剖面线",-1))]),Ie.value?(m(),f("p",Bl,"在地图上点击两点绘制剖面线")):H("",!0)])):H("",!0),o("div",Wl,[o("button",{class:"btn primary",onClick:e[3]||(e[3]=d=>Ft({forceRefresh:!0,silent:!1})),disabled:B.value},[B.value?(m(),f("span",Il)):H("",!0),gt(" "+h(B.value?"计算中...":"生成等值线图"),1)],8,Nl),o("button",{class:"btn outline",onClick:e[4]||(e[4]=d=>{X.value=null,Z.value=null,me.value=null})}," 更换煤层 "),Z.value||me.value?(m(),f("button",{key:0,class:"btn outline",onClick:jt}," 下一步：新算法原理 ")):H("",!0)]),y.value?(m(),f("p",El,h(y.value),1)):H("",!0),X.value?(m(),f("div",Dl,[o("div",Yl,[e[22]||(e[22]=o("span",{class:"geomodel-title"},"地质建模任务",-1)),we(qe)?(m(),f("span",Ll,"#"+h(we(qe)),1)):H("",!0)]),o("div",Xl,[lt(o("select",{"onUpdate:modelValue":e[5]||(e[5]=d=>et.value=d),class:"geomodel-select"},[(m(),f(Oe,null,Ve(yt,d=>o("option",{key:d.key,value:d.key},h(d.label),9,zl)),64))],512),[[io,et.value]]),o("div",ql,[e[23]||(e[23]=o("label",null,"分辨率",-1)),lt(o("input",{"onUpdate:modelValue":e[6]||(e[6]=d=>tt.value=d),type:"number",min:"1",max:"500",step:"1"},null,512),[[Tt,tt.value,void 0,{number:!0}]])]),o("button",{class:"btn outline geomodel-btn",onClick:qt,disabled:we(je)},h(we(je)?"提交中...":"发起建模"),9,Hl)]),we(He)?(m(),f("div",Ul,[o("span",null,"状态: "+h(we(He).status),1),we(bt)?(m(),f("span",Ol,"轮询中...")):H("",!0),we(He).message?(m(),f("span",Vl,h(we(He).message),1)):H("",!0)])):H("",!0),we(Ge)?(m(),f("p",Jl,h(we(Ge)),1)):H("",!0),Xe.value?(m(),f("div",jl,[o("div",Gl,[e[24]||(e[24]=o("span",null,"连续性",-1)),o("strong",null,h(Number(Xe.value.continuity_score||0).toFixed(3)),1)]),o("div",Ql,[e[25]||(e[25]=o("span",null,"尖灭比例",-1)),o("strong",null,h(Number(Xe.value.pinchout_ratio||0).toFixed(3)),1)]),o("div",Kl,[e[26]||(e[26]=o("span",null,"层厚变异",-1)),o("strong",null,h(Number(Xe.value.layer_cv||0).toFixed(3)),1)])])):H("",!0),we(it).length?(m(),f("div",Zl,[(m(!0),f(Oe,null,Ve(we(it),d=>(m(),f("button",{key:d.name,class:"file-chip",onClick:D=>Ht(d.name)},h(d.name),9,es))),128))])):H("",!0)])):H("",!0)]),o("div",ts,[e[35]||(e[35]=ot('<h3 class="section-title" data-v-aae2a171><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-aae2a171><line x1="18" y1="20" x2="18" y2="10" data-v-aae2a171></line><line x1="12" y1="20" x2="12" y2="4" data-v-aae2a171></line><line x1="6" y1="20" x2="6" y2="14" data-v-aae2a171></line></svg> 数据分布 </h3>',1)),E.value.length>0?(m(),f("div",os,[o("canvas",{ref_key:"histogramCanvas",ref:Ze,class:"histogram-canvas"},null,512)])):(m(),f("div",ls,[...e[28]||(e[28]=[o("p",null,"暂无数据分布",-1)])])),E.value.length>0?(m(),f("div",ss,[o("div",ns,[e[29]||(e[29]=o("span",{class:"stat-label"},"样本数",-1)),o("span",as,h(Fe.value.count),1)]),o("div",is,[e[30]||(e[30]=o("span",{class:"stat-label"},"均值",-1)),o("span",rs,h(Fe.value.mean.toFixed(2))+"m",1)]),o("div",cs,[e[31]||(e[31]=o("span",{class:"stat-label"},"标准差",-1)),o("span",us,h(Fe.value.stdDev.toFixed(2))+"m",1)]),o("div",ds,[e[32]||(e[32]=o("span",{class:"stat-label"},"变异系数",-1)),o("span",vs,h(Fe.value.cv.toFixed(2)),1)]),o("div",ms,[e[33]||(e[33]=o("span",{class:"stat-label"},"最小值",-1)),o("span",hs,h(Fe.value.min.toFixed(2))+"m",1)]),o("div",fs,[e[34]||(e[34]=o("span",{class:"stat-label"},"最大值",-1)),o("span",gs,h(Fe.value.max.toFixed(2))+"m",1)])])):H("",!0)]),o("div",ps,[e[36]||(e[36]=ot('<h3 class="section-title" data-v-aae2a171><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-aae2a171><path d="M12 2L2 7l10 5 10-5-10-5z" data-v-aae2a171></path><path d="m2 17 10 5 10-5" data-v-aae2a171></path><path d="m2 12 10 5 10-5" data-v-aae2a171></path></svg> 地层柱状图 </h3>',1)),o("div",ys,[o("canvas",{ref_key:"stratigraphicCanvas",ref:nt,class:"stratigraphic-canvas"},null,512)]),o("div",bs,[(m(),f(Oe,null,Ve(se,(d,D)=>o("div",{key:D,class:"legend-item-compact"},[o("div",{class:"legend-color",style:st({background:d})},null,4),o("span",xs,h(D),1)])),64))])]),X.value?(m(),f("div",ks,[o("div",_s,[o("div",ws,[o("div",null,[e[37]||(e[37]=o("h3",{class:"section-title"},[o("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"})]),gt(" 煤层厚度分布 ")],-1)),Z.value?(m(),f("p",Ss,h(xe(Pe.value))+" · "+h((G=(Q=(A=Z.value)==null?void 0:A.valueRange)==null?void 0:Q.min)==null?void 0:G.toFixed(1))+" - "+h((z=(j=(W=Z.value)==null?void 0:W.valueRange)==null?void 0:j.max)==null?void 0:z.toFixed(1))+" m",1)):(m(),f("p",Cs,"正在准备厚度分布图..."))])]),o("div",Ts,[Z.value?(m(),Yt(Lt,{key:0,"image-url":Z.value.imageUrl,boreholes:E.value,bounds:Z.value.bounds,property:"thickness","property-label":"厚度","value-range":Z.value.valueRange,colormap:"YlOrBr","cross-section-mode":Ie.value,onCrossSectionComplete:At},null,8,["image-url","boreholes","bounds","value-range","cross-section-mode"])):(m(),f("div",{key:1,class:Je(["map-placeholder",{loading:B.value}])},[B.value?(m(),f("div",Ms)):H("",!0),o("p",null,h(B.value?"正在计算厚度分布图...":"点击“生成等值线图”后显示厚度分布图。"),1)],2))])]),o("div",Fs,[o("div",Ps,[o("div",null,[e[38]||(e[38]=o("h3",{class:"section-title"},[o("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),o("path",{d:"m2 17 10 5 10-5"})]),gt(" 煤层埋深分布 ")],-1)),me.value?(m(),f("p",$s,h(xe(Pe.value))+" · "+h((ue=(q=(te=me.value)==null?void 0:te.valueRange)==null?void 0:q.min)==null?void 0:ue.toFixed(1))+" - "+h((le=(O=(ke=me.value)==null?void 0:ke.valueRange)==null?void 0:O.max)==null?void 0:le.toFixed(1))+" m",1)):(m(),f("p",As,"正在准备埋深分布图..."))])]),o("div",Rs,[me.value?(m(),Yt(Lt,{key:0,"image-url":me.value.imageUrl,boreholes:E.value,bounds:me.value.bounds,property:"burial_depth","property-label":"埋深","value-range":me.value.valueRange,colormap:"viridis","cross-section-mode":Ie.value,onCrossSectionComplete:At},null,8,["image-url","boreholes","bounds","value-range","cross-section-mode"])):(m(),f("div",{key:1,class:Je(["map-placeholder",{loading:B.value}])},[B.value?(m(),f("div",Bs)):H("",!0),o("p",null,h(B.value?"正在计算埋深分布图...":"点击“生成等值线图”后显示埋深分布图。"),1)],2))])])])):H("",!0),X.value?(m(),f("div",Ws,[e[39]||(e[39]=ot('<div class="map-header" data-v-aae2a171><div data-v-aae2a171><h3 class="section-title" data-v-aae2a171><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-aae2a171><circle cx="12" cy="12" r="10" data-v-aae2a171></circle><line x1="12" y1="8" x2="12" y2="12" data-v-aae2a171></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-aae2a171></line></svg> 插值不确定性分布 </h3><p class="section-desc" data-v-aae2a171>红色区域表示高不确定性，蓝色区域更可靠</p></div></div>',1)),o("div",Ns,[Z.value?(m(),f("canvas",{key:0,ref_key:"uncertaintyCanvas",ref:at,class:"uncertainty-canvas"},null,512)):(m(),f("div",{key:1,class:Je(["map-placeholder",{loading:B.value}])},[B.value?(m(),f("div",Is)):H("",!0),o("p",null,h(B.value?"正在计算不确定性分布图...":"完成插值后显示不确定性分布图。"),1)],2))])])):H("",!0),Ee.value.hasData?(m(),f("div",Es,[o("div",Ds,[o("div",null,[o("h3",Ys,[e[40]||(e[40]=o("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[o("path",{d:"M3 3v18h18"}),o("path",{d:"m19 9-5 5-4-4-3 3"})],-1)),e[41]||(e[41]=gt(" 剖面切片 (A-A') ",-1)),o("span",Ls,h((oe=Ee.value.distance)==null?void 0:oe.toFixed(0))+" m",1)])]),o("button",{class:"btn outline small",onClick:Rt},"重置")]),o("div",Xs,[o("canvas",{ref_key:"crossSectionCanvas",ref:De,class:"cross-section-canvas"},null,512)])])):H("",!0)])):(m(),f("div",al,[e[13]||(e[13]=ot('<h3 class="section-title" data-v-aae2a171><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-aae2a171><rect x="3" y="3" width="18" height="18" rx="2" ry="2" data-v-aae2a171></rect><line x1="3" y1="9" x2="21" y2="9" data-v-aae2a171></line><line x1="9" y1="21" x2="9" y2="9" data-v-aae2a171></line></svg> 选择分析煤层 </h3><p class="section-desc" data-v-aae2a171>从以下可用煤层中选择一个进行插值分析</p>',2)),o("div",il,[(m(!0),f(Oe,null,Ve(Ce.value,d=>{var D,k,v,C,Y;return m(),f("div",{key:d.name,class:"seam-selection-card",onClick:re=>Mt(d)},[o("div",cl,[o("span",ul,h(d.name),1),o("span",dl,h(d.borehole_count)+" 个钻孔",1)]),o("div",vl,[o("div",ml,[e[11]||(e[11]=o("span",{class:"mini-stat-label"},"平均厚度",-1)),o("span",hl,h((D=d.avg_thickness)==null?void 0:D.toFixed(2))+" m",1)]),o("div",fl,[e[12]||(e[12]=o("span",{class:"mini-stat-label"},"厚度范围",-1)),o("span",gl,h((v=(k=d.thickness_range)==null?void 0:k.min)==null?void 0:v.toFixed(1))+"-"+h((Y=(C=d.thickness_range)==null?void 0:C.max)==null?void 0:Y.toFixed(1))+" m",1)])])],8,rl)}),128))])]))])}}},Gs=zt(zs,[["__scopeId","data-v-aae2a171"]]);export{Gs as default};
