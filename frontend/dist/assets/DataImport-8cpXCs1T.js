var se=Math.pow;var de=(H,I,u)=>new Promise((R,x)=>{var g=B=>{try{M(u.next(B))}catch(k){x(k)}},T=B=>{try{M(u.throw(B))}catch(k){x(k)}},M=B=>B.done?R(B.value):Promise.resolve(B.value).then(g,T);M((u=u.apply(H,I)).next())});import{be as Xe,bk as $e,w as ke,b5 as m,b8 as y,b7 as l,ba as Q,bl as K,bh as J,bm as fe,bn as ae,bb as b,b as _,c as D,bc as oe,b9 as pe,bo as Fe,bp as te,bi as Se,bq as ue,br as ve,bg as Te}from"./vendor-BiQoUjbf.js";import{_ as Ce,u as Ie,a as Ne}from"./index-CqmxJPzg.js";import{u as Le,s as Ye,p as Ve}from"./api-BhRy5Rwk.js";import"./vue-router-Dfza_nYx.js";import"./network-T6nY3V_4.js";const Pe={class:"borehole-map-container"},Re={class:"map-controls"},De=["width","height"],He={key:0,class:"map-empty"},ze={class:"tooltip-header"},Oe={class:"tooltip-row"},We={class:"tooltip-value"},Ae={class:"tooltip-row"},Ue={class:"tooltip-value"},je={key:1,class:"selection-info"},qe={class:"selection-coords"},Ee={key:2,class:"map-stats"},Ge={class:"stat-item"},Je={key:0,class:"stat-item"},le=40,Ke={__name:"BoreholeMap",props:{boreholes:{type:Array,default:()=>[]},size:{type:Number,default:350}},emits:["select"],setup(H,{emit:I}){const u=H,R=I,x=_(null),g=_(null),T=_(null),M=_({x:0,y:0}),B=_(!0),k=_(1),$=_(0),z=_(0),c=_(!1),V=_({x:0,y:0}),v=D(()=>u.size),F=D(()=>{if(u.boreholes.length===0)return null;let e=1/0,n=-1/0,i=1/0,C=-1/0;return u.boreholes.forEach(f=>{f.x<e&&(e=f.x),f.x>n&&(n=f.x),f.y<i&&(i=f.y),f.y>C&&(C=f.y)}),{minX:e,maxX:n,minY:i,maxY:C,rangeX:n-e,rangeY:C-i}}),N=D(()=>({left:M.value.x+12+"px",top:M.value.y+12+"px"})),P=e=>{if(e.length<3)return e;const n=[...e].sort((p,S)=>p.y-S.y||p.x-S.x),i=n[0],C=p=>Math.atan2(p.y-i.y,p.x-i.x),f=n.slice(1).sort((p,S)=>{const q=C(p),E=C(S);if(q!==E)return q-E;const O=Math.hypot(p.x-i.x,p.y-i.y),U=Math.hypot(S.x-i.x,S.y-i.y);return O-U}),L=(p,S,q)=>(S.x-p.x)*(q.y-p.y)-(S.y-p.y)*(q.x-p.x),h=[i];for(const p of f){for(;h.length>1&&L(h[h.length-2],h[h.length-1],p)<=0;)h.pop();h.push(p)}return h},j=(e,n)=>{const i=F.value;if(!i)return{x:0,y:0};const C=v.value/2,f=v.value/2,h=Math.min((v.value-le*2)/(i.rangeX||1),(v.value-le*2)/(i.rangeY||1))*k.value,p=(i.minX+i.maxX)/2,S=(i.minY+i.maxY)/2;return{x:C+(e-p)*h+$.value,y:f+(S-n)*h+z.value}},A=()=>{if(!x.value)return;const e=x.value.getContext("2d"),{width:n,height:i}=x.value;e.clearRect(0,0,n,i);const C=e.createLinearGradient(0,0,n,i);if(C.addColorStop(0,"#f8fafc"),C.addColorStop(1,"#f1f5f9"),e.fillStyle=C,e.fillRect(0,0,n,i),u.boreholes.length===0)return;const f=F.value,L=50*k.value,h=Math.min(.3,L/100);e.strokeStyle=`rgba(148, 163, 184, ${h})`,e.lineWidth=1;const p=ne(0,0),S=ne(n,i),q=Math.floor(p.x/50)*50,E=Math.floor(S.y/50)*50;for(let s=q;s<=S.x;s+=50){const t=j(s,0);e.beginPath(),e.moveTo(t.x,0),e.lineTo(t.x,i),e.stroke()}for(let s=E;s<=p.y;s+=50){const t=j(0,s);e.beginPath(),e.moveTo(0,t.y),e.lineTo(n,t.y),e.stroke()}e.strokeStyle="#cbd5e1",e.lineWidth=1.5;const O=j(0,0);if(O.y>=0&&O.y<=i&&(e.beginPath(),e.moveTo(0,O.y),e.lineTo(n,O.y),e.stroke()),O.x>=0&&O.x<=n&&(e.beginPath(),e.moveTo(O.x,0),e.lineTo(O.x,i),e.stroke()),x.value.scaledBoreholes=u.boreholes.map((s,t)=>{const a=j(s.x,s.y);return{index:t,name:s.name,x:s.x,y:s.y,canvasX:a.x,canvasY:a.y}}),B.value&&x.value.scaledBoreholes.length>=3){const s=P(x.value.scaledBoreholes);e.beginPath(),s.forEach((r,d)=>{d===0?e.moveTo(r.canvasX,r.canvasY):e.lineTo(r.canvasX,r.canvasY)}),e.closePath();const t=s.reduce((r,d)=>({minX:Math.min(r.minX,d.canvasX),maxX:Math.max(r.maxX,d.canvasX),minY:Math.min(r.minY,d.canvasY),maxY:Math.max(r.maxY,d.canvasY)}),{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}),a=e.createRadialGradient((t.minX+t.maxX)/2,(t.minY+t.maxY)/2,0,(t.minX+t.maxX)/2,(t.minY+t.maxY)/2,Math.max(t.maxX-t.minX,t.maxY-t.minY)/2);a.addColorStop(0,"rgba(59, 130, 246, 0.15)"),a.addColorStop(1,"rgba(59, 130, 246, 0.05)"),e.fillStyle=a,e.fill(),e.strokeStyle="rgba(59, 130, 246, 0.5)",e.lineWidth=2,e.setLineDash([8,4]),e.stroke(),e.setLineDash([]),s.forEach((r,d)=>{e.beginPath(),e.arc(r.canvasX,r.canvasY,5,0,Math.PI*2),e.fillStyle="rgba(59, 130, 246, 0.3)",e.fill(),e.strokeStyle="rgba(59, 130, 246, 0.6)",e.lineWidth=1.5,e.stroke()})}e.strokeStyle="rgba(99, 102, 241, 0.2)",e.lineWidth=1.5,e.setLineDash([4,4]),e.beginPath(),x.value.scaledBoreholes.forEach((s,t)=>{t===0?e.moveTo(s.canvasX,s.canvasY):e.lineTo(s.canvasX,s.canvasY)}),e.stroke(),e.setLineDash([]),x.value.scaledBoreholes.forEach((s,t)=>{var we;const a=T.value===t,r=((we=g.value)==null?void 0:we.index)===t;if(a||r){const _e=a?20:16,ee=e.createRadialGradient(s.canvasX,s.canvasY,0,s.canvasX,s.canvasY,_e);a?(ee.addColorStop(0,"rgba(245, 158, 11, 0.4)"),ee.addColorStop(.5,"rgba(245, 158, 11, 0.15)"),ee.addColorStop(1,"rgba(245, 158, 11, 0)")):(ee.addColorStop(0,"rgba(59, 130, 246, 0.3)"),ee.addColorStop(.5,"rgba(59, 130, 246, 0.1)"),ee.addColorStop(1,"rgba(59, 130, 246, 0)")),e.beginPath(),e.arc(s.canvasX,s.canvasY,_e,0,Math.PI*2),e.fillStyle=ee,e.fill()}const d=a?8:6;e.beginPath(),e.arc(s.canvasX,s.canvasY,d,0,Math.PI*2);const X=e.createRadialGradient(s.canvasX-d*.3,s.canvasY-d*.3,0,s.canvasX,s.canvasY,d);a?(X.addColorStop(0,"#fcd34d"),X.addColorStop(.5,"#f59e0b"),X.addColorStop(1,"#d97706")):(X.addColorStop(0,"#93c5fd"),X.addColorStop(.5,"#3b82f6"),X.addColorStop(1,"#2563eb")),e.fillStyle=X,e.fill(),e.strokeStyle=a?"#b45309":"#1d4ed8",e.lineWidth=a?2.5:2,e.stroke(),e.shadowColor=a?"rgba(245, 158, 11, 0.4)":"rgba(59, 130, 246, 0.3)",e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=2,e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;const W=s.name||`#${t+1}`,o=s.canvasY-d-6;e.font=a?"bold 11px sans-serif":"10px sans-serif";const w=e.measureText(W),Y=4,G=s.canvasX-w.width/2-Y,Z=o-10,Be=w.width+Y*2,Me=14;a?e.fillStyle="rgba(245, 158, 11, 0.9)":e.fillStyle="rgba(255, 255, 255, 0.85)",e.beginPath(),e.roundRect(G,Z,Be,Me,4),e.fill(),e.fillStyle=a?"#fff":"#1e40af",e.textAlign="center",e.textBaseline="middle",e.fillText(W,s.canvasX,o-3)});const U=60*k.value;if(U>30&&U<180){const s=i-18,t=16;e.fillStyle="rgba(255, 255, 255, 0.9)",e.beginPath(),e.roundRect(t-4,s-10,U+8,20,4),e.fill(),e.strokeStyle="#475569",e.lineWidth=2,e.beginPath(),e.moveTo(t,s),e.lineTo(t+U,s),e.stroke(),e.beginPath(),e.moveTo(t,s-5),e.lineTo(t,s+5),e.stroke(),e.beginPath(),e.moveTo(t+U,s-5),e.lineTo(t+U,s+5),e.stroke();const a=Math.min((v.value-le*2)/(f.rangeX||1),(v.value-le*2)/(f.rangeY||1)),r=Math.round(60/k.value/a);e.fillStyle="#475569",e.font="10px sans-serif",e.textAlign="center",e.fillText(`${r}m`,t+U/2,s-10)}},ne=(e,n)=>{const i=F.value;if(!i)return{x:0,y:0};const C=v.value/2,f=v.value/2,h=Math.min((v.value-le*2)/(i.rangeX||1),(v.value-le*2)/(i.rangeY||1))*k.value,p=(i.minX+i.maxX)/2,S=(i.minY+i.maxY)/2;return{x:p+(e-C-$.value)/h,y:S-(n-f-z.value)/h}},be=()=>{k.value=Math.min(k.value*1.3,5),A()},he=()=>{k.value=Math.max(k.value/1.3,.2),A()},ie=()=>{k.value=1,$.value=0,z.value=0,A()},me=()=>{B.value=!B.value,A()},ye=e=>{c.value=!0,V.value={x:e.clientX-$.value,y:e.clientY-z.value}},re=()=>{c.value=!1},ce=e=>{var L;if(!((L=x.value)!=null&&L.scaledBoreholes))return;const n=x.value.getBoundingClientRect(),i=e.clientX-n.left,C=e.clientY-n.top;if(c.value){$.value=e.clientX-V.value.x,z.value=e.clientY-V.value.y,A();return}let f=null;for(const h of x.value.scaledBoreholes)if(Math.sqrt(se(i-h.canvasX,2)+se(C-h.canvasY,2))<12){f=h;break}g.value=f,M.value={x:e.clientX,y:e.clientY},x.value.style.cursor=f?"pointer":c.value?"grabbing":"grab"},xe=e=>{const n=e.deltaY>0?.9:1.1;k.value=Math.max(.2,Math.min(5,k.value*n)),A()},ge=e=>{var L;if(!((L=x.value)!=null&&L.scaledBoreholes))return;const n=x.value.getBoundingClientRect(),i=e.clientX-n.left,C=e.clientY-n.top;let f=null;for(const h of x.value.scaledBoreholes)if(Math.sqrt(se(i-h.canvasX,2)+se(C-h.canvasY,2))<12){f=h.index;break}f!==null?(T.value=f,R("select",f)):T.value=null,A()};return Xe(()=>{A(),x.value&&(x.value.style.cursor="grab")}),$e(()=>{}),ke(()=>u.boreholes,()=>{ie()},{deep:!0}),ke(B,A),(e,n)=>{var i,C,f,L,h,p,S;return m(),y("div",Pe,[l("div",Re,[l("button",{class:"control-btn",onClick:be,title:"æ”¾å¤§"},[...n[1]||(n[1]=[l("span",null,"+",-1)])]),l("button",{class:"control-btn",onClick:he,title:"ç¼©å°"},[...n[2]||(n[2]=[l("span",null,"âˆ’",-1)])]),l("button",{class:"control-btn",onClick:ie,title:"é‡ç½®"},[...n[3]||(n[3]=[l("span",null,"âŸ²",-1)])]),l("button",{class:Q(["control-btn",{active:B.value}]),onClick:me,title:"è¾¹ç•Œ"},[...n[4]||(n[4]=[l("span",null,"â¬¡",-1)])],2)]),l("div",{class:Q(["map-wrapper",{dragging:c.value}])},[l("canvas",{ref_key:"canvas",ref:x,width:v.value,height:v.value,onMousedown:ye,onMousemove:ce,onMouseup:re,onMouseleave:re,onWheel:K(xe,["prevent"]),onClick:ge},null,40,De),H.boreholes.length===0?(m(),y("div",He,[...n[5]||(n[5]=[l("div",{class:"empty-icon"},"ğŸ“",-1),l("p",null,"æš‚æ— é’»å­”æ•°æ®",-1)])])):J("",!0)],2),g.value?(m(),y("div",{key:0,class:"tooltip",style:fe(N.value)},[l("div",ze,[n[6]||(n[6]=l("span",{class:"tooltip-icon"},"ğŸ“",-1)),ae(" "+b(g.value.name||`é’»å­” #${g.value.index+1}`),1)]),l("div",Oe,[n[7]||(n[7]=l("span",{class:"tooltip-label"},"X åæ ‡:",-1)),l("span",We,b(g.value.x.toFixed(2))+" m",1)]),l("div",Ae,[n[8]||(n[8]=l("span",{class:"tooltip-label"},"Y åæ ‡:",-1)),l("span",Ue,b(g.value.y.toFixed(2))+" m",1)])],4)):J("",!0),T.value!==null?(m(),y("div",je,[n[9]||(n[9]=l("span",{class:"selection-icon"},"ğŸ¯",-1)),l("strong",null,b(((i=H.boreholes[T.value])==null?void 0:i.name)||`é’»å­” #${T.value+1}`),1),l("span",qe,"("+b((f=(C=H.boreholes[T.value])==null?void 0:C.x)==null?void 0:f.toFixed(1))+", "+b((h=(L=H.boreholes[T.value])==null?void 0:L.y)==null?void 0:h.toFixed(1))+")",1),l("button",{class:"clear-btn",onClick:n[0]||(n[0]=q=>T.value=null),title:"å–æ¶ˆé€‰æ‹©"},"Ã—")])):(m(),y("div",Ee,[l("span",Ge,"ğŸ“ "+b(H.boreholes.length)+" ä¸ªé’»å­”",1),F.value?(m(),y("span",Je," ğŸ“ "+b((p=F.value.rangeX)==null?void 0:p.toFixed(0))+"m Ã— "+b((S=F.value.rangeY)==null?void 0:S.toFixed(0))+"m ",1)):J("",!0)]))])}}},Qe=Ce(Ke,[["__scopeId","data-v-8b1ba160"]]),Ze={__name:"VirtualList",props:{items:{type:Array,required:!0},itemHeight:{type:Number,required:!0},height:{type:Number,required:!0},buffer:{type:Number,default:5},keyField:{type:String,default:"id"},itemClass:{type:String,default:""}},setup(H,{expose:I}){const u=H,R=_(null),x=_(0),g=D(()=>({height:`${u.height}px`,overflow:"auto",position:"relative"})),T=D(()=>u.items.length*u.itemHeight),M=D(()=>({height:`${T.value}px`,position:"relative"})),B=v=>({height:`${u.itemHeight}px`,position:"absolute",top:`${v*u.itemHeight}px`,left:0,right:0,boxSizing:"border-box"}),k=D(()=>{const v=Math.floor(x.value/u.itemHeight),F=Math.ceil(u.height/u.itemHeight),N=Math.max(0,v-u.buffer),P=Math.min(u.items.length,v+F+u.buffer);return{start:N,end:P}}),$=D(()=>{const{start:v,end:F}=k.value,N=[];for(let P=v;P<F;P++)P>=0&&P<u.items.length&&N.push({data:u.items[P],index:P});return N}),z=v=>{var F,N;return u.keyField&&v[u.keyField]!==void 0?v[u.keyField]:(N=(F=$.value.find(P=>P.data===v))==null?void 0:F.index)!=null?N:Math.random()};let c=null;const V=()=>{c||(c=requestAnimationFrame(()=>{var v,F;x.value=(F=(v=R.value)==null?void 0:v.scrollTop)!=null?F:0,c=null}))};return I({scrollTo:v=>{R.value&&(R.value.scrollTop=v*u.itemHeight)},scrollToTop:()=>{R.value&&(R.value.scrollTop=0)}}),(v,F)=>(m(),y("div",{ref_key:"containerRef",ref:R,class:"virtual-list-container",style:fe(g.value),onScroll:V},[l("div",{class:"virtual-list-spacer",style:fe(M.value)},[(m(!0),y(oe,null,pe($.value,N=>(m(),y("div",{key:z(N.data),class:Q(H.itemClass),style:fe(B(N.index))},[Fe(v.$slots,"default",{item:N.data,index:N.index},void 0)],6))),128))],4)],36))}},et=Ce(Ze,[["__scopeId","data-v-225c5e01"]]),tt={class:"page"},lt={class:"grid grid-2"},st={class:"card upload-card"},at={key:0,class:"file-list"},ot={class:"file-list-header"},nt={class:"file-items"},it={class:"file-name"},rt={class:"file-size"},ct=["onClick"],dt={class:"action-buttons"},ut=["disabled"],vt={key:0,class:"spinner sm"},ft=["disabled"],pt={key:1,class:"result-box success"},bt={class:"result-content"},ht={class:"result-desc"},mt={key:2,class:"extracted-coords"},yt={class:"subsection-desc"},xt={class:"card upload-card"},gt={class:"tab-buttons"},kt={key:0,class:"coord-input"},Ct={class:"coord-list"},wt={class:"coord-num"},_t=["onUpdate:modelValue"],St=["onUpdate:modelValue"],Yt=["onUpdate:modelValue"],Xt=["onClick"],Bt={class:"coord-actions"},Mt=["disabled"],$t={key:1,class:"coord-file"},Ft={key:2,class:"coord-stats"},Tt={class:"stat-badge"},It={class:"stat-range"},Nt={key:0,class:"card preview-card"},Lt={class:"preview-header"},Vt={class:"section-desc"},Pt={class:"preview-grid"},Rt={class:"map-section"},Dt={class:"table-section"},Ht={class:"table-header"},zt={class:"table-wrapper"},Ot=["onClick"],Wt={class:"virtual-cell",style:{width:"50px"}},At={class:"virtual-cell"},Ut={class:"virtual-cell",style:{width:"80px"}},jt={class:"virtual-cell",style:{width:"80px"}},qt={class:"virtual-cell",style:{width:"120px"}},Et=["onClick"],Gt=["onClick"],Jt={key:1,class:"table compact"},Kt=["onClick"],Qt=["onClick"],Zt=["onClick"],el={key:2,class:"table-empty"},tl={key:1,class:"card"},ll={__name:"DataImport",setup(H){const I=Ne(),{markStepDone:u}=Ie(),R=_(null),x=_(null),g=_([]),T=_(!1),M=_(!1),B=_(null),k=_("manual"),$=_(null),z=_(""),c=_([]),V=_([]),v=D(()=>c.value.length?Math.min(...c.value.map(s=>s.x)):null),F=D(()=>c.value.length?Math.max(...c.value.map(s=>s.x)):null),N=D(()=>c.value.length?Math.min(...c.value.map(s=>s.y)):null),P=D(()=>c.value.length?Math.max(...c.value.map(s=>s.y)):null),j=D(()=>{if(!z.value)return c.value;const s=z.value.toLowerCase();return c.value.filter(t=>{var a,r;return t.name&&t.name.toLowerCase().includes(s)||((a=t.x)==null?void 0:a.toString().includes(s))||((r=t.y)==null?void 0:r.toString().includes(s))})});ke($,s=>{});const A=()=>{try{const s=localStorage.getItem("borehole_coordinates");s&&(c.value=JSON.parse(s))}catch(s){console.error("Failed to load coordinates:",s)}},ne=()=>{var s;(s=R.value)==null||s.click()},be=()=>{var s;(s=x.value)==null||s.click()},he=s=>{const t=Array.from(s.target.files||[]).filter(a=>a.name.endsWith(".csv"));g.value=[...g.value,...t]},ie=s=>{T.value=!1;const t=Array.from(s.dataTransfer.files||[]).filter(a=>a.name.endsWith(".csv"));g.value=[...g.value,...t]},me=s=>{g.value.splice(s,1)},ye=()=>{g.value=[]},re=s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":(s/(1024*1024)).toFixed(1)+" MB",ce=()=>de(this,null,function*(){V.value=[];const s=[];for(const t of g.value)try{const{data:a}=yield Ve(t.name,100);if(a.data&&a.data.length>0){const r=Object.keys(a.data[0]).map(o=>o.toLowerCase()),d=Object.keys(a.data[0]).find(o=>o.toLowerCase().includes("x")||o==="åæ ‡x"||o==="xåæ ‡"),X=Object.keys(a.data[0]).find(o=>o.toLowerCase().includes("y")||o==="åæ ‡y"||o==="yåæ ‡"),W=Object.keys(a.data[0]).find(o=>o.toLowerCase().includes("name")||o.toLowerCase().includes("é’»å­”")||o==="é’»å­”å·"||o==="å­”å·");if(d&&X){const o=a.data[0],w=parseFloat(o[d]),Y=parseFloat(o[X]);!isNaN(w)&&!isNaN(Y)&&s.push({name:W?o[W]:t.name.replace(".csv",""),x:w,y:Y,file:t.name})}}}catch(a){console.log("æ— æ³•ä»",t.name,"æå–åæ ‡:",a.message)}V.value=s}),xe=()=>de(this,null,function*(){var s,t;M.value=!0;try{yield Le(g.value);const{data:a}=yield Ye();B.value=a,u("DataImport"),I.add(`å·²ä¸Šä¼  ${g.value.length} ä¸ªæ–‡ä»¶`,"success"),yield ce()}catch(a){I.add(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.detail)||"ä¸Šä¼ å¤±è´¥","error")}finally{M.value=!1}}),ge=()=>de(this,null,function*(){var s,t;M.value=!0;try{const{data:a}=yield Ye();B.value=a,I.add("æ‰«æå®Œæˆ","success"),yield ce()}catch(a){I.add(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.detail)||"æ‰«æå¤±è´¥","error")}finally{M.value=!1}}),e=()=>{V.value.length>0&&(c.value=[...V.value],E(),I.add(`å·²å¯¼å…¥ ${V.value.length} ä¸ªé’»å­”åæ ‡`,"success"),V.value=[])},n=s=>{var r;const t=(r=s.target.files)==null?void 0:r[0];if(!t)return;const a=new FileReader;a.onload=d=>{const X=d.target.result;i(X,t.name)},a.readAsText(t)},i=(s,t)=>{var a;try{let r=[];if(t.endsWith(".json"))r=JSON.parse(s);else{const d=s.split(`
`),X=d[0].toLowerCase().includes("name")||d[0].toLowerCase().includes("åç§°")?1:0;for(let W=X;W<d.length;W++){const o=d[W].trim();if(!o)continue;const w=o.split(/[,\t\s]+/);if(w.length>=3){const Y=parseFloat(w[1]),G=parseFloat(w[2]);!isNaN(Y)&&!isNaN(G)&&r.push({name:(a=w[0])==null?void 0:a.trim(),x:Y,y:G})}}}r=r.filter(d=>!isNaN(d.x)&&!isNaN(d.y)),r.length>0?(c.value=r,E(),I.add(`å·²å¯¼å…¥ ${r.length} ä¸ªé’»å­”åæ ‡`,"success")):I.add("æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®","error")}catch(r){I.add("æ–‡ä»¶è§£æå¤±è´¥","error")}},C=()=>{c.value.push({name:`BH-${c.value.length+1}`,x:0,y:0})},f=s=>{const t=c.value[s];c.value.splice(s,1),E(),($.value===s||$.value===t)&&($.value=null)},L=s=>{const t=c.value[s],a=prompt("é’»å­”åç§°:",t.name||""),r=prompt("X åæ ‡:",t.x),d=prompt("Y åæ ‡:",t.y);a!==null&&(t.name=a),r!==null&&!isNaN(parseFloat(r))&&(t.x=parseFloat(r)),d!==null&&!isNaN(parseFloat(d))&&(t.y=parseFloat(d)),E()},h=s=>typeof s=="number"?s:c.value.indexOf(s),p=s=>{const t=h(s);t!==-1&&f(t)},S=s=>{const t=h(s);t!==-1&&L(t)},q=s=>{$.value=s},E=()=>{localStorage.setItem("borehole_coordinates",JSON.stringify(c.value)),u("DataImport",{boreholes:c.value.length||0}),I.add("åæ ‡å·²ä¿å­˜","success")},O=()=>{const t=`name,x,y
`+c.value.map(X=>`${X.name||""},${X.x},${X.y}`).join(`
`),a=new Blob([t],{type:"text/csv"}),r=URL.createObjectURL(a),d=document.createElement("a");d.href=r,d.download="borehole_coordinates.csv",d.click(),URL.revokeObjectURL(r),I.add("åæ ‡å·²å¯¼å‡º","success")},U=()=>{confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰åæ ‡å—ï¼Ÿ")&&(c.value=[],$.value=null,localStorage.removeItem("borehole_coordinates"),I.add("åæ ‡å·²æ¸…ç©º","success"))};return Xe(()=>{A()}),(s,t)=>{var a,r,d,X,W;return m(),y("div",tt,[l("div",lt,[l("div",st,[t[11]||(t[11]=l("h3",{class:"section-title"},[l("svg",{class:"section-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})]),ae(" ä¸Šä¼ é’»å­”æ•°æ®æ–‡ä»¶ ")],-1)),t[12]||(t[12]=l("p",{class:"section-desc"},"ä¸Šä¼ åŒ…å«å²©æ€§å‚æ•°ï¼ˆå¼¹æ€§æ¨¡é‡ã€å®¹é‡ã€æŠ—æ‹‰å¼ºåº¦ã€åšåº¦ï¼‰çš„ CSV æ–‡ä»¶",-1)),l("div",{class:Q(["upload-area",{"drag-over":T.value}]),onDrop:K(ie,["prevent"]),onDragover:t[0]||(t[0]=K(o=>T.value=!0,["prevent"])),onDragleave:t[1]||(t[1]=K(o=>T.value=!1,["prevent"])),onClick:ne},[l("input",{ref_key:"fileInput",ref:R,type:"file",multiple:"",accept:".csv",onChange:he,style:{display:"none"}},null,544),t[5]||(t[5]=te('<div class="upload-icon" data-v-f6b429bb><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-f6b429bb><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-f6b429bb></path><polyline points="14 2 14 8 20 8" data-v-f6b429bb></polyline><line x1="12" y1="18" x2="12" y2="12" data-v-f6b429bb></line><line x1="9" y1="15" x2="15" y2="15" data-v-f6b429bb></line></svg></div><p class="upload-text" data-v-f6b429bb>ç‚¹å‡»é€‰æ‹©æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</p><p class="upload-hint" data-v-f6b429bb>æ”¯æŒ .csv æ ¼å¼ï¼Œå¯å¤šé€‰</p>',3))],34),g.value.length>0?(m(),y("div",at,[l("div",ot,[l("span",null,"å·²é€‰æ‹© "+b(g.value.length)+" ä¸ªæ–‡ä»¶",1),l("button",{class:"text-btn",onClick:ye},"æ¸…ç©º")]),l("div",nt,[(m(!0),y(oe,null,pe(g.value,(o,w)=>(m(),y("div",{key:w,class:"file-item"},[t[7]||(t[7]=l("svg",{class:"file-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),l("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),l("line",{x1:"9",y1:"21",x2:"9",y2:"9"})],-1)),l("span",it,b(o.name),1),l("span",rt,b(re(o.size)),1),l("button",{class:"file-remove",onClick:Y=>me(w)},[...t[6]||(t[6]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,ct)]))),128))])])):J("",!0),l("div",dt,[l("button",{class:"btn primary",onClick:xe,disabled:M.value||g.value.length===0},[M.value?(m(),y("span",vt)):J("",!0),ae(" "+b(M.value?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ æ•°æ®"),1)],8,ut),l("button",{class:"btn secondary",onClick:ge,disabled:M.value}," æ‰«ææ–‡ä»¶ ",8,ft)]),B.value?(m(),y("div",pt,[t[9]||(t[9]=l("div",{class:"result-icon"},[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[l("polyline",{points:"20 6 9 17 4 12"})])],-1)),l("div",bt,[t[8]||(t[8]=l("div",{class:"result-title"},"æ‰«æå®Œæˆ",-1)),l("div",ht,"æ£€æµ‹åˆ° "+b(((a=B.value.files)==null?void 0:a.length)||0)+" ä¸ª CSV æ–‡ä»¶",1)])])):J("",!0),V.value.length>0?(m(),y("div",mt,[t[10]||(t[10]=l("h4",{class:"subsection-title"},"ä»æ–‡ä»¶ä¸­æå–çš„åæ ‡",-1)),l("p",yt,"å‘ç° "+b(V.value.length)+" ä¸ªé’»å­”åŒ…å«åæ ‡ä¿¡æ¯",1),l("button",{class:"btn outline small",onClick:e}," ä½¿ç”¨è¿™äº›åæ ‡ ")])):J("",!0)]),l("div",xt,[t[18]||(t[18]=te('<h3 class="section-title" data-v-f6b429bb><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-f6b429bb><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" data-v-f6b429bb></path><circle cx="12" cy="10" r="3" data-v-f6b429bb></circle></svg> é’»å­”åæ ‡ </h3><p class="section-desc" data-v-f6b429bb>è®¾ç½®é’»å­”çš„å¹³é¢ä½ç½®åæ ‡ï¼ˆX, Yï¼‰</p>',2)),l("div",gt,[l("button",{class:Q(["tab-btn",{active:k.value==="manual"}]),onClick:t[2]||(t[2]=o=>k.value="manual")}," æ‰‹åŠ¨è¾“å…¥ ",2),l("button",{class:Q(["tab-btn",{active:k.value==="file"}]),onClick:t[3]||(t[3]=o=>k.value="file")}," æ–‡ä»¶ä¸Šä¼  ",2)]),k.value==="manual"?(m(),y("div",kt,[l("div",Ct,[(m(!0),y(oe,null,pe(c.value,(o,w)=>(m(),y("div",{key:w,class:"coord-item"},[l("span",wt,"#"+b(w+1),1),ue(l("input",{type:"text","onUpdate:modelValue":Y=>o.name=Y,placeholder:"åç§°",class:"coord-name-input"},null,8,_t),[[ve,o.name]]),ue(l("input",{type:"number","onUpdate:modelValue":Y=>o.x=Y,placeholder:"X (m)",class:"coord-value-input"},null,8,St),[[ve,o.x,void 0,{number:!0}]]),ue(l("input",{type:"number","onUpdate:modelValue":Y=>o.y=Y,placeholder:"Y (m)",class:"coord-value-input"},null,8,Yt),[[ve,o.y,void 0,{number:!0}]]),l("button",{class:"coord-remove",onClick:Y=>f(w),title:"åˆ é™¤"},[...t[13]||(t[13]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,Xt)]))),128))]),l("div",Bt,[l("button",{class:"btn outline small",onClick:C}," + æ·»åŠ  "),l("button",{class:"btn primary small",onClick:E,disabled:M.value||c.value.length===0}," ä¿å­˜åæ ‡ ",8,Mt)])])):(m(),y("div",$t,[l("div",{class:"upload-area compact",onClick:be},[l("input",{ref_key:"coordInput",ref:x,type:"file",accept:".csv,.json,.txt",onChange:n,style:{display:"none"}},null,544),t[14]||(t[14]=te('<div class="upload-icon" data-v-f6b429bb><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-f6b429bb><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" data-v-f6b429bb></path><circle cx="12" cy="10" r="3" data-v-f6b429bb></circle></svg></div><p class="upload-text" data-v-f6b429bb>ä¸Šä¼ åæ ‡æ–‡ä»¶</p><p class="upload-hint" data-v-f6b429bb>æ”¯æŒ CSV/JSON/TXT æ ¼å¼</p>',3))]),t[15]||(t[15]=l("div",{class:"coord-format-hint"},[l("strong",null,"CSV æ ¼å¼ç¤ºä¾‹ï¼š"),l("br"),l("code",null,"name,x,y"),l("br"),l("code",null,"ZK01,100,200")],-1))])),c.value.length>0?(m(),y("div",Ft,[l("div",Tt,[t[16]||(t[16]=ae(" å·²è®¾ç½® ",-1)),l("strong",null,b(c.value.length),1),t[17]||(t[17]=ae(" ä¸ªé’»å­”åæ ‡ ",-1))]),l("div",It," èŒƒå›´: X "+b((r=v.value)==null?void 0:r.toFixed(0))+"~"+b((d=F.value)==null?void 0:d.toFixed(0))+"m, Y "+b((X=N.value)==null?void 0:X.toFixed(0))+"~"+b((W=P.value)==null?void 0:W.toFixed(0))+"m ",1)])):J("",!0)])]),c.value.length>0?(m(),y("div",Nt,[l("div",Lt,[l("div",null,[t[19]||(t[19]=te('<h3 class="section-title" data-v-f6b429bb><svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-f6b429bb><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6" data-v-f6b429bb></polygon><line x1="8" y1="2" x2="8" y2="18" data-v-f6b429bb></line><line x1="16" y1="6" x2="16" y2="22" data-v-f6b429bb></line></svg> é’»å­”ä½ç½®é¢„è§ˆ </h3>',1)),l("p",Vt,b(c.value.length)+" ä¸ªé’»å­” Â· å¯æ‹–æ‹½å¹³ç§» Â· æ»šè½®ç¼©æ”¾ Â· ç‚¹å‡»é€‰æ‹©",1)]),l("div",{class:"preview-actions"},[l("button",{class:"icon-btn",onClick:O,title:"å¯¼å‡ºåæ ‡"},[...t[20]||(t[20]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),l("polyline",{points:"7 10 12 15 17 10"}),l("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1)])]),l("button",{class:"icon-btn danger",onClick:U,title:"æ¸…ç©ºåæ ‡"},[...t[21]||(t[21]=[te('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-f6b429bb><polyline points="3 6 5 6 21 6" data-v-f6b429bb></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" data-v-f6b429bb></path><line x1="10" y1="11" x2="10" y2="17" data-v-f6b429bb></line><line x1="14" y1="11" x2="14" y2="17" data-v-f6b429bb></line></svg>',1)])])])]),l("div",Pt,[l("div",Rt,[Se(Qe,{boreholes:c.value,size:320,onSelect:q},null,8,["boreholes"])]),l("div",Dt,[l("div",Ht,[l("h4",null,"åæ ‡åˆ—è¡¨ ("+b(j.value.length)+")",1),ue(l("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>z.value=o),placeholder:"æœç´¢...",class:"search-input"},null,512),[[ve,z.value]])]),l("div",zt,[j.value.length>100?(m(),y(oe,{key:0},[t[22]||(t[22]=te('<div class="virtual-table-header" data-v-f6b429bb><div class="virtual-row virtual-header" data-v-f6b429bb><div class="virtual-cell" style="width:50px;" data-v-f6b429bb>åºå·</div><div class="virtual-cell" data-v-f6b429bb>åç§°</div><div class="virtual-cell" style="width:80px;" data-v-f6b429bb>X (m)</div><div class="virtual-cell" style="width:80px;" data-v-f6b429bb>Y (m)</div><div class="virtual-cell" style="width:120px;" data-v-f6b429bb>æ“ä½œ</div></div></div>',1)),Se(et,{items:j.value,"item-height":44,height:320,buffer:5,"key-field":"name","item-class":"virtual-row"},{default:Te(({item:o,index:w})=>{var Y,G;return[l("div",{class:Q({selected:$.value===o}),onClick:Z=>$.value=o,style:{display:"flex",width:"100%",height:"100%","align-items":"center"}},[l("div",Wt,b(w+1),1),l("div",At,b(o.name||`BH-${w+1}`),1),l("div",Ut,b(((Y=o.x)==null?void 0:Y.toFixed(1))||"-"),1),l("div",jt,b(((G=o.y)==null?void 0:G.toFixed(1))||"-"),1),l("div",qt,[l("button",{class:"table-btn",onClick:K(Z=>S(o),["stop"])},"ç¼–è¾‘",8,Et),l("button",{class:"table-btn danger",onClick:K(Z=>p(o),["stop"])},"åˆ é™¤",8,Gt)])],10,Ot)]}),_:1},8,["items"])],64)):(m(),y("table",Jt,[t[23]||(t[23]=l("thead",null,[l("tr",null,[l("th",null,"åºå·"),l("th",null,"åç§°"),l("th",null,"X (m)"),l("th",null,"Y (m)"),l("th",null,"æ“ä½œ")])],-1)),l("tbody",null,[(m(!0),y(oe,null,pe(j.value,(o,w)=>{var Y,G;return m(),y("tr",{key:w,class:Q({selected:$.value===o}),onClick:Z=>$.value=o},[l("td",null,b(w+1),1),l("td",null,b(o.name||`BH-${w+1}`),1),l("td",null,b(((Y=o.x)==null?void 0:Y.toFixed(1))||"-"),1),l("td",null,b(((G=o.y)==null?void 0:G.toFixed(1))||"-"),1),l("td",null,[l("button",{class:"table-btn",onClick:K(Z=>S(o),["stop"])},"ç¼–è¾‘",8,Qt),l("button",{class:"table-btn danger",onClick:K(Z=>p(o),["stop"])},"åˆ é™¤",8,Zt)])],10,Kt)}),128))])])),j.value.length===0?(m(),y("div",el," æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é’»å­” ")):J("",!0)])])])])):(m(),y("div",tl,[...t[24]||(t[24]=[te('<div class="empty-state" data-v-f6b429bb><div class="empty-icon" data-v-f6b429bb><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-f6b429bb><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6" data-v-f6b429bb></polygon><line x1="8" y1="2" x2="8" y2="18" data-v-f6b429bb></line><line x1="16" y1="6" x2="16" y2="22" data-v-f6b429bb></line></svg></div><p data-v-f6b429bb>æš‚æ— é’»å­”ä½ç½®æ•°æ®</p><p class="empty-hint" data-v-f6b429bb>è¯·å…ˆä¸Šä¼ æ•°æ®æ–‡ä»¶æˆ–æ‰‹åŠ¨è¾“å…¥åæ ‡</p></div>',1)])]))])}}},cl=Ce(ll,[["__scopeId","data-v-f6b429bb"]]);export{cl as default};
