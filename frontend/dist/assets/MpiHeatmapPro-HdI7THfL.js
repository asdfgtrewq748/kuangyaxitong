var Te=(X,N,B)=>new Promise((u,L)=>{var c=g=>{try{_(B.next(g))}catch(U){L(U)}},f=g=>{try{_(B.throw(g))}catch(U){L(U)}},_=g=>g.done?u(g.value):Promise.resolve(g.value).then(c,f);_((B=B.apply(X,N)).next())});import{s as tt,k as A,M as et,N as Ne,o as oe,b as le,a as n,t as Q,F as qe,r as Ue,z as Fe,n as Be,v as Qe,e as Jt,C as we,I as Qt,A as yt,y as $e,i as pt,w as en,L as tn,O as ae,d as W,P as nn,D as sn,E as Ie}from"./vue-vendor-uHJg9g_5.js";import{_ as xt,u as an}from"./index-BQuJNExo.js";import{r as on,C as ln}from"./d3-DMsWJsA-.js";import{g as rn,j as cn,c as un,m as dn,l as vn}from"./api-BlLoGSss.js";import"./index-T6nY3V_4.js";function mn(X,N={}){const B={totalDistance:N.totalDistance||500,frameRate:N.frameRate||60,progressPerSecond:N.progressPerSecond||10,autoPlay:N.autoPlay||!1},u=et({isPlaying:B.autoPlay,progress:0,direction:0,playbackSpeed:1,lastFrameTime:0,animationId:null}),L=A(()=>u.progress/100*B.totalDistance),c=A(()=>B.totalDistance-L.value),f=A(()=>u.progress>=100),_=A(()=>(u.direction-90)*Math.PI/180),g=A(()=>{if(!X.value)return null;if(X.value.bounds)return X.value.bounds;if(X.value.points&&X.value.points.length>0){const k=X.value.points.map(ne=>ne[0]),G=X.value.points.map(ne=>ne[1]);return{min_x:Math.min(...k),max_x:Math.max(...k),min_y:Math.min(...G),max_y:Math.max(...G)}}return null}),U=A(()=>g.value?{x:(g.value.min_x+g.value.max_x)/2,y:(g.value.min_y+g.value.max_y)/2}:null),ie=A(()=>g.value?g.value.max_y-g.value.min_y:0),r=A(()=>{if(!U.value||!g.value)return null;const k=_.value,ne=(g.value.max_x-g.value.min_x)*(u.progress/100),d=g.value.min_x+Math.cos(k)*ne,fe=U.value.y+Math.sin(k)*ne,ye=k+Math.PI/2,ge=ie.value/2;return{start:{x:d-Math.cos(ye)*ge,y:fe-Math.sin(ye)*ge},end:{x:d+Math.cos(ye)*ge,y:fe+Math.sin(ye)*ge},center:{x:d,y:fe},angle:ye,length:ie.value}}),ee=A(()=>{if(!g.value||!r.value)return null;const k=_.value;g.value.min_x,g.value.max_y,g.value.min_x,g.value.min_y;const G=U.value,ne=g.value.min_x,Z={x:G.x-Math.cos(k)*(G.x-ne),y:G.y-Math.sin(k)*(G.x-ne)},d=k+Math.PI/2,fe=ie.value/2,ye={x:Z.x-Math.cos(d)*fe,y:Z.y-Math.sin(d)*fe},ge={x:Z.x+Math.cos(d)*fe,y:Z.y+Math.sin(d)*fe};return[ye,ge,r.value.end,r.value.start]}),O=A(()=>{if(!r.value)return null;const k=50;return k/r.value.length,{distance:k,frontLine:r.value}}),b=A(()=>r.value?{distance:30,frontLine:r.value}:null),R=()=>{f.value&&(u.progress=0),u.isPlaying=!0,u.lastFrameTime=performance.now(),x()},y=()=>{u.isPlaying=!1,u.animationId&&(cancelAnimationFrame(u.animationId),u.animationId=null)},V=()=>{u.isPlaying?y():R()},D=k=>{u.progress=Math.max(0,Math.min(100,k))},re=()=>{D(0)},l=()=>{D(100)},S=()=>{D(u.progress+2)},$=()=>{D(u.progress-2)},v=k=>{u.direction=k%360,u.direction<0&&(u.direction+=360)},m=k=>{u.playbackSpeed=Math.max(.1,Math.min(10,k))},x=()=>{if(!u.isPlaying)return;const k=performance.now(),G=k-u.lastFrameTime;u.lastFrameTime=k;const ne=G/1e3*B.progressPerSecond*u.playbackSpeed,Z=u.progress+ne;Z>=100?(u.progress=100,u.isPlaying=!1):(u.progress=Z,u.animationId=requestAnimationFrame(x)),te&&te(u.progress)};let te=null;const ve=k=>{te=k};return tt(()=>{y()}),{state:u,isPlaying:A(()=>u.isPlaying),progress:A(()=>u.progress),direction:A(()=>u.direction),playbackSpeed:A(()=>u.playbackSpeed),frontLine:r,goafArea:ee,stressZone:O,reliefZone:b,currentDistance:L,remainingDistance:c,isComplete:f,play:R,pause:y,togglePlay:V,seek:D,skipToStart:re,skipToEnd:l,stepForward:S,stepBackward:$,setDirection:v,setPlaybackSpeed:m,onProgress:ve}}function gt(X={}){const{maxParticles:N=200,particleLife:B=2e3,emitRate:u=2}=X,L=Ne([]),c=[];let f=null;const _=()=>{for(let l=0;l<N+50;l++)c.push(g())};function g(){return{x:0,y:0,vx:0,vy:0,type:"stress",life:0,maxLife:B,birth:0,size:2,colorHue:0,colorSat:80,colorLight:60,active:!1}}function U(){for(let S=0;S<c.length;S++)if(!c[S].active)return c[S];const l=g();return c.push(l),l}function ie(l,S,$,v,m,x="stress"){l.x=S,l.y=$,l.vx=v,l.vy=m,l.type=x,l.life=1,l.maxLife=B+Math.random()*500-250,l.birth=Date.now(),l.size=2+Math.random()*2,l.active=!0,x==="stress"?l.colorHue=Math.random()*30:l.colorHue=200+Math.random()*40}const r=(l,S,$=1)=>{let v=0;for(let x=0;x<c.length;x++)c[x].active&&v++;if(v>=N)return;const m=.3;for(let x=0;x<u;x++){const te=U(),ve=Math.random(),k=l[0].x+(l[1].x-l[0].x)*ve,G=l[0].y+(l[1].y-l[0].y)*ve,ne=S.x*$+(Math.random()-.5)*m,Z=S.y*$+(Math.random()-.5)*m;ie(te,k,G,ne,Z,"stress")}O()},ee=(l,S=.5)=>{let $=0;for(let v=0;v<c.length;v++)c[v].active&&$++;if(!($>=N)){for(let v=0;v<Math.ceil(u/2);v++){const m=U(),x=l.minX+Math.random()*(l.maxX-l.minX),te=l.minY+Math.random()*(l.maxY-l.minY),ve=Math.random()*Math.PI*2,k=Math.cos(ve)*S,G=Math.sin(ve)*S;ie(m,x,te,k,G,"relief")}O()}};function O(){const l=[];for(let S=0;S<c.length;S++)c[S].active&&l.push(c[S]);L.value=l}const b=(l=.016)=>{const S=Date.now();for(let $=0;$<c.length;$++){const v=c[$];if(!v.active)continue;const m=S-v.birth;if(v.life=1-m/v.maxLife,v.life<=0){v.active=!1;continue}v.x+=v.vx*l,v.y+=v.vy*l,v.vx+=(Math.random()-.5)*.02,v.vy+=(Math.random()-.5)*.02,v.vx*=.99,v.vy*=.99}O()},R=l=>{const S=[],$=[];for(let v=0;v<L.value.length;v++){const m=L.value[v];m.type==="stress"?S.push(m):$.push(m)}for(let v=0;v<S.length;v++){const m=S[v],x=m.life*.6;l.fillStyle=`hsla(${m.colorHue}, ${m.colorSat}%, ${m.colorLight}%, ${x})`,l.beginPath(),l.arc(m.x,m.y,m.size*m.life,0,Math.PI*2),l.fill()}for(let v=0;v<$.length;v++){const m=$[v],x=m.life*.6;l.fillStyle=`hsla(${m.colorHue}, ${m.colorSat}%, ${m.colorLight}%, ${x})`,l.beginPath(),l.arc(m.x,m.y,m.size*m.life,0,Math.PI*2),l.fill()}},y=()=>{for(let l=0;l<c.length;l++)c[l].active=!1;L.value=[]},V=A(()=>L.value.length);_();const D=l=>{f&&cancelAnimationFrame(f);let S=performance.now();const $=()=>{const v=performance.now(),m=(v-S)/1e3;S=v,b(m),l(),f=requestAnimationFrame($)};f=requestAnimationFrame($)},re=()=>{f&&(cancelAnimationFrame(f),f=null)};return tt(()=>{re(),y()}),{particles:L,count:V,emitStressParticles:r,emitReliefParticles:ee,update:b,draw:R,clear:y,startAnimation:D,stopAnimation:re}}function hn(X={}){const{maxRipples:N=10,rippleSpeed:B=50,rippleInterval:u=800}=X,L=Ne([]),c=[];let f=0;const _=()=>{for(let b=0;b<N+2;b++)c.push({x:0,y:0,radius:0,maxRadius:100,life:0,speed:B,width:2,active:!1})};function g(){for(let R=0;R<c.length;R++)if(!c[R].active)return c[R];const b={x:0,y:0,radius:0,maxRadius:100,life:0,speed:B,width:2,active:!1};return c.push(b),b}function U(){const b=[];for(let R=0;R<c.length;R++)c[R].active&&b.push(c[R]);L.value=b}const ie=(b,R)=>{const y=Date.now();if(y-f<u)return;let V=0;for(let re=0;re<c.length;re++)c[re].active&&V++;if(V>=N)return;const D=g();D.x=b,D.y=R,D.radius=0,D.maxRadius=100+Math.random()*50,D.life=1,D.speed=B+Math.random()*20,D.width=2+Math.random()*2,D.active=!0,f=y,U()},r=(b=.016)=>{for(let R=0;R<c.length;R++){const y=c[R];y.active&&(y.radius+=y.speed*b,y.life=1-y.radius/y.maxRadius,y.life<=0&&(y.active=!1))}U()},ee=b=>{for(let R=0;R<L.value.length;R++){const y=L.value[R];b.beginPath(),b.arc(y.x,y.y,y.radius,0,Math.PI*2),b.strokeStyle=`rgba(239, 68, 68, ${y.life*.5})`,b.lineWidth=y.width*y.life,b.stroke()}},O=()=>{for(let b=0;b<c.length;b++)c[b].active=!1;L.value=[]};return _(),{ripples:L,emit:ie,update:r,draw:ee,clear:O}}const fn={class:"direction-control"},yn={class:"control-header"},pn={class:"value-display"},gn={class:"compass-container"},xn={class:"compass-ring"},bn={class:"compass-marks"},Mn={class:"quick-select"},kn=["onClick","title"],wn={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Cn=["d"],Pn={class:"fine-control"},_n=["value"],Sn={__name:"DirectionControl",props:{direction:{type:Number,default:0}},emits:["update:direction"],setup(X){const N=X,B=[{angle:0,label:"E"},{angle:45,label:"NE"},{angle:90,label:"N"},{angle:135,label:"NW"},{angle:180,label:"W"},{angle:225,label:"SW"},{angle:270,label:"S"},{angle:315,label:"SE"}],u=[{value:0,label:"向东 (0°)",icon:"M5 12h14M12 5l7 7-7 7"},{value:90,label:"向北 (90°)",icon:"M12 19V5M5 12l7-7 7 7"},{value:180,label:"向西 (180°)",icon:"M19 12H5M12 19l-7-7 7-7"},{value:270,label:"向南 (270°)",icon:"M12 5v14M19 12l-7 7-7-7"}],L=c=>{const f=Math.abs(N.direction-c);return f<=10||f>=350};return(c,f)=>(oe(),le("div",fn,[n("div",yn,[f[1]||(f[1]=n("span",{class:"label"},"推进方向",-1)),n("span",pn,Q(X.direction)+"°",1)]),n("div",gn,[n("div",xn,[n("div",bn,[(oe(),le(qe,null,Ue(B,_=>n("span",{key:_.angle,class:Be(["mark",{active:L(_.angle)}]),style:Fe({transform:`rotate(${_.angle}deg) translateX(-50%)`})},[n("span",{class:"mark-label",style:Fe({transform:`rotate(-${_.angle}deg)`})},Q(_.label),5)],6)),64))]),n("div",{class:"compass-arrow",style:Fe({transform:`rotate(${X.direction}deg)`})},[...f[2]||(f[2]=[n("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[n("path",{d:"M12 2L4.5 20L12 17L19.5 20L12 2Z"})],-1)])],4),n("div",{class:"compass-center",style:Fe({transform:`rotate(${X.direction}deg)`})},[...f[3]||(f[3]=[n("div",{class:"direction-line"},null,-1)])],4)])]),n("div",Mn,[(oe(),le(qe,null,Ue(u,_=>n("button",{key:_.value,class:Be(["quick-btn",{active:X.direction===_.value}]),onClick:g=>c.$emit("update:direction",_.value),title:_.label},[(oe(),le("svg",wn,[n("path",{d:_.icon},null,8,Cn)]))],10,kn)),64))]),n("div",Pn,[n("input",{type:"range",value:X.direction,onInput:f[0]||(f[0]=_=>c.$emit("update:direction",Number(_.target.value))),min:"0",max:"360",step:"1",class:"direction-slider"},null,40,_n),f[4]||(f[4]=n("div",{class:"slider-labels"},[n("span",null,"0°"),n("span",null,"180°"),n("span",null,"360°")],-1))])]))}},Tn=xt(Sn,[["__scopeId","data-v-e9ee0388"]]),Dn={class:"mpi-pro-page"},Rn={class:"top-nav"},Ln={class:"nav-left"},$n=["value"],In={key:0,class:"mini-stats"},Fn={class:"mini-stat"},Bn={class:"mini-stat danger"},En={class:"nav-center"},An={key:0,class:"control-panel-overlay"},Xn={class:"control-panel"},Yn={class:"control-section"},Wn={class:"control-grid"},Vn={class:"control-item"},Hn={class:"range-wrapper"},zn={class:"range-value"},Nn={class:"control-section"},qn={class:"layer-toggles"},Un={class:"layer-toggle"},Gn={class:"layer-toggle"},Kn={class:"layer-toggle"},On={class:"layer-toggle"},Zn={class:"layer-toggle"},jn={class:"control-section"},Jn={key:0,class:"loading-overlay"},Qn={class:"playback-bar"},es={class:"playback-main"},ts={key:0,viewBox:"0 0 24 24",fill:"currentColor"},ns={key:1,viewBox:"0 0 24 24",fill:"currentColor"},ss={class:"progress-section"},as=["value"],os={class:"progress-info"},ls={class:"speed-control"},is=["onClick"],rs={key:0,class:"mini-dashboard"},cs={class:"dash-item"},us={class:"dash-value stress"},ds={class:"dash-item"},vs={class:"dash-value relief"},ms={class:"dash-item"},hs={class:"dash-value phase"},fs={class:"dash-item"},ys={class:"dash-value"},ps={class:"tooltip-val"},gs={class:"tooltip-xy"},xs=50,bs={__name:"MpiHeatmapPro",setup(X){const N=W(!1),B=W([]),u=W(""),L=W(50),c=W({}),f=W(null),_=W([]),g=Ne([]),U=W(!1),ie=W(0),r=mn(f,{totalDistance:500,frameRate:60,progressPerSecond:10}),ee=gt({maxParticles:80,emitRate:1.5}),O=gt({maxParticles:60,emitRate:1}),b=hn({maxRipples:6,rippleSpeed:60,rippleInterval:600}),R=W(0),y=et({workfaces:!0,contours:!1,contourLabels:!1,boreholes:!0,grid:!0,gradedBands:!0}),V=W(null),D=W(null),re=W(null),l=W(null),S=W(null),$=W(null),v=W(!1),m=Ne(null),x=W(null),te=W(null),ve=W({x:0,y:0}),k=an(),G=new Map,ne=new Map,Z=["#22c55e","#84cc16","#eab308","#f97316","#ef4444","#7c2d12"],d=et({x:0,y:0,scale:1,isDragging:!1,lastX:0,lastY:0}),fe=A(()=>!!m.value),ye=A(()=>({left:`${ve.value.x+15}px`,top:`${ve.value.y+15}px`})),ge=["#4e79a7","#9bb7c7","#f6f0a4","#f4a261","#d62828"],Ge=A(()=>{if(!c.value||!Number.isFinite(c.value.min)||!Number.isFinite(c.value.max))return[];const t=c.value.min,e=c.value.max;if(t===e)return[t];const s=(e-t)/5;return[t+s,t+s*2,t+s*3,t+s*4]}),nt=()=>{U.value=!U.value},bt=()=>{m.value=null,g.value=[],x.value=null,c.value={},ne.clear(),r.seek(0),u.value&&Ke()},Mt=()=>{u.value&&Ke()},kt=A(()=>{const t=r.progress.value;return t<15?0:t<30?1:t<70?2:t<90?3:4}),wt=["初采","初压","推进","周压","收尾"],Ct=A(()=>{const t=r.progress.value,e=40+t*.3,s=20*Math.sin(t/100*Math.PI*4);return Math.min(100,Math.max(0,e+s))}),Pt=A(()=>{const t=r.progress.value;return Math.min(95,t*.8+10)}),_t=()=>Te(this,null,function*(){try{const{data:t}=yield rn();B.value=t.seams||[],B.value.length&&(u.value=B.value[0].name,yield Ke()),_.value.length===0&&x.value&&St()}catch(t){console.error(t),k.add("加载煤层失败","error")}}),St=()=>{if(!x.value)return;const{min_x:t,max_x:e,min_y:s,max_y:o}=x.value,a=e-t,i=o-s,p={id:"demo-workface",name:"演示工作面",type:"polygon",bounds:{min_x:t+a*.1,max_x:t+a*.35,min_y:s+i*.3,max_y:s+i*.7},points:[[t+a*.1,s+i*.3],[t+a*.35,s+i*.3],[t+a*.35,s+i*.7],[t+a*.1,s+i*.7]]};_.value.push(p),f.value=p,k.add("已创建演示工作面","success")},Tt=t=>Te(this,null,function*(){if(!t)return null;if(G.has(t))return G.get(t);try{const{data:e}=yield vn(t);return G.set(t,e),e}catch(e){return null}}),Dt=t=>Te(this,null,function*(){var s,o;const e=[];for(const a of t){const i=a.layers||[],p=i.find(w=>w.name===u.value),E=i.filter(w=>w.name!==u.value),F=[];for(const w of E){const h=yield Tt(w.name);F.push({thickness:w.thickness||0,name:w.name,density:h==null?void 0:h.density,elastic_modulus:h==null?void 0:h.elastic_modulus,compressive_strength:h==null?void 0:h.compressive_strength,tensile_strength:h==null?void 0:h.tensile_strength})}const T=(o=(s=a.seam_top_depth)!=null?s:a.total_overburden_thickness)!=null?o:0;e.push({x:a.x,y:a.y,borehole:a.name,thickness:(p==null?void 0:p.thickness)||0,burial_depth:T,strata:F})}return e}),Ke=()=>Te(this,null,function*(){var t;if(u.value){N.value=!0;try{const{data:e}=yield un(u.value);if(!((t=e.boreholes)!=null&&t.length))throw new Error("无钻孔数据");g.value=e.boreholes;const s=yield Dt(e.boreholes),o=yield dn(s,L.value,"idw",null,null);m.value=o.data.grid,x.value=o.data.bounds,c.value=o.data.statistics,st(),requestAnimationFrame(Ee)}catch(e){console.error(e),k.add(e.message||"计算失败","error")}finally{N.value=!1}}}),Rt=(t,e,s)=>{if(!Number.isFinite(t))return[0,0,0,0];const o=s-e||1,i=Math.max(0,Math.min(1,(t-e)/o))*(Z.length-1),p=Math.floor(i),E=i-p,F=h=>{const C=parseInt(h.slice(1),16);return[C>>16&255,C>>8&255,C&255]},T=F(Z[Math.min(p,Z.length-1)]),w=F(Z[Math.min(p+1,Z.length-1)]);return[Math.round(T[0]+(w[0]-T[0])*E),Math.round(T[1]+(w[1]-T[1])*E),Math.round(T[2]+(w[2]-T[2])*E),255]},Lt=(t,e,s)=>{if(!Number.isFinite(t)||e.length<4)return[0,0,0,0];let o=0;t<=e[0]?o=0:t<=e[1]?o=1:t<=e[2]?o=2:t<=e[3]?o=3:o=4;const a=s[Math.min(o,s.length-1)],i=parseInt(a.slice(1),16);return[i>>16&255,i>>8&255,i&255,255]},Ee=()=>{m.value&&(Oe(D.value),Oe(re.value),Oe(l.value),$t(),Bt(),r.progress.value>0&&Ze(r.progress.value))},Oe=t=>{if(!t||!V.value)return;const e=V.value.getBoundingClientRect(),s=window.devicePixelRatio||1,o=Math.round(e.width),a=Math.round(e.height);t.style.width=`${o}px`,t.style.height=`${a}px`,t.width=Math.round(o*s),t.height=Math.round(a*s);const i=t.getContext("2d");i&&(i.setTransform(s,0,0,s,0,0),i.imageSmoothingEnabled=!1)},I=(t,e)=>{if(!x.value)return{x:0,y:0};const{min_x:s,max_y:o}=x.value,a=1,i=(t-s)*a,p=(o-e)*a;return{x:i*d.scale+d.x,y:p*d.scale+d.y}},Ce=(t,e)=>{if(!x.value)return{x:0,y:0};const{min_x:s,max_y:o}=x.value,a=(t-d.x)/d.scale,i=(e-d.y)/d.scale;return{x:s+a,y:o-i}},$t=()=>{var z;const t=(z=D.value)==null?void 0:z.getContext("2d");if(!t||!m.value)return;const e=`${d.scale.toFixed(2)}-${d.x.toFixed(0)}-${d.y.toFixed(0)}`;if(v.value&&$.value&&$.value.key===e){t.clearRect(0,0,D.value.width,D.value.height),t.drawImage($.value,0,0);return}t.clearRect(0,0,D.value.width,D.value.height);const s=m.value,o=s.length,a=s[0].length,{min_x:i,max_x:p,min_y:E,max_y:F}=x.value,T=(p-i)/a,w=(F-E)/o,h=c.value.min||0,C=c.value.max||100,q=Ge.value,K=D.value.width,ue=D.value.height,j=Ce(0,0),ce=Ce(K,ue),se=1,Y=Math.max(0,Math.floor((j.x-i)/T)-se),J=Math.min(a-1,Math.ceil((ce.x-i)/T)+se),P=Math.max(0,Math.floor((F-ce.y)/w)-se),M=Math.min(o-1,Math.ceil((F-j.y)/w)+se);for(let me=P;me<=M;me++)for(let be=Y;be<=J;be++){const _e=s[me][be];if(_e===null)continue;const Re=i+be*T,Le=F-me*w,he=I(Re,Le),Me=I(Re+T,Le-w),Ae=Me.x-he.x,Se=Me.y-he.y;if(he.x>K||Me.x<0||he.y>ue||Me.y<0)continue;const de=y.gradedBands?Lt(_e,q,ge):Rt(_e,h,C);t.fillStyle=`rgb(${de[0]},${de[1]},${de[2]})`,t.fillRect(Math.floor(he.x),Math.floor(he.y),Math.ceil(Ae)+1,Math.ceil(Se)+1)}const H=document.createElement("canvas");H.width=D.value.width,H.height=D.value.height,H.key=e,H.getContext("2d").drawImage(D.value,0,0),$.value=nn(H),v.value=!0},It=t=>{var ue;if(!m.value||!x.value||!c.value)return;const e=m.value,s=e.length,o=e[0].length,a=new Float64Array(s*o);for(let j=0;j<s;j++)for(let ce=0;ce<o;ce++)a[j*o+ce]=(ue=e[j][ce])!=null?ue:-9999;const i=c.value.min||0,p=c.value.max||100,E=Ge.value.length===4?Ge.value:on(i,p,(p-i)/5),F=ln().size([o,s]).thresholds(E)(a);t.save(),t.lineWidth=2,t.strokeStyle="rgba(255, 255, 255, 0.75)";const{min_x:T,max_x:w,min_y:h,max_y:C}=x.value,q=(w-T)/o,K=(C-h)/s;F.forEach(j=>{t.beginPath(),j.coordinates.forEach(ce=>{ce.forEach(se=>{se.forEach((Y,J)=>{const P=Y[0],M=Y[1],H=T+P*q,z=C-M*K,me=I(H,z);J===0?t.moveTo(me.x,me.y):t.lineTo(me.x,me.y)}),t.closePath()})}),t.stroke()}),y.contourLabels&&(t.fillStyle="rgba(255,255,255,0.8)",t.font="12px JetBrains Mono, monospace",t.textAlign="center",t.textBaseline="middle",F.forEach((j,ce)=>{if(ce%2!==0)return;const se=j.coordinates[0];if(!se||!se[0]||!se[0][0])return;const Y=se[0][Math.floor(se[0].length/2)];if(!Y)return;const J=T+Y[0]*q,P=C-Y[1]*K,M=I(J,P);t.fillText(j.value.toFixed(1),M.x,M.y)})),t.restore()},Ft=t=>{var e;if((e=g.value)!=null&&e.length){t.save(),t.font="11px JetBrains Mono, monospace",t.textAlign="center",t.textBaseline="middle";for(const s of g.value){const o=I(s.x,s.y),a=50;o.x<-a||o.x>l.value.width+a||o.y<-a||o.y>l.value.height+a||(t.beginPath(),t.arc(o.x,o.y,6,0,Math.PI*2),t.fillStyle="rgba(239, 68, 68, 0.9)",t.fill(),t.strokeStyle="#fff",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(o.x-3,o.y),t.lineTo(o.x+3,o.y),t.moveTo(o.x,o.y-3),t.lineTo(o.x,o.y+3),t.strokeStyle="#fff",t.lineWidth=1.5,t.stroke(),t.fillStyle="rgba(30, 41, 59, 0.85)",t.fillRect(o.x-25,o.y+10,50,16),t.strokeStyle="rgba(148, 163, 184, 0.5)",t.lineWidth=1,t.strokeRect(o.x-25,o.y+10,50,16),t.fillStyle="#fff",t.fillText(s.name||"",o.x,o.y+18))}t.restore()}},Bt=()=>{var e;const t=(e=l.value)==null?void 0:e.getContext("2d");t&&(t.clearRect(0,0,l.value.width,l.value.height),y.grid&&Et(t),y.contours&&It(t),y.boreholes&&Ft(t),y.workfaces&&_.value.forEach(s=>{if(t.beginPath(),s.type==="polygon"&&s.points)s.points.forEach((o,a)=>{const i=I(o[0],o[1]);a===0?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y)});else if(s.bounds){const o=I(s.bounds.min_x,s.bounds.max_y),a=I(s.bounds.max_x,s.bounds.max_y),i=I(s.bounds.max_x,s.bounds.min_y),p=I(s.bounds.min_x,s.bounds.min_y);t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.lineTo(i.x,i.y),t.lineTo(p.x,p.y)}t.closePath(),t.strokeStyle=s===f.value?"#facc15":"#fff",t.lineWidth=s===f.value?3:2,t.stroke(),s===f.value&&(t.fillStyle="rgba(250, 204, 21, 0.1)",t.fill())}))},Et=t=>{if(!x.value||!V.value)return;const e=V.value.getBoundingClientRect(),s=e.width,o=e.height,i=Math.max(20,Math.round(100/d.scale/10)*10);t.save(),t.strokeStyle="rgba(148, 163, 184, 0.15)",t.lineWidth=1;const p=Ce(0,0),E=Ce(s,o),F=Math.floor(Math.min(p.x,E.x)/i)*i,T=Math.ceil(Math.max(p.x,E.x)/i)*i,w=Math.floor(Math.min(p.y,E.y)/i)*i,h=Math.ceil(Math.max(p.y,E.y)/i)*i;for(let C=F;C<=T;C+=i){const q=I(C,w),K=I(C,h);t.beginPath(),t.moveTo(q.x,q.y),t.lineTo(K.x,K.y),t.stroke()}for(let C=w;C<=h;C+=i){const q=I(F,C),K=I(T,C);t.beginPath(),t.moveTo(q.x,q.y),t.lineTo(K.x,K.y),t.stroke()}t.restore()},Ze=t=>{var ht;const e=(ht=re.value)==null?void 0:ht.getContext("2d");if(!e||!f.value)return;e.clearRect(0,0,re.value.width,re.value.height);let s=f.value.bounds;if(!s&&f.value.points){const pe=f.value.points.map(xe=>xe[0]),ke=f.value.points.map(xe=>xe[1]);s={min_x:Math.min(...pe),max_x:Math.max(...pe),min_y:Math.min(...ke),max_y:Math.max(...ke)}}if(!s)return;const o=(ie.value-90)*Math.PI/180,a=s.max_y-s.min_y,i=s.max_x-s.min_x,p=(s.min_x+s.max_x)/2,E=(s.min_y+s.max_y)/2,F=i*(t/100),T=p+Math.cos(o)*F,w=E+Math.sin(o)*F,h=o+Math.PI/2,C=a/2,q={x:T-Math.cos(h)*C,y:w-Math.sin(h)*C},K={x:T+Math.cos(h)*C,y:w+Math.sin(h)*C},ue=p-Math.cos(o)*(p-s.min_x),j=E-Math.sin(o)*(p-s.min_x),ce={x:ue-Math.cos(h)*C,y:j-Math.sin(h)*C},se={x:ue+Math.cos(h)*C,y:j+Math.sin(h)*C},Y=I(ce.x,ce.y),J=I(se.x,se.y),P=I(q.x,q.y),M=I(K.x,K.y),H=I(T,w);e.save();const z=e.createLinearGradient((Y.x+J.x)/2,(Y.y+J.y)/2,(P.x+M.x)/2,(P.y+M.y)/2);t<20?(z.addColorStop(0,"rgba(35, 35, 35, 0.9)"),z.addColorStop(1,"rgba(40, 40, 40, 0.85)")):t<40?(z.addColorStop(0,"rgba(40, 40, 40, 0.85)"),z.addColorStop(.5,"rgba(38, 38, 38, 0.82)"),z.addColorStop(1,"rgba(42, 42, 42, 0.8)")):t<60?(z.addColorStop(0,"rgba(45, 45, 45, 0.8)"),z.addColorStop(.5,"rgba(40, 40, 40, 0.78)"),z.addColorStop(1,"rgba(43, 43, 43, 0.75)")):t<80?(z.addColorStop(0,"rgba(48, 48, 48, 0.75)"),z.addColorStop(.5,"rgba(42, 42, 42, 0.73)"),z.addColorStop(1,"rgba(45, 45, 45, 0.7)")):(z.addColorStop(0,"rgba(50, 50, 50, 0.72)"),z.addColorStop(.5,"rgba(44, 44, 44, 0.7)"),z.addColorStop(1,"rgba(47, 47, 47, 0.68)")),e.fillStyle=z,e.beginPath(),e.moveTo(Y.x,Y.y),e.lineTo(J.x,J.y),e.lineTo(M.x,M.y),e.lineTo(P.x,P.y),e.closePath(),e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.03)",e.lineWidth=1;const me=20,be=Math.hypot(M.x-J.x,M.y-J.y);Math.hypot(M.x-P.x,M.y-P.y);for(let pe=0;pe<be;pe+=me){const ke=pe/be,xe=Y.x+(P.x-Y.x)*ke,ft=Y.y+(P.y-Y.y)*ke;e.beginPath(),e.moveTo(xe,ft),e.lineTo(xe+M.x-P.x,ft+M.y-P.y),e.stroke()}const _e=i*.12,Re=T+Math.cos(o)*_e,Le=w+Math.sin(o)*_e,he=a*.58,Me={x:Re-Math.cos(h)*he,y:Le-Math.sin(h)*he},Ae={x:Re+Math.cos(h)*he,y:Le+Math.sin(h)*he},Se=I(Me.x,Me.y),de=I(Ae.x,Ae.y),Gt=Date.now()/800%2,Kt=Date.now()/1200%2,ot=.5+.2*Math.sin(Gt*Math.PI),lt=.4+.15*Math.sin(Kt*Math.PI),Xe=e.createRadialGradient(H.x,H.y,0,H.x,H.y,Math.hypot(de.x-H.x,de.y-H.y)*1.5);Xe.addColorStop(0,`rgba(239, 68, 68, ${ot*.3})`),Xe.addColorStop(.5,`rgba(239, 68, 68, ${ot*.15})`),Xe.addColorStop(1,"rgba(239, 68, 68, 0)"),e.fillStyle=Xe,e.beginPath(),e.arc(H.x,H.y,Math.hypot(de.x-H.x,de.y-H.y)*1.5,0,Math.PI*2),e.fill();const Ye=e.createLinearGradient((P.x+M.x)/2,(P.y+M.y)/2,(Se.x+de.x)/2,(Se.y+de.y)/2);Ye.addColorStop(0,`rgba(220, 38, 38, ${lt*.7})`),Ye.addColorStop(.5,`rgba(239, 68, 68, ${lt*.4})`),Ye.addColorStop(1,"rgba(239, 68, 68, 0)"),e.fillStyle=Ye,e.beginPath(),e.moveTo(P.x,P.y),e.lineTo(M.x,M.y),e.lineTo(de.x,de.y),e.lineTo(Se.x,Se.y),e.closePath(),e.fill();const it=i*.1,rt=T-Math.cos(o)*it,ct=w-Math.sin(o)*it,We=a*.52,ut={x:rt-Math.cos(h)*We,y:ct-Math.sin(h)*We},dt={x:rt+Math.cos(h)*We,y:ct+Math.sin(h)*We},Ve=I(ut.x,ut.y),He=I(dt.x,dt.y),Ot=Date.now()/2e3%2,vt=.4+.1*Math.sin(Ot*Math.PI),ze=e.createLinearGradient((Ve.x+He.x)/2,(Ve.y+He.y)/2,(P.x+M.x)/2,(P.y+M.y)/2);if(ze.addColorStop(0,`rgba(59, 130, 246, ${vt*.5})`),ze.addColorStop(.7,`rgba(96, 165, 250, ${vt*.3})`),ze.addColorStop(1,"rgba(59, 130, 246, 0)"),e.fillStyle=ze,e.beginPath(),e.moveTo(Ve.x,Ve.y),e.lineTo(He.x,He.y),e.lineTo(P.x,P.y),e.lineTo(M.x,M.y),e.closePath(),e.fill(),(r.isPlaying.value||t>0)&&(b.update(.016),b.draw(e),r.isPlaying.value&&Math.random()<.02&&b.emit(H.x,H.y)),r.isPlaying.value&&t>0){const pe=Date.now();if(pe-R.value>xs){const ke={x:Math.cos(o),y:Math.sin(o)};ee.emitStressParticles([P,M],ke,2);const xe={minX:Math.min(Y.x,J.x,P.x,M.x),maxX:Math.max(Y.x,J.x,P.x,M.x),minY:Math.min(Y.y,J.y,P.y,M.y),maxY:Math.max(Y.y,J.y,P.y,M.y)};O.emitReliefParticles(xe,.5),R.value=pe}ee.update(.016),ee.draw(e),O.update(.016),O.draw(e)}else t>0&&(ee.update(.016),O.update(.016),ee.draw(e),O.draw(e));e.strokeStyle="#facc15",e.lineWidth=3,e.lineCap="round",e.beginPath(),e.moveTo(P.x,P.y),e.lineTo(M.x,M.y),e.stroke(),e.strokeStyle="rgba(250, 204, 21, 0.4)",e.lineWidth=6,e.beginPath(),e.moveTo(P.x,P.y),e.lineTo(M.x,M.y),e.stroke(),e.restore(),e.save();const Zt=(ue+T)/2,jt=(j+w)/2,mt=I(Zt,jt);e.translate(mt.x,mt.y),e.rotate(ie.value*Math.PI/180),e.fillStyle="rgba(255, 255, 255, 0.8)",e.beginPath(),e.moveTo(-10,0),e.lineTo(6,-6),e.lineTo(6,6),e.closePath(),e.fill(),e.shadowColor="rgba(255, 255, 255, 0.5)",e.shadowBlur=8,e.fill(),e.restore()},st=()=>{if(!x.value||!V.value)return;const{min_x:t,max_x:e,min_y:s,max_y:o}=x.value,a=e-t,i=o-s,p=V.value.getBoundingClientRect(),E=p.width,F=p.height,T=E/a,w=F/i,h=Math.min(T,w)*.9;d.scale=h;const C=(t+e)/2,q=(s+o)/2;d.x=E/2-(C-t)*h,d.y=F/2-(o-q)*h,De()},At=t=>{V.value&&(d.isDragging=!0,d.lastX=t.clientX,d.lastY=t.clientY,d.startX=t.clientX,d.startY=t.clientY)},Xt=t=>{if(!V.value)return;const e=V.value.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;ve.value={x:s,y:o};const a=Ce(s,o);if(m.value&&x.value){const{min_x:E,max_x:F,min_y:T,max_y:w}=x.value,h=m.value.length,C=m.value[0].length,q=Math.floor((a.x-E)/((F-E)/C)),K=Math.floor((w-a.y)/((w-T)/h));if(K>=0&&K<h&&q>=0&&q<C){const ue=m.value[K][q];ue!==null?te.value={x:a.x,y:a.y,value:ue}:te.value=null}else te.value=null}if(!d.isDragging)return;const i=t.clientX-d.lastX,p=t.clientY-d.lastY;d.x+=i,d.y+=p,d.lastX=t.clientX,d.lastY=t.clientY,De()},Yt=t=>{const e=Math.hypot(t.clientX-d.startX,t.clientY-d.startY);d.isDragging&&e<5&&Wt(t),d.isDragging=!1},Wt=t=>{if(!V.value)return;const e=V.value.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top,a=Ce(s,o),i=_.value.find(p=>p.bounds?a.x>=p.bounds.min_x&&a.x<=p.bounds.max_x&&a.y>=p.bounds.min_y&&a.y<=p.bounds.max_y:!1);i&&(f.value=i,Ee())},Vt=t=>{t.preventDefault();const s=-t.deltaY*.001,o=d.scale*(1+s);d.scale=Math.max(.1,Math.min(50,o)),De()},Pe=W(null);let je=!1;const De=()=>{je||(je=!0,requestAnimationFrame(()=>{Ee(),je=!1}))};Qe(()=>r.progress.value,t=>{Ze(t)}),Qe(()=>r.isPlaying.value,t=>{t&&Ht()});let Je=!1;Qe(()=>[d.scale,d.x,d.y],()=>{Je||(Je=!0,requestAnimationFrame(()=>{v.value=!1,Je=!1}))},{flush:"sync"});const Ht=()=>{Pe.value&&cancelAnimationFrame(Pe.value);const t=()=>{r.isPlaying.value&&r.progress.value<100?(Ze(r.progress.value),Pe.value=requestAnimationFrame(t)):r.progress.value>=100&&(r.isPlaying.value=!1)};Pe.value=requestAnimationFrame(t)},at=t=>{if(!(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"||t.target.tagName==="SELECT"))switch(t.code){case"Space":t.preventDefault(),r.togglePlay();break;case"ArrowLeft":t.preventDefault(),t.shiftKey?r.skipToStart():r.stepBackward();break;case"ArrowRight":t.preventDefault(),t.shiftKey?r.skipToEnd():r.stepForward();break;case"ArrowUp":t.preventDefault(),r.setPlaybackSpeed(Math.min(5,r.playbackSpeed.value+.5));break;case"ArrowDown":t.preventDefault(),r.setPlaybackSpeed(Math.max(.5,r.playbackSpeed.value-.5));break;case"KeyR":t.preventDefault(),r.seek(0),ee.clear(),O.clear(),b.clear();break;case"Digit1":t.preventDefault(),r.setPlaybackSpeed(1);break;case"Digit2":t.preventDefault(),r.setPlaybackSpeed(2);break;case"Digit5":t.preventDefault(),r.setPlaybackSpeed(5);break}};tt(()=>{Pe.value&&cancelAnimationFrame(Pe.value),r.pause(),ee.clear(),O.clear(),b.clear(),ee.stopAnimation(),O.stopAnimation(),window.removeEventListener("keydown",at)}),Jt(()=>{_t();const t=V.value;t.addEventListener("mousedown",At),window.addEventListener("mousemove",Xt),window.addEventListener("mouseup",Yt),t.addEventListener("wheel",Vt,{passive:!1}),window.addEventListener("keydown",at)});const zt=()=>{var t;return(t=S.value)==null?void 0:t.click()},Nt=t=>Te(this,null,function*(){const e=t.target.files[0];if(!e)return;const{data:s}=yield cn(e);_.value=[..._.value,...s.workfaces],s.workfaces.length&&(f.value=s.workfaces[0],r.seek(0),ee.clear(),O.clear(),b.clear()),Ee()}),qt=()=>{d.scale=Math.min(50,d.scale*1.15),De()},Ut=()=>{d.scale=Math.max(.1,d.scale/1.15),De()};return(t,e)=>{var s,o;return oe(),le("div",Dn,[n("nav",Rn,[n("div",Ln,[n("button",{class:"back-btn-mini",onClick:e[0]||(e[0]=a=>t.$router.back()),title:"返回"},[...e[13]||(e[13]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1)])]),e[16]||(e[16]=n("span",{class:"nav-title"},"MPI 数值模拟",-1)),e[17]||(e[17]=n("div",{class:"nav-separator"},null,-1)),we(n("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),onChange:bt,class:"nav-select"},[(oe(!0),le(qe,null,Ue(B.value,a=>(oe(),le("option",{key:a.name,value:a.name},Q(a.name),9,$n))),128))],544),[[Qt,u.value]]),fe.value?(oe(),le("div",In,[n("span",Fn,[e[14]||(e[14]=yt("均值: ",-1)),n("b",null,Q((s=c.value.mean)==null?void 0:s.toFixed(1)),1)]),n("span",Bn,[e[15]||(e[15]=yt("风险: ",-1)),n("b",null,Q((o=c.value.min)==null?void 0:o.toFixed(1)),1)])])):$e("",!0)]),n("div",En,[n("button",{class:Be(["nav-tool",{active:U.value}]),onClick:nt,title:"控制面板"},[...e[18]||(e[18]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("circle",{cx:"12",cy:"12",r:"3"}),n("path",{d:"M12 1v6m0 6v6m4.24-13.24l-4.24 4.24m0 5.66l4.24 4.24M1 12h6m6 0h6m13.24 4.24l-4.24-4.24m-5.66 0l-4.24-4.24"})],-1)])],2)]),n("div",{class:"nav-right"},[n("button",{class:"nav-btn",onClick:zt,title:"导入工作面"},[...e[19]||(e[19]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)])]),n("button",{class:"nav-btn",onClick:st,title:"适配视图"},[...e[20]||(e[20]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"})],-1)])]),n("button",{class:"nav-btn",onClick:qt,title:"放大"},[...e[21]||(e[21]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("circle",{cx:"11",cy:"11",r:"8"}),n("path",{d:"M21 21l-4.35-4.35M11 8v6M8 11h6"})],-1)])]),n("button",{class:"nav-btn",onClick:Ut,title:"缩小"},[...e[22]||(e[22]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("circle",{cx:"11",cy:"11",r:"8"}),n("path",{d:"M21 21l-4.35-4.35M8 11h6"})],-1)])])]),n("input",{ref_key:"fileInput",ref:S,type:"file",style:{display:"none"},onChange:Nt,accept:".csv,.json,.txt"},null,544)]),pt(tn,{name:"panel-slide"},{default:en(()=>[U.value?(oe(),le("div",An,[n("div",Xn,[n("div",Yn,[e[24]||(e[24]=n("h4",null,"视图设置",-1)),n("div",Wn,[n("div",Vn,[e[23]||(e[23]=n("label",null,"网格精度 (越小越精细)",-1)),n("div",Hn,[we(n("input",{type:"range","onUpdate:modelValue":e[2]||(e[2]=a=>L.value=a),min:"20",max:"100",step:"5",onChange:Mt,class:"range-input"},null,544),[[sn,L.value,void 0,{number:!0}]]),n("span",zn,Q(L.value)+"m",1)])])])]),n("div",Nn,[e[30]||(e[30]=n("h4",null,"图层",-1)),n("div",qn,[n("label",Un,[we(n("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>y.workfaces=a)},null,512),[[Ie,y.workfaces]]),e[25]||(e[25]=n("span",null,"工作面",-1))]),n("label",Gn,[we(n("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>y.contours=a)},null,512),[[Ie,y.contours]]),e[26]||(e[26]=n("span",null,"等值线",-1))]),n("label",Kn,[we(n("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>y.grid=a)},null,512),[[Ie,y.grid]]),e[27]||(e[27]=n("span",null,"网格",-1))]),n("label",On,[we(n("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>y.boreholes=a)},null,512),[[Ie,y.boreholes]]),e[28]||(e[28]=n("span",null,"钻孔",-1))]),n("label",Zn,[we(n("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=a=>y.gradedBands=a)},null,512),[[Ie,y.gradedBands]]),e[29]||(e[29]=n("span",null,"分级带",-1))])])]),n("div",jn,[e[31]||(e[31]=n("h4",null,"推进方向",-1)),pt(Tn,{direction:ie.value,"onUpdate:direction":[e[8]||(e[8]=a=>ie.value=a),ae(r).setDirection]},null,8,["direction","onUpdate:direction"])]),e[33]||(e[33]=n("div",{class:"control-section"},[n("h4",null,"图例"),n("div",{class:"mini-legend"},[n("div",{class:"legend-gradient"}),n("div",{class:"legend-labels"},[n("span",null,"低风险"),n("span",null,"高风险")])])],-1)),n("button",{class:"panel-close",onClick:nt},[...e[32]||(e[32]=[n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])])])):$e("",!0)]),_:1}),n("div",{ref_key:"stageContainer",ref:V,class:"stage-container"},[N.value?(oe(),le("div",Jn,[...e[34]||(e[34]=[n("div",{class:"loading-spinner"},null,-1),n("div",{class:"loading-text"},"全域数据计算中...",-1)])])):$e("",!0),n("canvas",{ref_key:"bgCanvas",ref:D,class:"layer-canvas layer-bg"},null,512),n("canvas",{ref_key:"dynamicCanvas",ref:re,class:"layer-canvas layer-dynamic"},null,512),n("canvas",{ref_key:"overlayCanvas",ref:l,class:"layer-canvas layer-overlay"},null,512)],512),n("div",Qn,[n("div",es,[n("button",{class:Be(["play-btn-mini",{playing:ae(r).isPlaying.value}]),onClick:e[9]||(e[9]=(...a)=>ae(r).togglePlay&&ae(r).togglePlay(...a)),title:"播放/暂停"},[ae(r).isPlaying.value?(oe(),le("svg",ns,[...e[36]||(e[36]=[n("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},null,-1)])])):(oe(),le("svg",ts,[...e[35]||(e[35]=[n("path",{d:"M8 5v14l11-7z"},null,-1)])]))],2),n("div",ss,[n("input",{type:"range",value:ae(r).progress.value,onInput:e[10]||(e[10]=a=>ae(r).seek(Number(a.target.value))),min:"0",max:"100",step:"0.1",class:"progress-slider"},null,40,as),n("div",os,[n("span",null,Q(Math.round(ae(r).progress.value))+"%",1),n("span",null,Q((ae(r).progress.value/100*500).toFixed(0))+"m",1)])]),n("div",ls,[(oe(),le(qe,null,Ue([.5,1,2,5],a=>n("button",{key:a,class:Be(["speed-btn",{active:ae(r).playbackSpeed.value===a}]),onClick:i=>ae(r).setPlaybackSpeed(a)},Q(a)+"x",11,is)),64))]),n("button",{class:"step-btn",onClick:e[11]||(e[11]=(...a)=>ae(r).stepBackward&&ae(r).stepBackward(...a)),title:"后退"},[...e[37]||(e[37]=[n("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[n("path",{d:"M6 6h2v12H6zm3.5 6l8.5-6V12z"})],-1)])]),n("button",{class:"step-btn",onClick:e[12]||(e[12]=(...a)=>ae(r).stepForward&&ae(r).stepForward(...a)),title:"前进"},[...e[38]||(e[38]=[n("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[n("path",{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"})],-1)])])]),f.value?(oe(),le("div",rs,[n("div",cs,[e[39]||(e[39]=n("span",{class:"dash-label"},"应力",-1)),n("span",us,Q(Ct.value.toFixed(0))+"%",1)]),n("div",ds,[e[40]||(e[40]=n("span",{class:"dash-label"},"卸压",-1)),n("span",vs,Q(Pt.value.toFixed(0))+"%",1)]),n("div",ms,[e[41]||(e[41]=n("span",{class:"dash-label"},"阶段",-1)),n("span",hs,Q(wt[kt.value]),1)]),n("div",fs,[e[42]||(e[42]=n("span",{class:"dash-label"},"方向",-1)),n("span",ys,Q(ie.value)+"°",1)])])):$e("",!0)]),e[43]||(e[43]=n("div",{class:"floating-hint"}," 拖拽移动 · 滚轮缩放 · 空格播放 · R 重置 ",-1)),te.value?(oe(),le("div",{key:0,class:"hover-tooltip",style:Fe(ye.value)},[n("div",ps,Q(te.value.value.toFixed(2)),1),n("div",gs,"X: "+Q(te.value.x.toFixed(0))+" Y: "+Q(te.value.y.toFixed(0)),1)],4)):$e("",!0)])}}},Ss=xt(bs,[["__scopeId","data-v-3eac479d"]]);export{Ss as default};
